{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/core-js/internals/well-known-symbol.js","webpack:///./node_modules/core-js/internals/fails.js","webpack:///./node_modules/core-js/internals/an-object.js","webpack:///./node_modules/core-js/internals/global.js","webpack:///./node_modules/core-js/internals/is-object.js","webpack:///./node_modules/core-js/internals/export.js","webpack:///./node_modules/core-js/internals/has.js","webpack:///./node_modules/core-js/internals/create-non-enumerable-property.js","webpack:///./node_modules/core-js/internals/descriptors.js","webpack:///./node_modules/core-js/internals/require-object-coercible.js","webpack:///./node_modules/core-js/internals/object-define-property.js","webpack:///./node_modules/core-js/internals/to-length.js","webpack:///./node_modules/core-js/internals/classof-raw.js","webpack:///./node_modules/core-js/internals/redefine.js","webpack:///./node_modules/core-js/internals/to-integer.js","webpack:///./node_modules/core-js/internals/to-indexed-object.js","webpack:///./node_modules/core-js/internals/to-object.js","webpack:///./node_modules/core-js/internals/create-property-descriptor.js","webpack:///./node_modules/core-js/internals/shared.js","webpack:///./node_modules/core-js/internals/array-method-has-species-support.js","webpack:///./node_modules/core-js/internals/iterators.js","webpack:///./node_modules/core-js/internals/indexed-object.js","webpack:///./node_modules/core-js/internals/to-primitive.js","webpack:///./node_modules/core-js/internals/is-pure.js","webpack:///./node_modules/core-js/internals/set-global.js","webpack:///./node_modules/core-js/internals/shared-key.js","webpack:///./node_modules/core-js/internals/hidden-keys.js","webpack:///./node_modules/core-js/internals/get-built-in.js","webpack:///./node_modules/core-js/internals/enum-bug-keys.js","webpack:///./node_modules/core-js/internals/is-array.js","webpack:///./node_modules/core-js/internals/create-property.js","webpack:///./node_modules/core-js/internals/array-iteration.js","webpack:///./node_modules/core-js/internals/regexp-flags.js","webpack:///./node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js","webpack:///./node_modules/core-js/internals/regexp-exec.js","webpack:///./node_modules/core-js/internals/regexp-exec-abstract.js","webpack:///./node_modules/core-js/internals/object-get-own-property-descriptor.js","webpack:///./node_modules/core-js/internals/ie8-dom-define.js","webpack:///./node_modules/core-js/internals/document-create-element.js","webpack:///./node_modules/core-js/internals/function-to-string.js","webpack:///./node_modules/core-js/internals/internal-state.js","webpack:///./node_modules/core-js/internals/uid.js","webpack:///./node_modules/core-js/internals/object-get-own-property-names.js","webpack:///./node_modules/core-js/internals/object-keys-internal.js","webpack:///./node_modules/core-js/internals/to-absolute-index.js","webpack:///./node_modules/core-js/internals/is-forced.js","webpack:///./node_modules/core-js/internals/array-species-create.js","webpack:///./node_modules/core-js/internals/bind-context.js","webpack:///./node_modules/core-js/internals/a-function.js","webpack:///./node_modules/core-js/internals/object-create.js","webpack:///./node_modules/core-js/internals/classof.js","webpack:///./node_modules/core-js/internals/object-set-prototype-of.js","webpack:///./node_modules/core-js/internals/is-regexp.js","webpack:///./node_modules/core-js/internals/string-multibyte.js","webpack:///./node_modules/core-js/internals/iterators-core.js","webpack:///./node_modules/core-js/internals/object-get-prototype-of.js","webpack:///./node_modules/core-js/internals/set-to-string-tag.js","webpack:///./node_modules/core-js/internals/advance-string-index.js","webpack:///./src/js/BookReader.js","webpack:///./node_modules/core-js/modules/es.array.concat.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/core-js/internals/object-property-is-enumerable.js","webpack:///./node_modules/core-js/internals/shared-store.js","webpack:///./node_modules/core-js/internals/native-weak-map.js","webpack:///./node_modules/core-js/internals/copy-constructor-properties.js","webpack:///./node_modules/core-js/internals/own-keys.js","webpack:///./node_modules/core-js/internals/path.js","webpack:///./node_modules/core-js/internals/array-includes.js","webpack:///./node_modules/core-js/internals/object-get-own-property-symbols.js","webpack:///./node_modules/core-js/internals/native-symbol.js","webpack:///./node_modules/core-js/modules/es.array.filter.js","webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./node_modules/core-js/internals/add-to-unscopables.js","webpack:///./node_modules/core-js/internals/object-define-properties.js","webpack:///./node_modules/core-js/internals/object-keys.js","webpack:///./node_modules/core-js/internals/html.js","webpack:///./node_modules/core-js/modules/es.array.from.js","webpack:///./node_modules/core-js/internals/array-from.js","webpack:///./node_modules/core-js/internals/call-with-safe-iteration-closing.js","webpack:///./node_modules/core-js/internals/is-array-iterator-method.js","webpack:///./node_modules/core-js/internals/get-iterator-method.js","webpack:///./node_modules/core-js/internals/check-correctness-of-iteration.js","webpack:///./node_modules/core-js/modules/es.array.join.js","webpack:///./node_modules/core-js/internals/sloppy-array-method.js","webpack:///./node_modules/core-js/modules/es.array.map.js","webpack:///./node_modules/core-js/modules/es.array.slice.js","webpack:///./node_modules/core-js/modules/es.number.to-fixed.js","webpack:///./node_modules/core-js/internals/this-number-value.js","webpack:///./node_modules/core-js/internals/string-repeat.js","webpack:///./node_modules/core-js/modules/es.object.to-string.js","webpack:///./node_modules/core-js/internals/object-to-string.js","webpack:///./node_modules/core-js/modules/es.regexp.constructor.js","webpack:///./node_modules/core-js/internals/inherit-if-required.js","webpack:///./node_modules/core-js/internals/a-possible-prototype.js","webpack:///./node_modules/core-js/internals/set-species.js","webpack:///./node_modules/core-js/modules/es.regexp.to-string.js","webpack:///./node_modules/core-js/modules/es.string.iterator.js","webpack:///./node_modules/core-js/internals/define-iterator.js","webpack:///./node_modules/core-js/internals/create-iterator-constructor.js","webpack:///./node_modules/core-js/internals/correct-prototype-getter.js","webpack:///./node_modules/core-js/modules/es.string.replace.js","webpack:///./node_modules/core-js/modules/es.string.search.js","webpack:///./node_modules/core-js/internals/same-value.js","webpack:///./node_modules/core-js/modules/es.string.split.js","webpack:///./node_modules/core-js/internals/species-constructor.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","global","shared","uid","NATIVE_SYMBOL","store","exec","error","isObject","it","TypeError","String","Math","check","globalThis","window","self","Function","getOwnPropertyDescriptor","f","createNonEnumerableProperty","redefine","setGlobal","copyConstructorProperties","isForced","options","source","target","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","noTargetGet","forced","undefined","sham","DESCRIPTORS","definePropertyModule","createPropertyDescriptor","fails","a","IE8_DOM_DEFINE","anObject","toPrimitive","nativeDefineProperty","O","P","Attributes","toInteger","min","argument","toString","slice","has","nativeFunctionToString","InternalStateModule","getInternalState","enforceInternalState","enforce","TEMPLATE","split","unsafe","simple","join","this","ceil","floor","isNaN","IndexedObject","requireObjectCoercible","bitmap","configurable","writable","IS_PURE","push","version","copyright","SPECIES","wellKnownSymbol","METHOD_NAME","array","constructor","foo","Boolean","classof","propertyIsEnumerable","input","PREFERRED_STRING","fn","val","valueOf","keys","path","aFunction","variable","namespace","method","arguments","length","Array","isArray","arg","propertyKey","toObject","toLength","arraySpeciesCreate","createMethod","TYPE","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","NO_HOLES","$this","callbackfn","that","specificCreate","result","boundFunction","index","forEach","map","filter","some","every","find","findIndex","ignoreCase","multiline","dotAll","unicode","sticky","regexpExec","REPLACE_SUPPORTS_NAMED_GROUPS","re","groups","replace","SPLIT_WORKS_WITH_OVERWRITTEN_EXEC","originalExec","apply","KEY","SYMBOL","DELEGATES_TO_SYMBOL","DELEGATES_TO_EXEC","execCalled","nativeRegExpMethod","methods","nativeMethod","regexp","str","arg2","forceStringMethod","done","stringMethod","regexMethod","RegExp","string","re1","re2","regexpFlags","nativeExec","nativeReplace","patchedExec","UPDATES_LAST_INDEX_WRONG","lastIndex","NPCG_INCLUDED","reCopy","match","R","S","propertyIsEnumerableModule","toIndexedObject","nativeGetOwnPropertyDescriptor","createElement","document","EXISTS","set","NATIVE_WEAK_MAP","objectHas","sharedKey","hiddenKeys","WeakMap","wmget","wmhas","wmset","metadata","STATE","getterFor","state","type","id","postfix","random","internalObjectKeys","concat","getOwnPropertyNames","indexOf","names","max","integer","replacement","feature","detection","data","normalize","POLYFILL","NATIVE","toLowerCase","originalArray","C","b","defineProperties","enumBugKeys","html","documentCreateElement","IE_PROTO","Empty","createDict","iframeDocument","iframe","style","display","appendChild","src","contentWindow","open","write","lt","close","F","Properties","classofRaw","TO_STRING_TAG","CORRECT_ARGUMENTS","tag","tryGet","callee","aPossiblePrototype","setPrototypeOf","setter","CORRECT_SETTER","test","proto","__proto__","MATCH","isRegExp","CONVERT_TO_STRING","pos","first","second","position","size","charCodeAt","charAt","codeAt","IteratorPrototype","PrototypeOfArrayIteratorPrototype","arrayIterator","getPrototypeOf","ITERATOR","BUGGY_SAFARI_ITERATORS","CORRECT_PROTOTYPE_GETTER","ObjectPrototype","TAG","BookReader","$","jQuery","extend","defaultOptions","optionOverrides","setup","location","logEl","width","height","overflow","body","prepend","form","append","submit","ev","preventDefault","eval","logToScreen","currentRun","args","from","JSON","stringify","lastChild","innerHTML","firstChild","div","_realLog","console","log","onerror","constMode1up","constMode2up","constModeThumb","constNavAnimationDuration","constResizeAnimationDuration","eventNames","fragmentChange","PostInit","stop","resize","navToggled","fullscreenToggled","zoomOut","zoomIn","defaults","padding","ui","uiAutoHide","thumbRowBuffer","thumbColumns","thumbMaxLoading","thumbPadding","flipSpeed","showToolbar","showNavbar","navBarTitle","showLogo","logoURL","imagesBaseURL","reductionFactors","reduce","autofit","onePage","twoPage","coverInternalPadding","coverExternalPadding","bookSpineDivWidth","onePageMinBreakpoint","bookTitle","bookUrl","bookUrlText","bookUrlTitle","enableBookTitleLink","bookLanguage","thumbnail","bookUrlMoreInfo","enableExperimentalControls","el","pageProgression","protected","getNumLeafs","getPageWidth","getPageHeight","getPageURI","getPageSide","getSpreadIndices","getPageNum","getPageProp","leafNumToIndex","getEmbedCode","prevReadMode","thumbWidth","displayedRows","displayedIndices","imgs","prefetchedImgs","animating","flipDelay","twoPagePopUp","leafEdgeTmp","firstIndex","lastDisplayableIndex2up","isFullscreenActive","lastScroll","titleLeaf","popup","refs","util","disableSelect","jObject","onselectstart","clamp","cssPercentage","notInArray","inArray","getIFrameDocument","outer","contentDocument","escapeHTML","decodeURIComponentPlus","decodeURIComponent","encodeURIComponentPlus","encodeURIComponent","debounce","func","wait","immediate","timeout","context","later","callNow","clearTimeout","setTimeout","throttle","threshhold","delay","last","deferTimer","Date","now","extendParams","params","newParams","modifiedNewParams","page","pageIndex","parsePageString","initParams","paramsFromFragment","enablePageResume","getResumeValue","enableUrlPlugin","urlParams","urlReadFragment","getInitialMode","nextMode","windowWidth","enableMobileNav","canSwitchToMode","init","pageScale","isTouchDevice","navigator","$br","empty","removeClass","addClass","$brContainer","initialMode","initEmbedNavbar","initToolbar","initNavbar","resizeBRcontainer","switchMode","updateFromParams","initUIStrings","setupTooltips","bindNavigationHandlers","setupKeyListeners","getTime","e","drawLeafsThrottled","on","hide","trigger","initComplete","props","callback","unbind","resizePageView1up","centerPageView","enableSearch","updateSearchHilites","prepareThumbnailView","prepareTwoPageView","center","twoPageGetViewCenter","doRecenter","totalWidth","prop","percentageX","totalHeight","percentageY","twoPageCenterView","keydown","keyboardNavigationIsDisabled","keyCode","prev","next","left","right","zoom","each","idx","positions","shrinkToFit","spikeGirth","spikeLength","fill","cornerRadius","strokeWidth","cssStyles","$el","parents","bt","drawLeafs","drawLeafsOnePage","drawLeafsThumbnail","drawLeafsTwoPage","bindGestures","jElement","numTouches","originalEvent","cancelable","touches","stopPropagation","scale","setClickHandler2UP","element","handler","containerHeight","containerWidth","$brPageViewEl","scrollTop","scrollBottom","indicesToDisplay","leafTop","leafBottom","parseInt","_getPageHeight","firstIndexToDraw","updateFirstIndex","unshift","lastIndexToDraw","BRpageViewEl","_getPageWidth","leftMargin","className","top","img","_getPageURI","remove","updateToolbarZoom","updateNavIndexThrottled","seekIndex","leafWidth","leafHeight","seekTop","viewWidth","rightPos","bottomPos","maxRight","currentRow","leafIndex","leafMap","leafs","num","pageViewBuffer","rowsToDisplay","leastVisible","mostVisible","j","row","link","leaf","k","firstRow","lastRow","addEventListener","event","suppressFragmentChange","thumbReduce","attr","css","currentIndex","lazyLoadThumbnails","loading","toLoad","lazyLoadImage","dummyImage","Image","one","before","$twoPageViewEl","$brTwoPageView","indexL","currentIndexL","twoPageTop","scaledWL","getPageWidth2UP","gutter","twoPageGutter","prefetchImg","zIndex","appendTo","indexR","currentIndexR","scaledWR","setMouseHandlers2UP","direction","zoom1up","zoom2up","zoomThumb","reduceFactor","nextReduce","removeSearchHilites","animate","getToolBarHeight","bottom","getFooterHeight","oldScrollTop","oldPageViewHeight","oldPageViewWidth","scrollRatio","oldCenterY","centerY1up","oldCenterX","centerX1up","fudgeFactor","onePageGetPageTop","onePageCalculateViewDimensions","onePageCalculateReductionFactors","reductionFactor","viewDimensions","newCenterY","newTop","newLeft","viewHeight","centerX","centerY","scrollWidth","clientWidth","stopFlipAnimations","twoPageCalculateReductionFactors","oldCenter","oldColumns","getThumbnailWidth","thumbnailColumns","quantizeReduce","newDistance","quantized","distance","abs","currentReduce","newReduceIndex","choice","alert","_reduceSort","jumpToPage","pageNum","jumpToIndex","pageX","pageY","noAnimate","prevCurrentIndex","offset","leafLeft","flipBackToIndex","flipFwdToIndex","rowHeight","scrollLeft","prepareOnePageView","eventName","updateBrClasses","modeToClass","isFullscreen","toggleFullscreen","exitFullScreen","enterFullscreen","opacity","_fullscreenCloseHandler","keyup","startLeaf","overflowY","overflowX","dragscrollable","centerPercentageX","centerPercentageY","targetLeaf","firstDisplayableIndex","lastDisplayableIndex","currentSpreadIndices","calculateSpreadSize","pruneUnusedImgs","prefetch","coverDiv","bookCoverDivWidth","bookCoverDivHeight","visibility","leafEdgeR","leafEdgeWidthR","bookCoverDivTop","border","leafEdgeL","leafEdgeWidthL","bookCoverDivLeft","bookSpineDivHeight","bookSpineDivTop","prepareTwoPagePopUp","add","show","jumpIndex","jumpIndexForLeftEdgePageX","jumpIndexForRightEdgePageX","text","getPageName","spreadSize","secondIndex","getIdealSpreadSize","getSpreadSizeFromReduce","edgeWidth","totalLeafEdgeWidth","leafEdgeWidth","twoPageCoverWidth","leftGutterOffset","gutterOffsetForIndex","leftWidthFromCenter","rightWidthFromCenter","largestWidthFromCenter","middle","bookSpineDivLeft","ratio","ideal","firstIndexRatio","secondIndexRatio","maxLeafEdgeWidth","widthOutsidePages","heightOutsidePages","nativeWidth","nativeHeight","twoPageGetAutofitReduce","twoPageIsZoomedIn","isZoomedIn","onePageGetAutofitWidth","getMedianPageSize","widthPadding","onePageGetAutofitHeight","availableHeight","innerHeight","_medianPageSize","widths","heights","sort","twoPageSetCursor","cursor","rightmost","leftmost","scrollDown","_scrollAmount","scrollUp","leftIndex","previousIndices","prepareFlipLeftToRight","flipLeftToRight","prepareFlipRightToLeft","flipRightToLeft","newIndexL","newIndexR","leftLeaf","oldLeafEdgeWidthL","newLeafEdgeWidthL","leafEdgeTmpW","currWidthL","newWidthL","newWidthR","leftEdgeTmpLeft","updateSearchHilites2UP","animationFinishedCallback","nextIndices","oldLeafEdgeWidthR","newLeafEdgeWidthR","scaledW","speed","which","mousemove","mouseup","pageURI","loadImage","uri","prevL","prevR","leftCSS","rightCSS","nextL","nextR","lowCurrent","highCurrent","start","end","goingDown","goingUp","totalPageWidth","containerOffset","viewOffset","containerClientWidth","intoViewX","containerClientHeight","intoViewY","twoPageFlipAreaHeight","twoPageFlipAreaWidth","twoPageFlipAreaTop","twoPageLeftFlipAreaLeft","twoPageRightFlipAreaLeft","setHilightCss2UP","pageL","pageT","tagName","pindex","round","navbarTitleHtml","navbarTitle","$BRfooter","$BRnav","slider","range","updateNavPageNum","thisLink","logoHtml","getNavPageNumString","pageType","numLeafs","maxPageNum","pageNumVal","getNavPageNumHtml","pageStr","updateNavIndex","updateNavIndexDebounced","buildToolbarElement","$BRtoolbar","$titleSectionEl","blankShareDiv","blankInfoDiv","buildInfoDiv","buildShareDiv","colorbox","inline","href","onLoad","toUpperCase","toFixed","jIcons","click","url","$brNavCntlBtmEl","$brNavCntlTopEl","promises","hasClass","promise","when","mouseover","mouseleave","initSwipeData","off","navigationMousemoveHandler","swipeMousedownHandler","bindMozTouchHandlers","unbindNavigationHandlers","navkey","hideNavigation","showNavigation","clientX","clientY","_swipe","mightBeSwiping","didSwipe","mightBeDraggin","didDrag","startTime","startX","startY","lastX","lastY","deltaX","deltaY","deltaT","swipeMouseupHandler","swipeMousemoveHandler","mightBeDragging","returnValue","cancelBubble","absX","absY","minSwipeLength","navigationIsVisible","setNavigationView","animationLength","resizePageContainer","toolbarHeight","navbarHeight","pageFound","search","searchTerm","goToFirstResult","enableThemesPlugin","theme","updateTheme","getPageIndex","pageIndices","getPageIndices","indices","pageIntStr","err","clampedIndex","rotate","showProgressPopup","msg","bar","msgdiv","removeProgressPopup","jShareDiv","pageView","bookView","embedHtml","jForm","select","param","u","_getSocialShareUrl","createPopup","encodeURI","protocol","hostname","pathname","jInfoDiv","$leftCol","extraClass","moreInfoText","$rightCol","extraValueClass","label","children","childrenEl","titles","icon","dualScreenLeft","screenLeft","screen","dualScreenTop","screenTop","win_w","innerWidth","documentElement","opts","clientHeight","reloadImages","elem","complete","naturalHeight","outerHeight","$heightEl","_getDataFlattened","pageSide","propName","_getDataProp","leafNum","dataf","paramsFromCurrent","fragment","substr","oldStyleLeafNum","urlArray","urlHash","fragmentFromParams","fragments","leafMatch","cached","flattend","prevPageSide","selector","curCSS","createProperty","arrayMethodHasSpeciesSupport","IS_CONCAT_SPREADABLE","IS_CONCAT_SPREADABLE_SUPPORT","SPECIES_SUPPORT","isConcatSpreadable","spreadable","len","E","A","g","nativePropertyIsEnumerable","NASHORN_BUG","1","V","ownKeys","getOwnPropertyDescriptorModule","getBuiltIn","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","getOwnPropertySymbols","toAbsoluteIndex","IS_INCLUDES","fromIndex","includes","$filter","$find","addToUnscopables","SKIPS_HOLES","UNSCOPABLES","ArrayPrototype","objectKeys","checkCorrectnessOfIteration","iterable","callWithSafeIterationClosing","isArrayIteratorMethod","getIteratorMethod","arrayLike","step","iterator","argumentsLength","mapfn","mapping","iteratorMethod","ENTRIES","returnMethod","Iterators","SAFE_CLOSING","called","iteratorWithReturn","SKIP_CLOSING","ITERATION_SUPPORT","sloppyArrayMethod","nativeJoin","ES3_STRINGS","SLOPPY_METHOD","separator","$map","nativeSlice","Constructor","fin","thisNumberValue","repeat","nativeToFixed","pow","x","acc","fractionDigits","z","number","fractDigits","sign","multiply","c2","divide","dataToString","RangeError","x2","count","Infinity","inheritIfRequired","getFlags","setSpecies","NativeRegExp","RegExpPrototype","CORRECT_NEW","RegExpWrapper","pattern","flags","thisIsRegExp","patternIsRegExp","flagsAreUndefined","proxy","dummy","Wrapper","NewTarget","NewTargetPrototype","CONSTRUCTOR_NAME","nativeToString","NOT_GENERIC","INCORRECT_NAME","rf","defineIterator","setInternalState","iterated","point","createIteratorConstructor","setToStringTag","IteratorsCore","returnThis","Iterable","NAME","IteratorConstructor","DEFAULT","IS_SET","FORCED","CurrentIteratorPrototype","getIterationMethod","KIND","defaultIterator","IterablePrototype","INCORRECT_VALUES_NAME","nativeIterator","anyNativeIterator","entries","values","fixRegExpWellKnownSymbolLogic","advanceStringIndex","regExpExec","SUBSTITUTION_SYMBOLS","SUBSTITUTION_SYMBOLS_NO_NAMED","REPLACE","maybeCallNative","searchValue","replaceValue","replacer","res","rx","functionalReplace","fullUnicode","results","accumulatedResult","nextSourcePosition","matched","captures","namedCaptures","replacerArgs","getSubstitution","tailPos","symbols","ch","capture","sameValue","SEARCH","nativeSearch","searcher","previousLastIndex","is","y","speciesConstructor","callRegExpExec","arrayPush","SUPPORTS_Y","SPLIT","nativeSplit","internalSplit","limit","lim","lastLength","output","lastLastIndex","separatorCopy","splitter","unicodeMatching","q","defaultConstructor"],"mappings":"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","file":"BookReader.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 58);\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\n\nvar Symbol = global.Symbol;\nvar store = shared('wks');\n\nmodule.exports = function (name) {\n  return store[name] || (store[name] = NATIVE_SYMBOL && Symbol[name]\n    || (NATIVE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it)) {\n    throw TypeError(String(it) + ' is not an object');\n  } return it;\n};\n","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line no-undef\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func\n  Function('return this')();\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar setGlobal = require('../internals/set-global');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty === typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n","var hasOwnProperty = {}.hasOwnProperty;\n\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var fails = require('../internals/fails');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !fails(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","// `RequireObjectCoercible` abstract operation\n// https://tc39.github.io/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar anObject = require('../internals/an-object');\nvar toPrimitive = require('../internals/to-primitive');\n\nvar nativeDefineProperty = Object.defineProperty;\n\n// `Object.defineProperty` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? nativeDefineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return nativeDefineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var toInteger = require('../internals/to-integer');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.github.io/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\nvar setGlobal = require('../internals/set-global');\nvar nativeFunctionToString = require('../internals/function-to-string');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(nativeFunctionToString).split('toString');\n\nshared('inspectSource', function (it) {\n  return nativeFunctionToString.call(it);\n});\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  if (typeof value == 'function') {\n    if (typeof key == 'string' && !has(value, 'name')) createNonEnumerableProperty(value, 'name', key);\n    enforceInternalState(value).source = TEMPLATE.join(typeof key == 'string' ? key : '');\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return typeof this == 'function' && getInternalState(this).source || nativeFunctionToString.call(this);\n});\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToInteger` abstract operation\n// https://tc39.github.io/ecma262/#sec-tointeger\nmodule.exports = function (argument) {\n  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n};\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","var requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `ToObject` abstract operation\n// https://tc39.github.io/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.3.3',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: ' 2019 Denis Pushkarev (zloirock.ru)'\n});\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (METHOD_NAME) {\n  return !fails(function () {\n    var array = [];\n    var constructor = array.constructor = {};\n    constructor[SPECIES] = function () {\n      return { foo: 1 };\n    };\n    return array[METHOD_NAME](Boolean).foo !== 1;\n  });\n};\n","module.exports = {};\n","var fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar split = ''.split;\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split.call(it, '') : Object(it);\n} : Object;\n","var isObject = require('../internals/is-object');\n\n// `ToPrimitive` abstract operation\n// https://tc39.github.io/ecma262/#sec-toprimitive\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (input, PREFERRED_STRING) {\n  if (!isObject(input)) return input;\n  var fn, val;\n  if (PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (typeof (fn = input.valueOf) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (!PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","module.exports = false;\n","var global = require('../internals/global');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nmodule.exports = function (key, value) {\n  try {\n    createNonEnumerableProperty(global, key, value);\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","module.exports = {};\n","var path = require('../internals/path');\nvar global = require('../internals/global');\n\nvar aFunction = function (variable) {\n  return typeof variable == 'function' ? variable : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global[namespace])\n    : path[namespace] && path[namespace][method] || global[namespace] && global[namespace][method];\n};\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.github.io/ecma262/#sec-isarray\nmodule.exports = Array.isArray || function isArray(arg) {\n  return classof(arg) == 'Array';\n};\n","'use strict';\nvar toPrimitive = require('../internals/to-primitive');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPrimitive(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","var bind = require('../internals/bind-context');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar push = [].push;\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  return function ($this, callbackfn, that, specificCreate) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var create = specificCreate || arraySpeciesCreate;\n    var target = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: push.call(target, value); // filter\n        } else if (IS_EVERY) return false;  // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.forEach` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n  forEach: createMethod(0),\n  // `Array.prototype.map` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.map\n  map: createMethod(1),\n  // `Array.prototype.filter` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.filter\n  filter: createMethod(2),\n  // `Array.prototype.some` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.some\n  some: createMethod(3),\n  // `Array.prototype.every` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.every\n  every: createMethod(4),\n  // `Array.prototype.find` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.find\n  find: createMethod(5),\n  // `Array.prototype.findIndex` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\n  findIndex: createMethod(6)\n};\n","'use strict';\nvar anObject = require('../internals/an-object');\n\n// `RegExp.prototype.flags` getter implementation\n// https://tc39.github.io/ecma262/#sec-get-regexp.prototype.flags\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.dotAll) result += 's';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","'use strict';\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar regexpExec = require('../internals/regexp-exec');\n\nvar SPECIES = wellKnownSymbol('species');\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  // #replace needs built-in support for named groups.\n  // #match works fine because it just return the exec results, even if it has\n  // a \"grops\" property.\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  return ''.replace(re, '$<a>') !== '7';\n});\n\n// Chrome 51 has a buggy \"split\" implementation when RegExp#exec !== nativeExec\n// Weex JS has frozen built-in prototypes, so use try / catch wrapper\nvar SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = !fails(function () {\n  var re = /(?:)/;\n  var originalExec = re.exec;\n  re.exec = function () { return originalExec.apply(this, arguments); };\n  var result = 'ab'.split(re);\n  return result.length !== 2 || result[0] !== 'a' || result[1] !== 'b';\n});\n\nmodule.exports = function (KEY, length, exec, sham) {\n  var SYMBOL = wellKnownSymbol(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL && !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n    re.exec = function () { execCalled = true; return null; };\n\n    if (KEY === 'split') {\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n    }\n\n    re[SYMBOL]('');\n    return !execCalled;\n  });\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    (KEY === 'replace' && !REPLACE_SUPPORTS_NAMED_GROUPS) ||\n    (KEY === 'split' && !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC)\n  ) {\n    var nativeRegExpMethod = /./[SYMBOL];\n    var methods = exec(SYMBOL, ''[KEY], function (nativeMethod, regexp, str, arg2, forceStringMethod) {\n      if (regexp.exec === regexpExec) {\n        if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n          // The native String method already delegates to @@method (this\n          // polyfilled function), leasing to infinite recursion.\n          // We avoid it by directly calling the native @@method method.\n          return { done: true, value: nativeRegExpMethod.call(regexp, str, arg2) };\n        }\n        return { done: true, value: nativeMethod.call(str, regexp, arg2) };\n      }\n      return { done: false };\n    });\n    var stringMethod = methods[0];\n    var regexMethod = methods[1];\n\n    redefine(String.prototype, KEY, stringMethod);\n    redefine(RegExp.prototype, SYMBOL, length == 2\n      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)\n      // 21.2.5.11 RegExp.prototype[@@split](string, limit)\n      ? function (string, arg) { return regexMethod.call(string, this, arg); }\n      // 21.2.5.6 RegExp.prototype[@@match](string)\n      // 21.2.5.9 RegExp.prototype[@@search](string)\n      : function (string) { return regexMethod.call(string, this); }\n    );\n    if (sham) createNonEnumerableProperty(RegExp.prototype[SYMBOL], 'sham', true);\n  }\n};\n","'use strict';\nvar regexpFlags = require('./regexp-flags');\n\nvar nativeExec = RegExp.prototype.exec;\n// This always refers to the native implementation, because the\n// String#replace polyfill uses ./fix-regexp-well-known-symbol-logic.js,\n// which loads this file before patching the method.\nvar nativeReplace = String.prototype.replace;\n\nvar patchedExec = nativeExec;\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/;\n  var re2 = /b*/g;\n  nativeExec.call(re1, 'a');\n  nativeExec.call(re2, 'a');\n  return re1.lastIndex !== 0 || re2.lastIndex !== 0;\n})();\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED;\n\nif (PATCH) {\n  patchedExec = function exec(str) {\n    var re = this;\n    var lastIndex, reCopy, match, i;\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + re.source + '$(?!\\\\s)', regexpFlags.call(re));\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re.lastIndex;\n\n    match = nativeExec.call(re, str);\n\n    if (UPDATES_LAST_INDEX_WRONG && match) {\n      re.lastIndex = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/\n      nativeReplace.call(match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n","var classof = require('./classof-raw');\nvar regexpExec = require('./regexp-exec');\n\n// `RegExpExec` abstract operation\n// https://tc39.github.io/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (typeof exec === 'function') {\n    var result = exec.call(R, S);\n    if (typeof result !== 'object') {\n      throw TypeError('RegExp exec method returned something other than an Object or null');\n    }\n    return result;\n  }\n\n  if (classof(R) !== 'RegExp') {\n    throw TypeError('RegExp#exec called on incompatible receiver');\n  }\n\n  return regexpExec.call(R, S);\n};\n\n","var DESCRIPTORS = require('../internals/descriptors');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPrimitive = require('../internals/to-primitive');\nvar has = require('../internals/has');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\nvar nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? nativeGetOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return nativeGetOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","var shared = require('../internals/shared');\n\nmodule.exports = shared('native-function-to-string', Function.toString);\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar objectHas = require('../internals/has');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP) {\n  var store = new WeakMap();\n  var wmget = store.get;\n  var wmhas = store.has;\n  var wmset = store.set;\n  set = function (it, metadata) {\n    wmset.call(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget.call(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas.call(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return objectHas(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return objectHas(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","var id = 0;\nvar postfix = Math.random();\n\nmodule.exports = function (key) {\n  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertynames\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","var has = require('../internals/has');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~indexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","var toInteger = require('../internals/to-integer');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(length, length).\nmodule.exports = function (index, length) {\n  var integer = toInteger(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","var fails = require('../internals/fails');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : typeof detection == 'function' ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","var isObject = require('../internals/is-object');\nvar isArray = require('../internals/is-array');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.github.io/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return new (C === undefined ? Array : C)(length === 0 ? 0 : length);\n};\n","var aFunction = require('../internals/a-function');\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","module.exports = function (it) {\n  if (typeof it != 'function') {\n    throw TypeError(String(it) + ' is not a function');\n  } return it;\n};\n","var anObject = require('../internals/an-object');\nvar defineProperties = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar PROTOTYPE = 'prototype';\nvar Empty = function () { /* empty */ };\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var length = enumBugKeys.length;\n  var lt = '<';\n  var script = 'script';\n  var gt = '>';\n  var js = 'java' + script + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  iframe.src = String(js);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + script + gt + 'document.F=Object' + lt + '/' + script + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (length--) delete createDict[PROTOTYPE][enumBugKeys[length]];\n  return createDict();\n};\n\n// `Object.create` method\n// https://tc39.github.io/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : defineProperties(result, Properties);\n};\n\nhiddenKeys[IE_PROTO] = true;\n","var classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : result;\n};\n","var anObject = require('../internals/an-object');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\n\n// `Object.setPrototypeOf` method\n// https://tc39.github.io/ecma262/#sec-object.setprototypeof\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nmodule.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n  var CORRECT_SETTER = false;\n  var test = {};\n  var setter;\n  try {\n    setter = Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set;\n    setter.call(test, []);\n    CORRECT_SETTER = test instanceof Array;\n  } catch (error) { /* empty */ }\n  return function setPrototypeOf(O, proto) {\n    anObject(O);\n    aPossiblePrototype(proto);\n    if (CORRECT_SETTER) setter.call(O, proto);\n    else O.__proto__ = proto;\n    return O;\n  };\n}() : undefined);\n","var isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.github.io/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n","var toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.{ codePointAt, at }` methods implementation\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = String(requireObjectCoercible($this));\n    var position = toInteger(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = S.charCodeAt(position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING ? S.charAt(position) : first\n        : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.github.io/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","'use strict';\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar BUGGY_SAFARI_ITERATORS = false;\n\nvar returnThis = function () { return this; };\n\n// `%IteratorPrototype%` object\n// https://tc39.github.io/ecma262/#sec-%iteratorprototype%-object\nvar IteratorPrototype, PrototypeOfArrayIteratorPrototype, arrayIterator;\n\nif ([].keys) {\n  arrayIterator = [].keys();\n  // Safari 8 has buggy iterators w/o `next`\n  if (!('next' in arrayIterator)) BUGGY_SAFARI_ITERATORS = true;\n  else {\n    PrototypeOfArrayIteratorPrototype = getPrototypeOf(getPrototypeOf(arrayIterator));\n    if (PrototypeOfArrayIteratorPrototype !== Object.prototype) IteratorPrototype = PrototypeOfArrayIteratorPrototype;\n  }\n}\n\nif (IteratorPrototype == undefined) IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nif (!IS_PURE && !has(IteratorPrototype, ITERATOR)) {\n  createNonEnumerableProperty(IteratorPrototype, ITERATOR, returnThis);\n}\n\nmodule.exports = {\n  IteratorPrototype: IteratorPrototype,\n  BUGGY_SAFARI_ITERATORS: BUGGY_SAFARI_ITERATORS\n};\n","var has = require('../internals/has');\nvar toObject = require('../internals/to-object');\nvar sharedKey = require('../internals/shared-key');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar IE_PROTO = sharedKey('IE_PROTO');\nvar ObjectPrototype = Object.prototype;\n\n// `Object.getPrototypeOf` method\n// https://tc39.github.io/ecma262/#sec-object.getprototypeof\nmodule.exports = CORRECT_PROTOTYPE_GETTER ? Object.getPrototypeOf : function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectPrototype : null;\n};\n","var defineProperty = require('../internals/object-define-property').f;\nvar has = require('../internals/has');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n\nmodule.exports = function (it, TAG, STATIC) {\n  if (it && !has(it = STATIC ? it : it.prototype, TO_STRING_TAG)) {\n    defineProperty(it, TO_STRING_TAG, { configurable: true, value: TAG });\n  }\n};\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\n\n// `AdvanceStringIndex` abstract operation\n// https://tc39.github.io/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? charAt(S, index).length : 1);\n};\n","/*\nCopyright(c)2008-2019 Internet Archive. Software license AGPL version 3.\n\nThis file is part of BookReader.\n\n    BookReader is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Affero General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    BookReader is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Affero General Public License for more details.\n\n    You should have received a copy of the GNU Affero General Public License\n    along with BookReader.  If not, see <http://www.gnu.org/licenses/>.\n\n    The BookReader source is hosted at http://github.com/internetarchive/bookreader/\n\n*/\n\nwindow.BookReader = (function ($) {\n\nif (location.toString().indexOf('_debugShowConsole=true') != -1) {\n    $(function() {\n        var logEl = document.createElement('div');\n        logEl.id = '_debugLog';\n        logEl.style.width = '100%';\n        logEl.style.height = '300px';\n        logEl.style.overflow = 'auto';\n        $(document.body).prepend(logEl);\n\n        var form = $('<form><input style=\"width:100%; font-family: monospace;\" id=\"_debugLogInput\"></form>');\n        $(logEl).append(form);\n        form.submit(function(ev) {\n            ev.preventDefault();\n            var result = eval(form.find('input').val());\n            logToScreen([result]);\n        });\n\n        var currentRun = 0;\n        function logToScreen(args) {\n            var html = Array.from(args).map(JSON.stringify).join(',');\n            if (logEl.lastChild && logEl.lastChild.lastChild.innerHTML == html) {\n                logEl.lastChild.firstChild.innerHTML = '(' + (currentRun++) + ')';\n            } else {\n                currentRun = 1;\n                var div = document.createElement('div');\n                div.innerHTML = '<code></code> <code>' + html + '</code>';\n                logEl.appendChild(div);\n            }\n        }\n\n        // eslint-disable-next-line no-console\n        var _realLog = console.log.bind(console);\n        // eslint-disable-next-line no-console\n        console.log = function() {\n            var args = Array.prototype.slice.call(arguments);\n            _realLog.apply(console, args);\n            logToScreen(args);\n        }\n\n        window.onerror = function() {\n            logToScreen(Array.prototype.slice.call(arguments));\n        };\n    })\n}\n\n/**\n * BookReader\n * @param {Object} options\n * TODO document all options properties\n * @constructor\n */\nfunction BookReader(options) {\n    options = options || {};\n    options = jQuery.extend({}, BookReader.defaultOptions, options, BookReader.optionOverrides);\n    this.setup(options);\n}\n\nBookReader.version = '4.5.1';\n\n// Mode constants\nBookReader.constMode1up = 1;\nBookReader.constMode2up = 2;\nBookReader.constModeThumb = 3;\n\n// Animation constants\nBookReader.constNavAnimationDuration = 300;\nBookReader.constResizeAnimationDuration = 100;\n\n// Names of events that can be triggered via BookReader.prototype.trigger()\nBookReader.eventNames = {\n    // Indicates that the fragment (a serialization of the reader state)\n    // has changed.\n    fragmentChange: 'fragmentChange',\n    PostInit: 'PostInit',\n    stop: 'stop',\n    resize: 'resize',\n    // nav events:\n    navToggled: 'navToggled',\n    // menu click events\n    fullscreenToggled: 'fullscreenToggled',\n    zoomOut: 'zoomOut',\n    zoomIn: 'zoomIn',\n    '1PageViewSelected': '1PageViewSelected',\n    '2PageViewSelected': '2PageViewSelected',\n    /* currently 3 represents thumbnail view */\n    '3PageViewSelected': '3PageViewSelected',\n};\n\nBookReader.defaultOptions = {\n    // A string, such as \"mode/1up\". See\n    // http://openlibrary.org/dev/docs/bookurls for valid syntax\n    defaults: null,\n\n    // Padding in 1up\n    padding: 10,\n    // UI mode\n    ui: 'full', // full, embed, responsive\n\n    // Controls whether nav/toolbar will autohide\n    uiAutoHide: false,\n\n    // thumbnail mode\n    // number of rows to pre-cache out a view\n    thumbRowBuffer: 2,\n    thumbColumns: 6,\n    // number of thumbnails to load at once\n    thumbMaxLoading: 4,\n    // spacing between thumbnails\n    thumbPadding: 10,\n    // speed for flip animation\n    flipSpeed: 'fast',\n\n    showToolbar: true,\n    showNavbar: true,\n    navBarTitle: '',\n\n    showLogo: true,\n    // Where the logo links to\n    logoURL: 'https://archive.org',\n\n    // Base URL for UI images - should be overriden (before init) by\n    // custom implementations.\n    // $$$ This is the same directory as the images referenced by relative\n    //     path in the CSS.  Would be better to automagically find that path.\n    imagesBaseURL: '/BookReader/images/',\n\n    // Zoom levels\n    // $$$ provide finer grained zooming, {reduce: 8, autofit: null}, {reduce: 16, autofit: null}\n    /* The autofit code ensures that fit to width and fit to height will be available */\n    reductionFactors: [\n        {reduce: 0.5, autofit: null},\n        {reduce: 1, autofit: null},\n        {reduce: 2, autofit: null},\n        {reduce: 3, autofit: null},\n        {reduce: 4, autofit: null},\n        {reduce: 6, autofit: null}\n    ],\n\n    // Object to hold parameters related to 1up mode\n    onePage: {\n        autofit: 'auto', // valid values are height, width, auto, none\n    },\n\n    // Object to hold parameters related to 2up mode\n    twoPage: {\n        coverInternalPadding: 0, // Width of cover\n        coverExternalPadding: 0, // Padding outside of cover\n        bookSpineDivWidth: 64,    // Width of book spine  $$$ consider sizing based on book length\n        autofit: 'auto'\n    },\n\n    onePageMinBreakpoint: 800,\n\n    bookTitle: '',\n    bookUrl: null,\n    bookUrlText: null,\n    bookUrlTitle: null,\n    enableBookTitleLink: true,\n    /**\n     * @type {string} language in ISO 639-1 (PRIVATE: Will also\n     * handle language name in English, native name, 639-2/T, or 639-2/B . (archive.org books\n     * appear to use 639-2/B ? But I don't think that's a guarantee). See\n     * https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes ) */\n    bookLanguage: null,\n\n    // Fields used to populate the info window\n    metadata: [],\n    thumbnail: null,\n    bookUrlMoreInfo: null,\n\n    // Experimental Controls (eg b/w)\n    enableExperimentalControls: false,\n\n    // CSS selectors\n    // Where BookReader mounts to\n    el: '#BookReader',\n\n    // Page progression. Choices: 'lr', 'rl'\n    pageProgression: 'lr',\n\n    // Should image downloads be blocked\n    protected: false,\n\n    // Data is a simple way to populate the bookreader\n    // Example:\n    // [\n    //    // Each child is a spread\n    //   [\n    //     {\n    //       width: 123,\n    //       height: 123,\n    //       // Optional: If not provided, include a getPageURI\n    //       uri: 'https://archive.org/image.jpg',\n    //       // Optional: Shown instead of leaf number if present.\n    //       pageNum: 1\n    //     },\n    //     {width: 123, height: 123, uri: 'https://archive.org/image2.jpg', pageNum: 2},\n    //   ]\n    // ],\n    //\n    // Note if URI is omitted, a custom getPageURI can be provided. This allows the page\n    // URI to the result of a function, which allows for thigns such as dynamic\n    // page scaling.\n    data: [],\n\n    // Advanced methods for page rendering\n    getNumLeafs: null,\n    getPageWidth: null,\n    getPageHeight: null,\n    getPageURI: null,\n\n    // Return which side, left or right, that a given page should be displayed on\n    getPageSide: null,\n\n    // This function returns the left and right indices for the user-visible\n    // spread that contains the given index.  The return values may be\n    // null if there is no facing page or the index is invalid.\n    getSpreadIndices: null,\n\n    getPageNum: null,\n    getPageProp: null,\n    leafNumToIndex: null,\n\n    // Optional: if present, and embed code will be shown in the share dialog\n    getEmbedCode: null,\n};\n\n/**\n * This is here, just in case you need to absolutely override an option.\n */\nBookReader.optionOverrides = {};\n\n/**\n * Setup\n * It is separate from the constructor, so plugins can extend.\n * @param  {Object} options\n */\nBookReader.prototype.setup = function(options) {\n    // Store the options used to setup bookreader\n    this.options = options;\n\n    // @deprecated: Instance constants. Use Class constants instead\n    this.constMode1up = BookReader.constMode1up;\n    this.constMode2up = BookReader.constMode2up;\n    this.constModeThumb = BookReader.constModeThumb;\n\n    // Private properties below. Configuration should be done with options.\n    this.reduce = 4;\n    this.defaults = options.defaults;\n    this.padding = options.padding;\n    this.mode = null;\n    this.prevReadMode = null;\n    this.ui = options.ui;\n    this.uiAutoHide = options.uiAutoHide;\n\n    this.thumbWidth = 100; // will be overridden during prepareThumbnailView\n    this.thumbRowBuffer = options.thumbRowBuffer;\n    this.thumbColumns = options.thumbColumns;\n    this.thumbMaxLoading = options.thumbMaxLoading;\n    this.thumbPadding = options.thumbPadding;\n    this.displayedRows = [];\n\n    this.displayedIndices = [];\n    this.imgs = {};\n    this.prefetchedImgs = {}; //an object with numeric keys cooresponding to page index\n\n    this.animating = false;\n    this.flipSpeed = options.flipSpeed;\n    this.flipDelay = options.flipDelay;\n    this.twoPagePopUp = null;\n    this.leafEdgeTmp  = null;\n\n    /**\n     * Represents the first displayed index\n     * In 2up mode it will be the left page\n     * In 1 up mode it is the highest page\n     * @property {number|null} firstIndex\n     */\n    this.firstIndex = null;\n    this.lastDisplayableIndex2up = null;\n    this.isFullscreenActive = false;\n    this.lastScroll = null;\n\n    this.showLogo = options.showLogo;\n    this.logoURL = options.logoURL;\n    this.imagesBaseURL = options.imagesBaseURL;\n\n    this.reductionFactors = options.reductionFactors;\n    this.onePage = options.onePage;\n    this.twoPage = options.twoPage;\n    this.onePageMinBreakpoint = options.onePageMinBreakpoint;\n\n    this.bookTitle = options.bookTitle;\n    this.bookUrl = options.bookUrl;\n    this.bookUrlText = options.bookUrlText;\n    this.bookUrlTitle = options.bookUrlTitle;\n    this.titleLeaf = options.titleLeaf;\n\n    this.metadata = options.metadata;\n    this.thumbnail = options.thumbnail;\n    this.bookUrlMoreInfo = options.bookUrlMoreInfo;\n\n    this.enableExperimentalControls = options.enableExperimentalControls;\n    this.el = options.el;\n\n    this.pageProgression = options.pageProgression;\n    this.protected = options.protected;\n    this.getEmbedCode = options.getEmbedCode;\n    this.popup = null;\n\n    // Assign the data methods\n    this.data = options.data;\n    this.getNumLeafs = options.getNumLeafs || BookReader.prototype.getNumLeafs;\n    this.getPageWidth = options.getPageWidth  || BookReader.prototype.getPageWidth;\n    this.getPageHeight = options.getPageHeight || BookReader.prototype.getPageHeight;\n    this.getPageURI = options.getPageURI || BookReader.prototype.getPageURI;\n    this.getPageSide = options.getPageSide || BookReader.prototype.getPageSide;\n    this.getPageNum = options.getPageNum || BookReader.prototype.getPageNum;\n    this.getPageProp = options.getPageProp || BookReader.prototype.getPageProp;\n    this.getSpreadIndices = options.getSpreadIndices || BookReader.prototype.getSpreadIndices;\n    this.leafNumToIndex = options.leafNumToIndex || BookReader.prototype.leafNumToIndex;\n    this.refs = {};\n};\n\n/**\n * BookReader.util are static library functions\n * At top of file so they can be used below\n */\nBookReader.util = {\n    disableSelect: function(jObject) {\n        // Bind mouse handlers\n        // Disable mouse click to avoid selected/highlighted page images - bug 354239\n        jObject.bind('mousedown', function() {\n            // $$$ check here for right-click and don't disable.  Also use jQuery style\n            //     for stopping propagation. See https://bugs.edge.launchpad.net/gnubook/+bug/362626\n            return false;\n        });\n        // Special hack for IE7\n        jObject[0].onselectstart = function() { return false; };\n    },\n\n    clamp: function(value, min, max) {\n        return Math.min(Math.max(value, min), max);\n    },\n\n    // Given value and maximum, calculate a percentage suitable for CSS\n    cssPercentage: function(value, max) {\n        return (((value + 0.0) / max) * 100) + '%';\n    },\n\n    notInArray: function(value, array) {\n        // inArray returns -1 or undefined if value not in array\n        return ! (jQuery.inArray(value, array) >= 0);\n    },\n\n    getIFrameDocument: function(iframe) {\n        // Adapted from http://xkr.us/articles/dom/iframe-document/\n        var outer = (iframe.contentWindow || iframe.contentDocument);\n        return (outer.document || outer);\n    },\n\n    escapeHTML: function (str) {\n        return(\n            str.replace(/&/g,'&amp;').\n                replace(/>/g,'&gt;').\n                replace(/</g,'&lt;').\n                replace(/\"/g,'&quot;')\n        );\n    },\n\n    decodeURIComponentPlus: function(value) {\n        // Decodes a URI component and converts '+' to ' '\n        return decodeURIComponent(value).replace(/\\+/g, ' ');\n    },\n\n    encodeURIComponentPlus: function(value) {\n        // Encodes a URI component and converts ' ' to '+'\n        return encodeURIComponent(value).replace(/%20/g, '+');\n    },\n\n    /**\n     * Returns a function, that, as long as it continues to be invoked, will not\n     * be triggered. The function will be called after it stops being called for\n     * N milliseconds. If `immediate` is passed, trigger the function on the\n     * leading edge, instead of the trailing.\n     * @see https://davidwalsh.name/javascript-debounce-function\n     */\n    debounce: function(func, wait, immediate) {\n        var timeout;\n        return function() {\n            var context = this, args = arguments;\n            var later = function() {\n                timeout = null;\n                if (!immediate) func.apply(context, args);\n            };\n            var callNow = immediate && !timeout;\n            clearTimeout(timeout);\n            timeout = setTimeout(later, wait);\n            if (callNow) func.apply(context, args);\n        };\n    },\n\n    /**\n     * Throttle function\n     * @see https://remysharp.com/2010/07/21/throttling-function-calls\n     */\n    throttle: function(fn, threshhold, delay) {\n        threshhold || (threshhold = 250);\n        var last,\n            deferTimer;\n        if (delay) last = +new Date;\n        return function () {\n          var context = this;\n          var now = +new Date,\n              args = arguments;\n          if (last && now < last + threshhold) {\n            // hold on to it\n            clearTimeout(deferTimer);\n            deferTimer = setTimeout(function () {\n              last = now;\n              fn.apply(context, args);\n            }, threshhold);\n          } else {\n            last = now;\n            fn.apply(context, args);\n          }\n        };\n    },\n};\n\n/**\n * Helper to merge in params in to a params object.\n * It normalizes \"page\" into the \"index\" field to disambiguate and prevent concflicts\n * @private\n */\nBookReader.prototype.extendParams = function(params, newParams) {\n    var modifiedNewParams = $.extend({}, newParams);\n    if ('undefined' != typeof(modifiedNewParams.page)) {\n        var pageIndex = this.parsePageString(modifiedNewParams.page);\n        if (!isNaN(pageIndex))\n            modifiedNewParams.index = pageIndex;\n        delete modifiedNewParams.page;\n    }\n    $.extend(params, modifiedNewParams);\n}\n\n/**\n * Parses params from from various initialization contexts (url, cookie, options)\n * @private\n * @return {object} the parased params\n */\nBookReader.prototype.initParams = function() {\n    var params = {};\n\n    // This is ordered from lowest to highest priority\n\n    // If we have a title leaf, use that as the default instead of index 0,\n    // but only use as default if book has a few pages\n    if ('undefined' != typeof(this.titleLeaf) && this.getNumLeafs() > 2) {\n        params.index = this.leafNumToIndex(this.titleLeaf);\n    } else {\n        params.index = 0;\n    }\n\n    // this.defaults is a string passed in the url format. eg \"page/1/mode/1up\"\n    if (this.defaults) {\n        this.extendParams(params, this.paramsFromFragment(this.defaults));\n    }\n\n    // Check for Resume plugin\n    if (this.options.enablePageResume) {\n        // Check cookies\n        var val = this.getResumeValue();\n        if (val !== null) {\n            params.index = val;\n        }\n    }\n\n    if (this.options.enableUrlPlugin) {\n        // params explicitly set in URL take precedence over all other methods\n        var urlParams = this.paramsFromFragment(this.urlReadFragment());\n        if (urlParams.mode) {\n            this.prevReadMode = urlParams.mode;\n        }\n        this.extendParams(params, urlParams);\n    }\n\n    return params;\n}\n\n/**\n * Determines the initial mode for starting if a mode is not already\n * present in the params argument\n * @param {object} params\n * @return {number} the mode\n */\nBookReader.prototype.getInitialMode = function(params) {\n    // Use params or browser width to set view mode\n    var windowWidth = $(window).width();\n    var nextMode;\n    if ('undefined' != typeof(params.mode)) {\n        nextMode = params.mode;\n    } else if (this.ui == 'full'\n          && this.enableMobileNav\n          && this.isFullscreenActive\n          && windowWidth <= this.onePageMinBreakpoint\n    ) {\n        // In full mode, we set the default based on width\n        nextMode = this.constMode1up;\n    } else {\n        nextMode = this.constMode2up;\n    }\n\n    if (!this.canSwitchToMode(nextMode)) {\n        nextMode = this.constMode1up;\n    }\n    return nextMode;\n};\n\n/**\n * This is called by the client to initialize BookReader.\n * It renders onto the DOM. It should only be called once.\n */\nBookReader.prototype.init = function() {\n    this.pageScale = this.reduce; // preserve current reduce\n\n    var params = this.initParams();\n\n    this.firstIndex = params.index ? params.index : 0;\n\n    // Setup Navbars and other UI\n    this.isTouchDevice = !!('ontouchstart' in window) || !!('msmaxtouchpoints' in window.navigator);\n\n    this.refs.$br = $(this.el)\n    .empty()\n    .removeClass()\n    .addClass(\"ui-\" + this.ui)\n    .addClass(\"br-ui-\" + this.ui)\n    .addClass('BookReader');\n\n    // Add a class if this is a touch enabled device\n    if (this.isTouchDevice) {\n        this.refs.$br.addClass(\"touch\");\n    } else {\n        this.refs.$br.addClass(\"no-touch\");\n    }\n\n    this.refs.$brContainer = $(\"<div class='BRcontainer' dir='ltr'></div>\");\n    this.refs.$br.append(this.refs.$brContainer);\n\n    var initialMode = this.getInitialMode(params);\n    this.mode = initialMode;\n\n    if (this.ui == \"embed\" && this.options.showNavbar) {\n        this.initEmbedNavbar();\n    } else {\n        if (this.options.showToolbar) {\n            this.initToolbar(this.mode, this.ui); // Build inside of toolbar div\n        }\n        if (this.options.showNavbar) {\n            this.initNavbar();\n        }\n    }\n\n    this.resizeBRcontainer();\n    this.mode = null; // Needed or else switchMode is a noop\n    this.switchMode(initialMode);\n    this.updateFromParams(params);\n    this.initUIStrings();\n\n    // Bind to events\n\n    if (!this.isTouchDevice) this.setupTooltips();\n    this.bindNavigationHandlers();\n    this.setupKeyListeners();\n\n    this.lastScroll = (new Date().getTime());\n    this.refs.$brContainer.bind('scroll', this, function(e) {\n        // Note, this scroll event fires for both user, and js generated calls\n        // It is functioning in some cases as the primary triggerer for rendering\n        e.data.lastScroll = (new Date().getTime());\n        if (e.data.constMode2up != e.data.mode) {\n          e.data.drawLeafsThrottled();\n        }\n    });\n\n    $(window).bind('resize', this, function(e) {\n        e.data.resize();\n    });\n    $(window).on(\"orientationchange\", this, function(e) {\n        e.data.resize();\n    }.bind(this));\n\n    if (this.protected) {\n        $(document).on('contextmenu dragstart', '.BRpagediv1up', function() {\n            return false;\n        });\n        $(document).on('contextmenu dragstart', '.BRpageimage', function() {\n            return false;\n        });\n        $(document).on('contextmenu dragstart', '.BRpagedivthumb', function() {\n            return false;\n        });\n        this.$('.BRicon.share').hide();\n    }\n\n    this.trigger(BookReader.eventNames.PostInit);\n\n    this.init.initComplete = true;\n}\n\nBookReader.prototype.trigger = function(name, props) {\n    $(document).trigger('BookReader:' + name, this, props);\n};\n\nBookReader.prototype.bind = function(name, callback) {\n    $(document).bind('BookReader:' + name, callback);\n};\n\nBookReader.prototype.unbind = function(name, callback) {\n    $(document).bind('BookReader:' + name, callback);\n};\n\n/**\n * Resizes based on the container width and height\n */\nBookReader.prototype.resize = function() {\n  if (!this.init.initComplete) return;\n\n  this.resizeBRcontainer();\n\n  if (this.constMode1up == this.mode) {\n      if (this.onePage.autofit != 'none') {\n          this.resizePageView1up();\n          this.centerPageView();\n          if (this.enableSearch) this.updateSearchHilites(); //deletes hilights but does not call remove()\n      } else {\n          this.centerPageView();\n          this.displayedIndices = [];\n          if (this.enableSearch) this.updateSearchHilites(); //deletes hilights but does not call remove()\n          this.drawLeafsThrottled();\n      }\n  } else if (this.constModeThumb == this.mode){\n      this.prepareThumbnailView();\n  } else {\n      // We only need to prepare again in autofit (size of spread changes)\n      if (this.twoPage.autofit) {\n          this.prepareTwoPageView();\n      } else {\n          // Re-center if the scrollbars have disappeared\n          var center = this.twoPageGetViewCenter();\n          var doRecenter = false;\n          if (this.twoPage.totalWidth < this.refs.$brContainer.prop('clientWidth')) {\n              center.percentageX = 0.5;\n              doRecenter = true;\n          }\n          if (this.twoPage.totalHeight < this.refs.$brContainer.prop('clientHeight')) {\n              center.percentageY = 0.5;\n              doRecenter = true;\n          }\n          if (doRecenter) {\n              this.twoPageCenterView(center.percentageX, center.percentageY);\n          }\n      }\n  }\n  this.trigger(BookReader.eventNames.resize);\n};\n\n/**\n * Binds keyboard event listeners\n */\nBookReader.prototype.setupKeyListeners = function() {\n    var self = this;\n\n    var KEY_PGUP = 33;\n    var KEY_PGDOWN = 34;\n    var KEY_END = 35;\n    var KEY_HOME = 36;\n\n    var KEY_LEFT = 37;\n    var KEY_UP = 38;\n    var KEY_RIGHT = 39;\n    var KEY_DOWN = 40;\n\n    var KEY_MINUS = 173;\n    var KEY_NUMPAD_SUBTRACT = 109;\n    var KEY_EQUAL = 61;\n    var KEY_NUMPAD_ADD = 107;\n\n    // We use document here instead of window to avoid a bug in jQuery on IE7\n    $(document).keydown(function(e) {\n\n        // Keyboard navigation\n        if (!self.keyboardNavigationIsDisabled(e)) {\n            switch(e.keyCode) {\n                case KEY_PGUP:\n                case KEY_UP:\n                    // In 1up mode page scrolling is handled by browser\n                    if (self.constMode2up == self.mode) {\n                        e.preventDefault();\n                        self.prev();\n                    }\n                    break;\n                case KEY_DOWN:\n                case KEY_PGDOWN:\n                    if (self.constMode2up == self.mode) {\n                        e.preventDefault();\n                        self.next();\n                    }\n                    break;\n                case KEY_END:\n                    e.preventDefault();\n                    self.last();\n                    break;\n                case KEY_HOME:\n                    e.preventDefault();\n                    self.first();\n                    break;\n                case KEY_LEFT:\n                    if (self.constModeThumb != self.mode) {\n                        e.preventDefault();\n                        self.left();\n                    }\n                    break;\n                case KEY_RIGHT:\n                    if (self.constModeThumb != self.mode) {\n                        e.preventDefault();\n                        self.right();\n                    }\n                    break;\n                case KEY_MINUS:\n                case KEY_NUMPAD_SUBTRACT:\n                    e.preventDefault();\n                    self.zoom(-1);\n                    break;\n                case KEY_EQUAL:\n                case KEY_NUMPAD_ADD:\n                    e.preventDefault();\n                    self.zoom(+1);\n                    break;\n            }\n        }\n    });\n};\n\nBookReader.prototype.setupTooltips = function() {\n    this.$('.js-tooltip').each(function(idx, el) {\n        var options = {\n            positions: ['top', 'bottom'],\n            shrinkToFit: true,\n            spikeGirth: 0,\n            spikeLength: 8,\n            fill: 'transparent',\n            cornerRadius: 0,\n            strokeWidth: 0,\n            cssStyles: {},\n        };\n        var $el = $(el);\n        if ($el.parents('.BRtoolbar').length) {\n            options.positions = ['bottom'];\n            options.spikeLength = 12;\n        } else if ($el.parents('.BRfooter').length) {\n            options.positions = ['top'];\n        }\n        $el.bt(options);\n    });\n}\n\nBookReader.prototype.drawLeafs = function() {\n    if (this.constMode1up == this.mode) {\n        this.drawLeafsOnePage();\n    } else if (this.constModeThumb == this.mode) {\n        this.drawLeafsThumbnail();\n    } else {\n        this.drawLeafsTwoPage();\n    }\n};\n\nBookReader.prototype.bindGestures = function(jElement) {\n    // TODO support gesture change is only iOS. Support android.\n    // HACK(2017-01-20) - Momentum scrolling is causing the scroll position\n    // to jump after zooming in on mobile device. I am able to reproduce\n    // when you move the book with one finger and then add another\n    // finger to pinch. Gestures are aware of scroll state.\n\n    var self = this;\n    var numTouches = 1;\n\n    jElement.unbind('touchmove').bind('touchmove', function(e) {\n      if (e.originalEvent.cancelable) numTouches = e.originalEvent.touches.length;\n      e.stopPropagation();\n    });\n\n    jElement.unbind('gesturechange').bind('gesturechange', function(e) {\n        e.preventDefault();\n        // These are two very important fixes to adjust for the scroll position\n        // issues described below\n        if (!(numTouches !== 2 || (new Date().getTime()) - self.lastScroll < 500)) {\n          if (e.originalEvent.scale > 1.5) {\n              self.zoom(1);\n          } else if (e.originalEvent.scale < 0.6) {\n              self.zoom(-1);\n          }\n        }\n    });\n};\n\nBookReader.prototype.setClickHandler2UP = function(element, data, handler) {\n    $(element).unbind('mousedown').bind('mousedown', data, function(e) {\n        handler(this, e);\n    });\n};\n\nBookReader.prototype.drawLeafsOnePage = function() {\n    var containerHeight = this.refs.$brContainer.height();\n    var containerWidth = this.refs.$brPageViewEl.width();\n    var scrollTop = this.refs.$brContainer.prop('scrollTop');\n    var scrollBottom = scrollTop + containerHeight;\n\n    var indicesToDisplay = [];\n    var index;\n    var height;\n\n    var i;\n    var leafTop = 0;\n    var leafBottom = 0;\n\n    for (i=0; i<this.getNumLeafs(); i++) {\n        height  = parseInt(this._getPageHeight(i)/this.reduce);\n\n        leafBottom += height;\n        var topInView    = (leafTop >= scrollTop) && (leafTop <= scrollBottom);\n        var bottomInView = (leafBottom >= scrollTop) && (leafBottom <= scrollBottom);\n        var middleInView = (leafTop <=scrollTop) && (leafBottom>=scrollBottom);\n        if (topInView || bottomInView || middleInView) {\n            indicesToDisplay.push(i);\n        }\n        leafTop += height +10;\n        leafBottom += 10;\n    }\n\n    // Based of the pages displayed in the view we set the current index\n    // $$$ we should consider the page in the center of the view to be the current one\n    var firstIndexToDraw  = indicesToDisplay[0];\n    this.updateFirstIndex(firstIndexToDraw);\n\n    if ((0 != firstIndexToDraw) && (1 < this.reduce)) {\n        firstIndexToDraw--;\n        indicesToDisplay.unshift(firstIndexToDraw);\n    }\n\n    var lastIndexToDraw = indicesToDisplay[indicesToDisplay.length-1];\n    if ( ((this.getNumLeafs()-1) != lastIndexToDraw) && (1 < this.reduce) ) {\n        indicesToDisplay.push(lastIndexToDraw+1);\n    }\n\n    var BRpageViewEl = this.refs.$brPageViewEl.get(0);\n\n    leafTop = 0;\n\n    for (i=0; i<firstIndexToDraw; i++) {\n        leafTop += parseInt(this._getPageHeight(i)/this.reduce) +10;\n    }\n\n    for (i=0; i<indicesToDisplay.length; i++) {\n        index = indicesToDisplay[i];\n        height = parseInt(this._getPageHeight(index)/this.reduce);\n\n        if (BookReader.util.notInArray(indicesToDisplay[i], this.displayedIndices)) {\n            var width = parseInt(this._getPageWidth(index)/this.reduce);\n            var leftMargin = parseInt((containerWidth - width) / 2);\n\n            var div = document.createElement('div');\n            div.className = 'BRpagediv1up pagediv' + index;\n            div.style.position = \"absolute\";\n            div.style.top = leafTop + 'px';\n            div.style.left = leftMargin + 'px';\n            div.style.width = width + 'px';\n            div.style.height = height + 'px';\n\n            BRpageViewEl.appendChild(div);\n\n            var img = document.createElement('img');\n            img.src = this._getPageURI(index, this.reduce, 0);\n            img.className = 'BRnoselect BRonePageImage';\n            img.style.width = width + 'px';\n            img.style.height = height + 'px';\n            div.appendChild(img);\n        }\n\n        leafTop += height +10;\n\n    }\n\n    for (i=0; i<this.displayedIndices.length; i++) {\n        if (BookReader.util.notInArray(this.displayedIndices[i], indicesToDisplay)) {\n            index = this.displayedIndices[i];\n            this.$('.pagediv'+index).remove();\n        }\n    }\n\n    this.displayedIndices = indicesToDisplay.slice();\n    if (this.enableSearch) this.updateSearchHilites();\n\n    this.updateToolbarZoom(this.reduce);\n\n    // Update the slider\n    this.updateNavIndexThrottled();\n};\n\n/**\n * Draws the thumbnail view\n * @param {number} optional If seekIndex is defined, the view will be drawn\n *    with that page visible (without any animated scrolling).\n */\nBookReader.prototype.drawLeafsThumbnail = function(seekIndex) {\n    var viewWidth = this.refs.$brContainer.prop('scrollWidth') - 20; // width minus buffer\n\n    var i;\n    var leafWidth;\n    var leafHeight;\n    var rightPos = 0;\n    var bottomPos = 0;\n    var maxRight = 0;\n    var currentRow = 0;\n    var leafIndex = 0;\n    var leafMap = [];\n\n    var self = this;\n\n    // Will be set to top of requested seek index, if set\n    var seekTop;\n\n    // Calculate the position of every thumbnail.  $$$ cache instead of calculating on every draw\n    for (i=0; i<this.getNumLeafs(); i++) {\n        leafWidth = this.thumbWidth;\n        if (rightPos + (leafWidth + this.thumbPadding) > viewWidth){\n            currentRow++;\n            rightPos = 0;\n            leafIndex = 0;\n        }\n\n        if (leafMap[currentRow]===undefined) { leafMap[currentRow] = {}; }\n        if (leafMap[currentRow].leafs===undefined) {\n            leafMap[currentRow].leafs = [];\n            leafMap[currentRow].height = 0;\n            leafMap[currentRow].top = 0;\n        }\n        leafMap[currentRow].leafs[leafIndex] = {};\n        leafMap[currentRow].leafs[leafIndex].num = i;\n        leafMap[currentRow].leafs[leafIndex].left = rightPos;\n\n        leafHeight = parseInt((this.getPageHeight(leafMap[currentRow].leafs[leafIndex].num)*this.thumbWidth)/this.getPageWidth(leafMap[currentRow].leafs[leafIndex].num), 10);\n        if (leafHeight > leafMap[currentRow].height) {\n            leafMap[currentRow].height = leafHeight;\n        }\n        if (leafIndex===0) { bottomPos += this.thumbPadding + leafMap[currentRow].height; }\n        rightPos += leafWidth + this.thumbPadding;\n        if (rightPos > maxRight) { maxRight = rightPos; }\n        leafIndex++;\n\n        if (i == seekIndex) {\n            seekTop = bottomPos - this.thumbPadding - leafMap[currentRow].height;\n        }\n    }\n\n    // reset the bottom position based on thumbnails\n    this.refs.$brPageViewEl.height(bottomPos);\n\n    var pageViewBuffer = Math.floor((this.refs.$brContainer.prop('scrollWidth') - maxRight) / 2) - 14;\n\n    // If seekTop is defined, seeking was requested and target found\n    if (typeof(seekTop) != 'undefined') {\n        this.refs.$brContainer.scrollTop( seekTop );\n    }\n\n    var scrollTop = this.refs.$brContainer.prop('scrollTop');\n    var scrollBottom = scrollTop + this.refs.$brContainer.height();\n\n    var leafTop = 0;\n    var leafBottom = 0;\n    var rowsToDisplay = [];\n\n    // Visible leafs with least/greatest index\n    var leastVisible = this.getNumLeafs() - 1;\n    var mostVisible = 0;\n\n    // Determine the thumbnails in view\n    for (i=0; i<leafMap.length; i++) {\n        leafBottom += this.thumbPadding + leafMap[i].height;\n        var topInView    = (leafTop >= scrollTop) && (leafTop <= scrollBottom);\n        var bottomInView = (leafBottom >= scrollTop) && (leafBottom <= scrollBottom);\n        var middleInView = (leafTop <=scrollTop) && (leafBottom>=scrollBottom);\n        if (topInView || bottomInView || middleInView) {\n            rowsToDisplay.push(i);\n            if (leafMap[i].leafs[0].num < leastVisible) {\n                leastVisible = leafMap[i].leafs[0].num;\n            }\n            if (leafMap[i].leafs[leafMap[i].leafs.length - 1].num > mostVisible) {\n                mostVisible = leafMap[i].leafs[leafMap[i].leafs.length - 1].num;\n            }\n        }\n        if (leafTop > leafMap[i].top) { leafMap[i].top = leafTop; }\n        leafTop = leafBottom;\n    }\n\n    // create a buffer of preloaded rows before and after the visible rows\n    var firstRow = rowsToDisplay[0];\n    var lastRow = rowsToDisplay[rowsToDisplay.length-1];\n    for (i=1; i<this.thumbRowBuffer+1; i++) {\n        if (lastRow+i < leafMap.length) { rowsToDisplay.push(lastRow+i); }\n    }\n    for (i=1; i<this.thumbRowBuffer+1; i++) {\n        if (firstRow-i >= 0) { rowsToDisplay.push(firstRow-i); }\n    }\n\n    // Create the thumbnail divs and images (lazy loaded)\n    var j;\n    var row;\n    var left;\n    var index;\n    var div;\n    var link;\n    var img;\n    var leaf;\n\n    for (i=0; i<rowsToDisplay.length; i++) {\n        if (BookReader.util.notInArray(rowsToDisplay[i], this.displayedRows)) {\n            row = rowsToDisplay[i];\n\n            for (j=0; j<leafMap[row].leafs.length; j++) {\n                index = j;\n                leaf = leafMap[row].leafs[j].num;\n\n                leafWidth = this.thumbWidth;\n                leafHeight = parseInt((this.getPageHeight(leaf)*this.thumbWidth)/this.getPageWidth(leaf), 10);\n                leafTop = leafMap[row].top;\n                left = leafMap[row].leafs[index].left + pageViewBuffer;\n                if ('rl' == this.pageProgression){\n                    left = viewWidth - leafWidth - left;\n                }\n\n                div = document.createElement(\"div\");\n                div.style.position = \"absolute\";\n                div.className = 'BRpagedivthumb pagediv' + leaf;\n\n                left += this.thumbPadding;\n                div.style.top = leafTop + 'px';\n                div.style.left = left + 'px';\n                div.style.width = leafWidth + 'px';\n                div.style.height = leafHeight + 'px';\n\n                // link back to page\n                link = document.createElement(\"a\");\n                $(link).data('leaf', leaf);\n                link.addEventListener('mouseup', function(event) {\n                  // We want to suppress the fragmentChange triggers in `updateFirstIndex` and `switchMode`\n                  // because otherwise it repeatedly triggers listeners and we get in an infinite loop.\n                  // We manually trigger the `fragmentChange` once at the end.\n                  self.updateFirstIndex($(this).data('leaf'), { suppressFragmentChange: true });\n                  if (self.prevReadMode === self.constMode1up\n                        || self.prevReadMode === self.constMode2up) {\n                    self.switchMode(self.prevReadMode, { suppressFragmentChange: true });\n                  } else {\n                    self.switchMode(self.constMode1up, { suppressFragmentChange: true });\n                  }\n                  self.trigger(BookReader.eventNames.fragmentChange);\n                  event.preventDefault();\n                  event.stopPropagation();\n                }, true);\n                $(div).append(link);\n\n                this.refs.$brPageViewEl.append(div);\n\n                img = document.createElement(\"img\");\n                var thumbReduce = Math.floor(this.getPageWidth(leaf) / this.thumbWidth);\n\n                $(img).attr('src', this.imagesBaseURL + 'transparent.png')\n                    .css({'width': leafWidth+'px', 'height': leafHeight+'px' })\n                    .addClass('BRlazyload')\n                    // Store the URL of the image that will replace this one\n                    .data('srcURL',  this._getPageURI(leaf, thumbReduce));\n                $(link).append(img);\n            }\n        }\n    }\n\n    // Remove thumbnails that are not to be displayed\n    var k;\n    for (i=0; i<this.displayedRows.length; i++) {\n        if (BookReader.util.notInArray(this.displayedRows[i], rowsToDisplay)) {\n            row = this.displayedRows[i];\n            for (k=0; k<leafMap[row].leafs.length; k++) {\n                index = leafMap[row].leafs[k].num;\n                this.$('.pagediv'+index).remove();\n            }\n        }\n    }\n\n    // Update which page is considered current to make sure a visible page is the current one\n    var currentIndex = this.currentIndex();\n    if (currentIndex < leastVisible) {\n        this.updateFirstIndex(leastVisible);\n    } else if (currentIndex > mostVisible) {\n        this.updateFirstIndex(mostVisible);\n    }\n\n    this.displayedRows = rowsToDisplay.slice();\n\n    // remove previous highlights\n    this.$('.BRpagedivthumb_highlight').removeClass('BRpagedivthumb_highlight');\n\n    // highlight current page\n    this.$('.pagediv'+this.currentIndex()).addClass('BRpagedivthumb_highlight');\n\n    this.lazyLoadThumbnails();\n\n    this.updateToolbarZoom(this.reduce);\n};\n\nBookReader.prototype.lazyLoadThumbnails = function() {\n    // We check the complete property since load may not be fired if loading from the cache\n    this.$('.BRlazyloading').filter('[complete=true]').removeClass('BRlazyloading');\n\n    var loading = this.$('.BRlazyloading').length;\n    var toLoad = this.thumbMaxLoading - loading;\n\n    var self = this;\n\n    if (toLoad > 0) {\n        // $$$ TODO load those near top (but not beyond) page view first\n        this.refs.$brPageViewEl.find('img.BRlazyload').filter(':lt(' + toLoad + ')').each( function() {\n            self.lazyLoadImage(this);\n        });\n    }\n};\n\nBookReader.prototype.lazyLoadImage = function (dummyImage) {\n    var img = new Image();\n    var self = this;\n\n    $(img)\n        .addClass('BRlazyloading')\n        .one('load', function() {\n            $(this).removeClass('BRlazyloading');\n\n            // $$$ Calling lazyLoadThumbnails here was causing stack overflow on IE so\n            //     we call the function after a slight delay.  Also the img.complete property\n            //     is not yet set in IE8 inside this onload handler\n            setTimeout(function() { self.lazyLoadThumbnails(); }, 100);\n        })\n        .one('error', function() {\n            // Remove class so we no longer count as loading\n            $(this).removeClass('BRlazyloading');\n        })\n\n        //the width set with .attr is ignored by Internet Explorer, causing it to show the image at its original size\n        //but with this one line of css, even IE shows the image at the proper size\n        .css({\n            'width': $(dummyImage).width()+'px',\n            'height': $(dummyImage).height()+'px'\n        })\n        .attr({\n            'width': $(dummyImage).width(),\n            'height': $(dummyImage).height(),\n            'src': $(dummyImage).data('srcURL')\n        });\n\n    // replace with the new img\n    $(dummyImage).before(img).remove();\n\n    img = null; // tidy up closure\n};\n\nBookReader.prototype.drawLeafsTwoPage = function() {\n    var $twoPageViewEl = this.refs.$brTwoPageView;\n\n    // $$$ we should use calculated values in this.twoPage (recalc if necessary)\n    var indexL = this.twoPage.currentIndexL;\n    var top = this.twoPageTop();\n\n    this.twoPage.scaledWL = this.getPageWidth2UP(indexL);\n    this.twoPage.gutter = this.twoPageGutter();\n\n    this.prefetchImg(indexL);\n    $(this.prefetchedImgs[indexL]).css({\n        position: 'absolute',\n        left: this.twoPage.gutter-this.twoPage.scaledWL+'px',\n        right: '',\n        top:    top+'px',\n        height: this.twoPage.height +'px', // $$$ height forced the same for both pages\n        width:  this.twoPage.scaledWL + 'px',\n        zIndex: 2\n    }).appendTo($twoPageViewEl);\n\n    var indexR = this.twoPage.currentIndexR;\n\n    // $$$ should use getwidth2up?\n    this.twoPage.scaledWR = this.getPageWidth2UP(indexR);\n    this.prefetchImg(indexR);\n    $(this.prefetchedImgs[indexR]).css({\n        position: 'absolute',\n        left:   this.twoPage.gutter+'px',\n        right: '',\n        top:    top+'px',\n        height: this.twoPage.height + 'px', // $$$ height forced the same for both pages\n        width:  this.twoPage.scaledWR + 'px',\n        zIndex: 2\n    }).appendTo($twoPageViewEl);\n\n\n    this.displayedIndices = [this.twoPage.currentIndexL, this.twoPage.currentIndexR];\n    this.setMouseHandlers2UP();\n    this.updateToolbarZoom(this.reduce);\n};\n\n/**\n * A throttled version of drawLeafs\n */\nBookReader.prototype.drawLeafsThrottled = BookReader.util.throttle(\n    BookReader.prototype.drawLeafs,\n    250 // 250 ms gives quick feedback, but doesn't eat cpu\n);\n\n/**\n * @param {number} direction Pass 1 to zoom in, anything else to zoom out\n */\nBookReader.prototype.zoom = function(direction) {\n    switch (this.mode) {\n        case this.constMode1up:\n            if (direction == 1) {\n                // XXX other cases\n                this.zoom1up('in');\n            } else {\n                this.zoom1up('out');\n            }\n            break\n        case this.constMode2up:\n            if (direction == 1) {\n                // XXX other cases\n                this.zoom2up('in');\n            } else {\n                this.zoom2up('out');\n            }\n            break\n        case this.constModeThumb:\n            // XXX update zoomThumb for named directions\n            this.zoomThumb(direction);\n            break\n    }\n    return;\n};\n\nBookReader.prototype.zoom1up = function(direction) {\n    if (this.constMode2up == this.mode) {     //can only zoom in 1-page mode\n        this.switchMode(this.constMode1up);\n        return;\n    }\n\n    var reduceFactor = this.nextReduce(this.reduce, direction, this.onePage.reductionFactors);\n\n    if (this.reduce == reduceFactor.reduce) {\n        // Already at this level\n        return;\n    }\n\n    this.reduce = reduceFactor.reduce; // $$$ incorporate into function\n    this.onePage.autofit = reduceFactor.autofit;\n\n    this.pageScale = this.reduce; // preserve current reduce\n\n    this.resizePageView1up();\n    this.updateToolbarZoom(this.reduce);\n\n    // Recalculate search hilites\n    if (this.enableSearch) this.removeSearchHilites();\n    if (this.enableSearch) this.updateSearchHilites();\n};\n\n/**\n * Resizes the inner container to fit within the visible space to prevent\n * the top toolbar and bottom navbar from clipping the visible book\n *\n * @param { boolean } animate - optional\n * When used, BookReader will fill the main container with the book's content.\n * This is primarily for 1up view - a follow up animation to the nav animation\n * So resize isn't perceived sharp/jerky\n */\nBookReader.prototype.resizeBRcontainer = function(animate) {\n    if (animate) {\n        this.refs.$brContainer.animate({\n            top: this.getToolBarHeight(),\n            bottom: this.getFooterHeight()\n        }, this.constResizeAnimationDuration, 'linear');\n    } else {\n        this.refs.$brContainer.css({\n            top: this.getToolBarHeight(),\n            bottom: this.getFooterHeight()\n        });\n    }\n}\n\n/**\n * Resize the current one page view\n * Note this calls drawLeafs\n */\nBookReader.prototype.resizePageView1up = function() {\n    var viewWidth  = this.refs.$brContainer.prop('clientWidth');\n    var oldScrollTop  = this.refs.$brContainer.prop('scrollTop');\n    var oldPageViewHeight = this.refs.$brPageViewEl.height();\n    var oldPageViewWidth = this.refs.$brPageViewEl.width();\n\n    // May have come here after preparing the view, in which case the scrollTop and view height are not set\n\n    var scrollRatio = 0;\n    if (oldScrollTop > 0) {\n        // We have scrolled - implies view has been set up\n        var oldCenterY = this.centerY1up();\n        var oldCenterX = this.centerX1up();\n        scrollRatio = oldCenterY / oldPageViewHeight;\n    } else {\n        // Have not scrolled, e.g. because in new container\n\n        // We set the scroll ratio so that the current index will still be considered the\n        // current index in drawLeafsOnePage after we create the new view container\n\n        // Make sure this will count as current page after resize\n        var fudgeFactor = (this.getPageHeight(this.currentIndex()) / this.reduce) * 0.6;\n        var oldLeafTop = this.onePageGetPageTop(this.currentIndex()) + fudgeFactor;\n        var oldViewDimensions = this.onePageCalculateViewDimensions(this.reduce, this.padding);\n        scrollRatio = oldLeafTop / oldViewDimensions.height;\n    }\n\n    // Recalculate 1up reduction factors\n    this.onePageCalculateReductionFactors();\n    // Update current reduce (if in autofit)\n    if (this.onePage.autofit) {\n        var reductionFactor = this.nextReduce(this.reduce, this.onePage.autofit, this.onePage.reductionFactors);\n        this.reduce = reductionFactor.reduce;\n    }\n\n    var viewDimensions = this.onePageCalculateViewDimensions(this.reduce, this.padding);\n\n    this.refs.$brPageViewEl.height(viewDimensions.height);\n    this.refs.$brPageViewEl.width(viewDimensions.width);\n\n\n    var newCenterY = scrollRatio*viewDimensions.height;\n    var newTop = Math.max(0, Math.floor( newCenterY - this.refs.$brContainer.height()/2 ));\n    this.refs.$brContainer.prop('scrollTop', newTop);\n\n    // We use clientWidth here to avoid miscalculating due to scroll bar\n    var newCenterX = oldCenterX * (viewWidth / oldPageViewWidth);\n    var newLeft = newCenterX - this.refs.$brContainer.prop('clientWidth') / 2;\n    newLeft = Math.max(newLeft, 0);\n    this.refs.$brContainer.prop('scrollLeft', newLeft);\n\n    this.refs.$brPageViewEl.empty();\n    this.displayedIndices = [];\n    this.drawLeafs();\n\n    if (this.enableSearch) {\n        this.removeSearchHilites();\n        this.updateSearchHilites();\n    }\n};\n\n/**\n * Calculate the dimensions for a one page view with images at the given reduce and padding\n */\nBookReader.prototype.onePageCalculateViewDimensions = function(reduce, padding) {\n    var viewWidth = 0;\n    var viewHeight = 0;\n    for (var i=0; i<this.getNumLeafs(); i++) {\n        viewHeight += parseInt(this._getPageHeight(i)/reduce) + padding;\n        var width = parseInt(this._getPageWidth(i)/reduce);\n        if (width>viewWidth) viewWidth=width;\n    }\n    return { width: viewWidth, height: viewHeight }\n};\n\n/**\n * Returns the current offset of the viewport center in scaled document coordinates.\n * @return {number}\n */\nBookReader.prototype.centerX1up = function() {\n    var centerX;\n    if (this.refs.$brPageViewEl.width() < this.refs.$brContainer.prop('clientWidth')) { // fully shown\n        centerX = this.refs.$brPageViewEl.width();\n    } else {\n        centerX = this.refs.$brContainer.prop('scrollLeft') + this.refs.$brContainer.prop('clientWidth') / 2;\n    }\n    centerX = Math.floor(centerX);\n    return centerX;\n};\n\n/**\n * Returns the current offset of the viewport center in scaled document coordinates.\n * @return {number}\n */\nBookReader.prototype.centerY1up = function() {\n    var centerY = this.refs.$brContainer.prop('scrollTop') + this.refs.$brContainer.height() / 2;\n    return Math.floor(centerY);\n};\n\nBookReader.prototype.centerPageView = function() {\n    var scrollWidth  = this.refs.$brContainer.prop('scrollWidth');\n    var clientWidth  =  this.refs.$brContainer.prop('clientWidth');\n    if (scrollWidth > clientWidth) {\n        this.refs.$brContainer.prop('scrollLeft', (scrollWidth-clientWidth)/2);\n    }\n};\n\nBookReader.prototype.zoom2up = function(direction) {\n    this.stopFlipAnimations();\n\n    // Recalculate autofit factors\n    this.twoPageCalculateReductionFactors();\n\n    // Get new zoom state\n    var reductionFactor = this.nextReduce(this.reduce, direction, this.twoPage.reductionFactors);\n    if ((this.reduce == reductionFactor.reduce) && (this.twoPage.autofit == reductionFactor.autofit)) {\n        // Same zoom\n        return;\n    }\n    this.twoPage.autofit = reductionFactor.autofit;\n    this.reduce = reductionFactor.reduce;\n    this.pageScale = this.reduce; // preserve current reduce\n\n    // Preserve view center position\n    var oldCenter = this.twoPageGetViewCenter();\n\n    // If zooming in, reload imgs.  DOM elements will be removed by prepareTwoPageView\n    // $$$ An improvement would be to use the low res image until the larger one is loaded.\n    if (1 == direction) {\n        for (var img in this.prefetchedImgs) {\n            delete this.prefetchedImgs[img];\n        }\n    }\n\n    // Prepare view with new center to minimize visual glitches\n    this.prepareTwoPageView(oldCenter.percentageX, oldCenter.percentageY);\n};\n\nBookReader.prototype.zoomThumb = function(direction) {\n    var oldColumns = this.thumbColumns;\n    switch (direction) {\n        case -1:\n            this.thumbColumns += 1;\n            break;\n        case 1:\n            this.thumbColumns -= 1;\n            break;\n    }\n\n    // clamp\n    if (this.thumbColumns < 2) {\n        this.thumbColumns = 2;\n    } else if (this.thumbColumns > 8) {\n        this.thumbColumns = 8;\n    }\n\n    if (this.thumbColumns != oldColumns) {\n        this.prepareThumbnailView();\n    }\n};\n\n/**\n * Returns the width per thumbnail to display the requested number of columns\n * Note: #BRpageview must already exist since its width is used to calculate the\n *       thumbnail width\n * @param {number}\n * @param {number}\n */\nBookReader.prototype.getThumbnailWidth = function(thumbnailColumns) {\n    var padding = (thumbnailColumns + 1) * this.thumbPadding;\n    var width = (this.refs.$brPageViewEl.width() - padding) / (thumbnailColumns + 0.5); // extra 0.5 is for some space at sides\n    return parseInt(width);\n};\n\n/**\n * Quantizes the given reduction factor to closest power of two from set from 12.5% to 200%\n * @param {number}\n * @param {array}\n * @return {number}\n */\nBookReader.prototype.quantizeReduce = function(reduce, reductionFactors) {\n    var quantized = reductionFactors[0].reduce;\n    var distance = Math.abs(reduce - quantized);\n    var newDistance;\n\n    for (var i = 1; i < reductionFactors.length; i++) {\n        newDistance = Math.abs(reduce - reductionFactors[i].reduce);\n        if (newDistance < distance) {\n            distance = newDistance;\n            quantized = reductionFactors[i].reduce;\n        }\n    }\n    return quantized;\n};\n\n/**\n * @param {number}\n * @param {string}\n * @param {array} reductionFactors should be array of sorted reduction factors\n *   e.g. [ {reduce: 0.25, autofit: null}, {reduce: 0.3, autofit: 'width'}, {reduce: 1, autofit: null} ]\n */\nBookReader.prototype.nextReduce = function(currentReduce, direction, reductionFactors) {\n    // XXX add 'closest', to replace quantize function\n    var i;\n    var newReduceIndex;\n\n    if (direction === 'in') {\n        newReduceIndex = 0;\n        for (i = 1; i < reductionFactors.length; i++) {\n            if (reductionFactors[i].reduce < currentReduce) {\n                newReduceIndex = i;\n            }\n        }\n        return reductionFactors[newReduceIndex];\n    } else if (direction === 'out') { // zoom out\n        var lastIndex = reductionFactors.length - 1;\n        newReduceIndex = lastIndex;\n\n        for (i = lastIndex; i >= 0; i--) {\n            if (reductionFactors[i].reduce > currentReduce) {\n                newReduceIndex = i;\n            }\n        }\n        return reductionFactors[newReduceIndex];\n    } else if (direction === 'auto') {\n      // Auto mode chooses the least reduction\n      var choice = null;\n      for (i = 0; i < reductionFactors.length; i++) {\n          if (reductionFactors[i].autofit === 'height' || reductionFactors[i].autofit === 'width') {\n              if (choice === null || choice.reduce < reductionFactors[i].reduce) {\n                  choice = reductionFactors[i];\n              }\n          }\n      }\n      if (choice) {\n          return choice;\n      }\n    } else if (direction === 'height' || direction === 'width') {\n      // Asked for specific autofit mode\n      for (i = 0; i < reductionFactors.length; i++) {\n          if (reductionFactors[i].autofit === direction) {\n              return reductionFactors[i];\n          }\n      }\n    }\n\n    alert('Could not find reduction factor for direction ' + direction);\n    return reductionFactors[0];\n\n};\n\nBookReader.prototype._reduceSort = function(a, b) {\n    return a.reduce - b.reduce;\n};\n\n/**\n * Attempts to jump to page\n * @param {string}\n * @return {boolean} Returns true if page could be found, false otherwise.\n */\nBookReader.prototype.jumpToPage = function(pageNum) {\n    var pageIndex = this.parsePageString(pageNum);\n\n    if ('undefined' != typeof(pageIndex)) {\n        this.jumpToIndex(pageIndex);\n        return true;\n    }\n\n    // Page not found\n    return false;\n};\n\n/**\n * Changes the current page\n * @param {number}\n * @param {number} optional\n * @param {number} optional\n * @param {boolean} optional\n */\nBookReader.prototype.jumpToIndex = function(index, pageX, pageY, noAnimate) {\n    var self = this;\n    var prevCurrentIndex = this.currentIndex();\n    var offset = 0;\n    var leafTop = 0;\n    var leafLeft = 0;\n\n    this.trigger(BookReader.eventNames.stop);\n\n    if (this.constMode2up == this.mode) {\n        // By checking against min/max we do nothing if requested index\n        // is current\n        if (index < Math.min(this.twoPage.currentIndexL, this.twoPage.currentIndexR)) {\n            this.flipBackToIndex(index);\n        } else if (index > Math.max(this.twoPage.currentIndexL, this.twoPage.currentIndexR)) {\n            this.flipFwdToIndex(index);\n        }\n\n    } else if (this.constModeThumb == this.mode) {\n        var viewWidth = this.refs.$brContainer.prop('scrollWidth') - 20; // width minus buffer\n        var i;\n        var leafWidth = 0;\n        var leafHeight = 0;\n        var rightPos = 0;\n        var bottomPos = 0;\n        var rowHeight = 0;\n        var leafIndex = 0;\n\n        for (i=0; i<(index+1); i++) {\n            leafWidth = this.thumbWidth;\n            if (rightPos + (leafWidth + this.thumbPadding) > viewWidth){\n                rightPos = 0;\n                rowHeight = 0;\n                leafIndex = 0;\n            }\n\n            leafHeight = parseInt((this.getPageHeight(leafIndex)*this.thumbWidth)/this.getPageWidth(leafIndex), 10);\n            if (leafHeight > rowHeight) { rowHeight = leafHeight; }\n            if (leafIndex==0) { leafTop = bottomPos; }\n            if (leafIndex==0) { bottomPos += this.thumbPadding + rowHeight; }\n            rightPos += leafWidth + this.thumbPadding;\n            leafIndex++;\n        }\n        this.updateFirstIndex(index);\n        if (this.refs.$brContainer.prop('scrollTop') == leafTop) {\n            this.drawLeafs();\n        } else {\n            this.animating = true;\n            this.refs.$brContainer.stop(true).animate({\n                scrollTop: leafTop,\n            }, 'fast', function() {\n                self.animating = false;\n            });\n        }\n    } else {\n        // 1up\n        leafTop = this.onePageGetPageTop(index);\n\n        if (pageY) {\n            offset = parseInt( (pageY) / this.reduce);\n            offset -= this.refs.$brContainer.prop('clientHeight') >> 1;\n            leafTop += offset;\n        } else {\n            // Show page just a little below the top\n            leafTop -= this.padding / 2;\n        }\n\n        if (pageX) {\n            offset = parseInt( (pageX) / this.reduce);\n            offset -= this.refs.$brContainer.prop('clientWidth') >> 1;\n            leafLeft += offset;\n        } else {\n            // Preserve left position\n            leafLeft = this.refs.$brContainer.scrollLeft();\n        }\n\n        // Only animate for small distances\n        if (!noAnimate && Math.abs(prevCurrentIndex - index) <= 4) {\n            this.animating = true;\n            this.refs.$brContainer.stop(true).animate({\n                scrollTop: leafTop,\n                scrollLeft: leafLeft,\n            }, 'fast', function() {\n                self.animating = false;\n            });\n        } else {\n            this.refs.$brContainer.stop(true).prop('scrollTop', leafTop);\n        }\n    }\n};\n\n/**\n * Switches the mode (eg 1up 2up thumb)\n * @param {number}\n */\nBookReader.prototype.switchMode = function(mode, options) {\n    if (mode === this.mode) {\n        return;\n    }\n\n    if (!this.canSwitchToMode(mode)) {\n        return;\n    }\n\n    this.trigger(BookReader.eventNames.stop);\n    if (this.enableSearch) this.removeSearchHilites();\n\n    if (this.mode === this.constMode1up || this.mode === this.constMode2up) {\n      this.prevReadMode = this.mode;\n    }\n\n    this.mode = mode;\n\n    // reinstate scale if moving from thumbnail view\n    if (this.pageScale !== this.reduce) {\n        this.reduce = this.pageScale;\n    }\n\n    // $$$ TODO preserve center of view when switching between mode\n    //     See https://bugs.edge.launchpad.net/gnubook/+bug/416682\n\n    // XXX maybe better to preserve zoom in each mode\n    if (this.constMode1up == mode) {\n        this.onePageCalculateReductionFactors();\n        this.reduce = this.quantizeReduce(this.reduce, this.onePage.reductionFactors);\n        this.prepareOnePageView();\n    } else if (this.constModeThumb == mode) {\n        this.reduce = this.quantizeReduce(this.reduce, this.reductionFactors);\n        this.prepareThumbnailView();\n    } else {\n        // $$$ why don't we save autofit?\n        // this.twoPage.autofit = null; // Take zoom level from other mode\n        this.twoPageCalculateReductionFactors();\n        this.reduce = this.quantizeReduce(this.reduce, this.twoPage.reductionFactors);\n        this.prepareTwoPageView();\n        this.twoPageCenterView(0.5, 0.5); // $$$ TODO preserve center\n    }\n\n    if (!options || options.suppressFragmentChange === false) {\n      this.trigger(BookReader.eventNames.fragmentChange);\n    }\n    var eventName = mode + 'PageViewSelected';\n    this.trigger(BookReader.eventNames[eventName]);\n};\n\nBookReader.prototype.updateBrClasses = function() {\n    var modeToClass = {};\n    modeToClass[this.constMode1up] = 'BRmode1up';\n    modeToClass[this.constMode2up] = 'BRmode2up';\n    modeToClass[this.constModeThumb] = 'BRmodeThumb';\n\n    this.refs.$br\n    .removeClass('BRmode1up BRmode2up BRmodeThumb')\n    .addClass(modeToClass[this.mode]);\n\n    if (this.isFullscreen()) {\n        this.refs.$br.addClass('fullscreenActive');\n        $(document.body).addClass('BRfullscreenActive');\n    } else {\n        this.refs.$br.removeClass('fullscreenActive');\n        $(document.body).removeClass('BRfullscreenActive');\n    }\n};\n\nBookReader.prototype.isFullscreen = function() {\n    return this.isFullscreenActive;\n};\n\nBookReader.prototype.toggleFullscreen = function() {\n    if (this.isFullscreen()) {\n        this.exitFullScreen();\n    } else {\n        this.enterFullscreen();\n    }\n    this.trigger('fullscreenToggled');\n};\n\nBookReader.prototype.enterFullscreen = function() {\n    this.refs.$brContainer.css('opacity', 0);\n\n    var windowWidth = $(window).width();\n    if (windowWidth <= this.onePageMinBreakpoint) {\n        this.switchMode(this.constMode1up);\n    }\n\n    this.isFullscreenActive = true;\n    this.updateBrClasses();\n\n    this.resize();\n    this.jumpToIndex(this.currentIndex());\n\n    this.refs.$brContainer.animate({opacity: 1}, 400, 'linear');\n\n    this._fullscreenCloseHandler = function (e) {\n        if (e.keyCode === 27) this.toggleFullscreen();\n    }.bind(this);\n    $(document).keyup(this._fullscreenCloseHandler);\n};\n\nBookReader.prototype.exitFullScreen = function() {\n    this.refs.$brContainer.css('opacity', 0);\n\n    $(document).unbind('keyup', this._fullscreenCloseHandler);\n\n    var windowWidth = $(window).width();\n    if (windowWidth <= this.onePageMinBreakpoint) {\n        this.switchMode(this.constMode2up);\n    }\n\n    this.isFullscreenActive = false;\n    this.updateBrClasses()\n\n    this.resize();\n    this.refs.$brContainer.animate({opacity: 1}, 400, 'linear');\n};\n\n/**\n * This is called when we switch to one page view\n */\nBookReader.prototype.prepareOnePageView = function() {\n    var startLeaf = this.currentIndex();\n\n    this.refs.$brContainer.empty();\n    this.refs.$brContainer.css({\n        overflowY: 'scroll',\n        overflowX: 'auto'\n    });\n\n    this.refs.$brPageViewEl = $(\"<div class='BRpageview'></div>\");\n    this.refs.$brContainer.append(this.refs.$brPageViewEl);\n\n    // Attaches to first child - child must be present\n    this.refs.$brContainer.dragscrollable();\n    this.bindGestures(this.refs.$brContainer);\n\n    // $$$ keep select enabled for now since disabling it breaks keyboard\n    //     nav in FF 3.6 (https://bugs.edge.launchpad.net/bookreader/+bug/544666)\n    // BookReader.util.disableSelect(this.$('#BRpageview'));\n\n    this.resizePageView1up();\n    this.jumpToIndex(startLeaf);\n    this.updateBrClasses();\n};\n\nBookReader.prototype.prepareThumbnailView = function() {\n    this.refs.$brContainer.empty();\n    this.refs.$brContainer.css({\n        overflowY: 'scroll',\n        overflowX: 'auto'\n    });\n\n    this.refs.$brPageViewEl = $(\"<div class='BRpageview'></div>\");\n    this.refs.$brContainer.append(this.refs.$brPageViewEl);\n    this.refs.$brContainer.dragscrollable({preventDefault:true});\n\n    this.bindGestures(this.refs.$brContainer);\n\n    // $$$ keep select enabled for now since disabling it breaks keyboard\n    //     nav in FF 3.6 (https://bugs.edge.launchpad.net/bookreader/+bug/544666)\n    // BookReader.util.disableSelect(this.$('#BRpageview'));\n\n    this.thumbWidth = this.getThumbnailWidth(this.thumbColumns);\n    this.reduce = this.getPageWidth(0)/this.thumbWidth;\n\n    this.displayedRows = [];\n\n    // Draw leafs with current index directly in view (no animating to the index)\n    this.drawLeafsThumbnail( this.currentIndex() );\n    this.updateBrClasses();\n};\n\n/**\n * @param {number}\n * @param {number}\n */\nBookReader.prototype.prepareTwoPageView = function(centerPercentageX, centerPercentageY) {\n    // Some decisions about two page view:\n    //\n    // Both pages will be displayed at the same height, even if they were different physical/scanned\n    // sizes.  This simplifies the animation (from a design as well as technical standpoint).  We\n    // examine the page aspect ratios (in calculateSpreadSize) and use the page with the most \"normal\"\n    // aspect ratio to determine the height.\n    //\n    // The two page view div is resized to keep the middle of the book in the middle of the div\n    // even as the page sizes change.  To e.g. keep the middle of the book in the middle of the BRcontent\n    // div requires adjusting the offset of BRtwpageview and/or scrolling in BRcontent.\n    this.refs.$brContainer.empty();\n    this.refs.$brContainer.css('overflow', 'auto');\n\n    // We want to display two facing pages.  We may be missing\n    // one side of the spread because it is the first/last leaf,\n    // foldouts, missing pages, etc\n\n    var targetLeaf = this.firstIndex;\n\n    if (targetLeaf < this.firstDisplayableIndex()) {\n        targetLeaf = this.firstDisplayableIndex();\n    }\n\n    if (targetLeaf > this.lastDisplayableIndex()) {\n        targetLeaf = this.lastDisplayableIndex();\n    }\n\n    var currentSpreadIndices = this.getSpreadIndices(targetLeaf);\n    this.twoPage.currentIndexL = currentSpreadIndices[0];\n    this.twoPage.currentIndexR = currentSpreadIndices[1];\n\n    this.calculateSpreadSize(); //sets twoPage.width, twoPage.height and others\n\n    this.pruneUnusedImgs();\n    this.prefetch(); // Preload images or reload if scaling has changed\n\n    // Add the two page view\n    // $$$ Can we get everything set up and then append?\n    var $twoPageViewEl = $('<div class=\"BRtwopageview\"></div>');\n    this.refs.$brTwoPageView = $twoPageViewEl;\n    this.refs.$brContainer.append($twoPageViewEl);\n\n    // Attaches to first child, so must come after we add the page view\n    this.refs.$brContainer.dragscrollable({preventDefault:true});\n    this.bindGestures(this.refs.$brContainer);\n\n    // $$$ calculate first then set\n    this.refs.$brTwoPageView.css({\n        height: this.twoPage.totalHeight + 'px',\n        width: this.twoPage.totalWidth + 'px',\n        position: 'absolute'\n    });\n\n    // If there will not be scrollbars (e.g. when zooming out) we center the book\n    // since otherwise the book will be stuck off-center\n    if (this.twoPage.totalWidth < this.refs.$brContainer.prop('clientWidth')) {\n        centerPercentageX = 0.5;\n    }\n    if (this.twoPage.totalHeight < this.refs.$brContainer.prop('clientHeight')) {\n        centerPercentageY = 0.5;\n    }\n\n    this.twoPageCenterView(centerPercentageX, centerPercentageY);\n\n    this.twoPage.coverDiv = document.createElement('div');\n    $(this.twoPage.coverDiv).attr('class', 'BRbookcover').css({\n        width:  this.twoPage.bookCoverDivWidth + 'px',\n        height: this.twoPage.bookCoverDivHeight+'px',\n        visibility: 'visible'\n    }).appendTo(this.refs.$brTwoPageView);\n\n    this.leafEdgeR = document.createElement('div');\n    this.leafEdgeR.className = 'BRleafEdgeR';\n\n    $(this.leafEdgeR).css({\n        width: this.twoPage.leafEdgeWidthR + 'px',\n        height: this.twoPage.height + 'px',\n        left: this.twoPage.gutter+this.twoPage.scaledWR+'px',\n        top: this.twoPage.bookCoverDivTop+this.twoPage.coverInternalPadding+'px',\n        border: this.twoPage.leafEdgeWidthR === 0 ? 'none' : null\n    }).appendTo(this.refs.$brTwoPageView);\n\n    this.leafEdgeL = document.createElement('div');\n    this.leafEdgeL.className = 'BRleafEdgeL';\n    $(this.leafEdgeL).css({\n        width: this.twoPage.leafEdgeWidthL + 'px',\n        height: this.twoPage.height + 'px',\n        left: this.twoPage.bookCoverDivLeft+this.twoPage.coverInternalPadding+'px',\n        top: this.twoPage.bookCoverDivTop+this.twoPage.coverInternalPadding+'px',\n        border: this.twoPage.leafEdgeWidthL === 0 ? 'none' : null\n    }).appendTo(this.refs.$brTwoPageView);\n\n    var div = document.createElement('div');\n    $(div).attr('class', 'BRgutter').css({\n        width:           this.twoPage.bookSpineDivWidth+'px',\n        height:          this.twoPage.bookSpineDivHeight+'px',\n        left:            (this.twoPage.gutter - this.twoPage.bookSpineDivWidth*0.5)+'px',\n        top:             this.twoPage.bookSpineDivTop+'px'\n    }).appendTo(this.refs.$brTwoPageView);\n\n    this.prepareTwoPagePopUp();\n\n    this.displayedIndices = [];\n\n    this.drawLeafsTwoPage();\n    this.updateToolbarZoom(this.reduce);\n\n    this.prefetch();\n\n    if (this.enableSearch) {\n        this.removeSearchHilites();\n        this.updateSearchHilites();\n    }\n\n    this.updateBrClasses();\n};\n\n/**\n * This function prepares the \"View Page n\" popup that shows while the mouse is\n * over the left/right \"stack of sheets\" edges.  It also binds the mouse\n * events for these divs.\n */\nBookReader.prototype.prepareTwoPagePopUp = function() {\n\n    this.twoPagePopUp = document.createElement('div');\n    this.twoPagePopUp.className = 'BRtwoPagePopUp';\n    $(this.twoPagePopUp).css({\n        zIndex: '1000'\n    }).appendTo(this.refs.$brContainer);\n    $(this.twoPagePopUp).hide();\n\n    $(this.leafEdgeL).add(this.leafEdgeR).bind('mouseenter', this, function(e) {\n        $(e.data.twoPagePopUp).show();\n    });\n\n    $(this.leafEdgeL).add(this.leafEdgeR).bind('mouseleave', this, function(e) {\n        $(e.data.twoPagePopUp).hide();\n    });\n\n    $(this.leafEdgeL).bind('click', this, function(e) {\n        e.data.trigger(BookReader.eventNames.stop);\n        var jumpIndex = e.data.jumpIndexForLeftEdgePageX(e.pageX);\n        e.data.jumpToIndex(jumpIndex);\n    });\n\n    $(this.leafEdgeR).bind('click', this, function(e) {\n        e.data.trigger(BookReader.eventNames.stop);\n        var jumpIndex = e.data.jumpIndexForRightEdgePageX(e.pageX);\n        e.data.jumpToIndex(jumpIndex);\n    });\n\n    $(this.leafEdgeR).bind('mousemove', this, function(e) {\n        var jumpIndex = e.data.jumpIndexForRightEdgePageX(e.pageX);\n        $(e.data.twoPagePopUp).text('View ' + e.data.getPageName(BookReader.util.clamp(jumpIndex, 0, e.data.getNumLeafs() - 1)));\n\n        // $$$ TODO: Make sure popup is positioned so that it is in view\n        // (https://bugs.edge.launchpad.net/gnubook/+bug/327456)\n        $(e.data.twoPagePopUp).css({\n            left: e.pageX- e.data.refs.$brContainer.offset().left + e.data.refs.$brContainer.scrollLeft() - 120 + 'px',\n            top: e.pageY - e.data.refs.$brContainer.offset().top + e.data.refs.$brContainer.scrollTop() + 'px'\n        });\n    });\n\n    $(this.leafEdgeL).bind('mousemove', this, function(e) {\n        var jumpIndex = e.data.jumpIndexForLeftEdgePageX(e.pageX);\n        $(e.data.twoPagePopUp).text('View '+ e.data.getPageName(BookReader.util.clamp(jumpIndex, 0, e.data.getNumLeafs() - 1)));\n\n        // $$$ TODO: Make sure popup is positioned so that it is in view\n        //           (https://bugs.edge.launchpad.net/gnubook/+bug/327456)\n        $(e.data.twoPagePopUp).css({\n            left: e.pageX - e.data.refs.$brContainer.offset().left + e.data.refs.$brContainer.scrollLeft() - $(e.data.twoPagePopUp).width() + 120 + 'px',\n            top: e.pageY-e.data.refs.$brContainer.offset().top + e.data.refs.$brContainer.scrollTop() + 'px'\n        });\n    });\n};\n\n/**\n * Calculates 2-page spread dimensions based on this.twoPage.currentIndexL and\n * this.twoPage.currentIndexR\n * This function sets this.twoPage.height, twoPage.width\n */\nBookReader.prototype.calculateSpreadSize = function() {\n\n    var firstIndex  = this.twoPage.currentIndexL;\n    var secondIndex = this.twoPage.currentIndexR;\n\n    // Calculate page sizes and total leaf width\n    var spreadSize;\n    if ( this.twoPage.autofit) {\n        spreadSize = this.getIdealSpreadSize(firstIndex, secondIndex);\n    } else {\n        // set based on reduction factor\n        spreadSize = this.getSpreadSizeFromReduce(firstIndex, secondIndex, this.reduce);\n    }\n\n    // Both pages together\n    this.twoPage.height = spreadSize.height;\n    this.twoPage.width = spreadSize.width;\n\n    // Individual pages\n    this.twoPage.scaledWL = this.getPageWidth2UP(firstIndex);\n    this.twoPage.scaledWR = this.getPageWidth2UP(secondIndex);\n\n    // Leaf edges\n    this.twoPage.edgeWidth = spreadSize.totalLeafEdgeWidth; // The combined width of both edges\n    this.twoPage.leafEdgeWidthL = this.leafEdgeWidth(this.twoPage.currentIndexL);\n    this.twoPage.leafEdgeWidthR = this.twoPage.edgeWidth - this.twoPage.leafEdgeWidthL;\n\n\n    // Book cover\n    // The width of the book cover div.  The combined width of both pages, twice the width\n    // of the book cover internal padding (2*10) and the page edges\n    this.twoPage.bookCoverDivWidth = this.twoPageCoverWidth(this.twoPage.scaledWL + this.twoPage.scaledWR);\n    // The height of the book cover div\n    this.twoPage.bookCoverDivHeight = this.twoPage.height + 2 * this.twoPage.coverInternalPadding;\n\n\n    // We calculate the total width and height for the div so that we can make the book\n    // spine centered\n    var leftGutterOffset = this.gutterOffsetForIndex(firstIndex);\n    var leftWidthFromCenter = this.twoPage.scaledWL - leftGutterOffset + this.twoPage.leafEdgeWidthL;\n    var rightWidthFromCenter = this.twoPage.scaledWR + leftGutterOffset + this.twoPage.leafEdgeWidthR;\n    var largestWidthFromCenter = Math.max( leftWidthFromCenter, rightWidthFromCenter );\n    this.twoPage.totalWidth = 2 * (largestWidthFromCenter + this.twoPage.coverInternalPadding + this.twoPage.coverExternalPadding);\n    this.twoPage.totalHeight = this.twoPage.height + 2 * (this.twoPage.coverInternalPadding + this.twoPage.coverExternalPadding);\n\n    // We want to minimize the unused space in two-up mode (maximize the amount of page\n    // shown).  We give width to the leaf edges and these widths change (though the sum\n    // of the two remains constant) as we flip through the book.  With the book\n    // cover centered and fixed in the BRcontainer div the page images will meet\n    // at the \"gutter\" which is generally offset from the center.\n    this.twoPage.middle = this.twoPage.totalWidth >> 1;\n    this.twoPage.gutter = this.twoPage.middle + this.gutterOffsetForIndex(firstIndex);\n\n    // The left edge of the book cover moves depending on the width of the pages\n    // $$$ change to getter\n    this.twoPage.bookCoverDivLeft = this.twoPage.gutter - this.twoPage.scaledWL - this.twoPage.leafEdgeWidthL - this.twoPage.coverInternalPadding;\n    // The top edge of the book cover stays a fixed distance from the top\n    this.twoPage.bookCoverDivTop = this.twoPage.coverExternalPadding;\n\n    // Book spine\n    this.twoPage.bookSpineDivHeight = this.twoPage.height + 2*this.twoPage.coverInternalPadding;\n    this.twoPage.bookSpineDivLeft = this.twoPage.middle - (this.twoPage.bookSpineDivWidth >> 1);\n    this.twoPage.bookSpineDivTop = this.twoPage.bookCoverDivTop;\n\n\n    this.reduce = spreadSize.reduce; // $$$ really set this here?\n};\n\nBookReader.prototype.getIdealSpreadSize = function(firstIndex, secondIndex) {\n    var ideal = {};\n\n    // We check which page is closest to a \"normal\" page and use that to set the height\n    // for both pages.  This means that foldouts and other odd size pages will be displayed\n    // smaller than the nominal zoom amount.\n    var canon5Dratio = 1.5;\n\n    var first = {\n        height: this._getPageHeight(firstIndex),\n        width: this._getPageWidth(firstIndex)\n    };\n\n    var second = {\n        height: this._getPageHeight(secondIndex),\n        width: this._getPageWidth(secondIndex)\n    };\n\n    var firstIndexRatio  = first.height / first.width;\n    var secondIndexRatio = second.height / second.width;\n\n    var ratio;\n    if (Math.abs(firstIndexRatio - canon5Dratio) < Math.abs(secondIndexRatio - canon5Dratio)) {\n        ratio = firstIndexRatio;\n    } else {\n        ratio = secondIndexRatio;\n    }\n\n    var totalLeafEdgeWidth = parseInt(this.getNumLeafs() * 0.1);\n    var maxLeafEdgeWidth   = parseInt(this.refs.$brContainer.prop('clientWidth') * 0.1);\n    ideal.totalLeafEdgeWidth     = Math.min(totalLeafEdgeWidth, maxLeafEdgeWidth);\n\n    var widthOutsidePages = 2 * (this.twoPage.coverInternalPadding + this.twoPage.coverExternalPadding) + ideal.totalLeafEdgeWidth;\n    var heightOutsidePages = 2* (this.twoPage.coverInternalPadding + this.twoPage.coverExternalPadding);\n\n    ideal.width = (this.refs.$brContainer.width() - widthOutsidePages) >> 1;\n    ideal.width -= 10; // $$$ fudge factor\n    ideal.height = this.refs.$brContainer.height() - heightOutsidePages;\n\n    ideal.height -= 15; // fudge factor\n\n    if (ideal.height/ratio <= ideal.width) {\n        //use height\n        ideal.width = parseInt(ideal.height/ratio);\n    } else {\n        //use width\n        ideal.height = parseInt(ideal.width*ratio);\n    }\n\n    // $$$ check this logic with large spreads\n    ideal.reduce = ((first.height + second.height) / 2) / ideal.height;\n\n    return ideal;\n};\n\n/**\n * Returns the spread size calculated from the reduction factor for the given pages\n * @param {number}\n * @param {number}\n * @return {Object}\n */\nBookReader.prototype.getSpreadSizeFromReduce = function(firstIndex, secondIndex, reduce) {\n    var spreadSize = {};\n    // $$$ Scale this based on reduce?\n    var totalLeafEdgeWidth = parseInt(this.getNumLeafs() * 0.1);\n    var maxLeafEdgeWidth   = parseInt(this.refs.$brContainer.prop('clientWidth') * 0.1); // $$$ Assumes leaf edge width constant at all zoom levels\n    spreadSize.totalLeafEdgeWidth     = Math.min(totalLeafEdgeWidth, maxLeafEdgeWidth);\n\n    // $$$ Possibly incorrect -- we should make height \"dominant\"\n    var nativeWidth = this._getPageWidth(firstIndex) + this._getPageWidth(secondIndex);\n    var nativeHeight = this._getPageHeight(firstIndex) + this._getPageHeight(secondIndex);\n    spreadSize.height = parseInt( (nativeHeight / 2) / this.reduce );\n    spreadSize.width = parseInt( (nativeWidth / 2) / this.reduce );\n    spreadSize.reduce = reduce;\n\n    return spreadSize;\n};\n\n/**\n * Returns the current ideal reduction factor\n * @return {number}\n */\nBookReader.prototype.twoPageGetAutofitReduce = function() {\n    var spreadSize = this.getIdealSpreadSize(this.twoPage.currentIndexL, this.twoPage.currentIndexR);\n    return spreadSize.reduce;\n};\n\n/**\n * Returns true if the pages extend past the edge of the view\n * slated for deprecation by v5.0.0\n * @return {boolean}\n */\nBookReader.prototype.twoPageIsZoomedIn = function() {\n    var isZoomedIn = false;\n    if (this.twoPage.autofit != 'auto') {\n        if (this.reduce < this.twoPageGetAutofitReduce()) {\n            isZoomedIn = true;\n        }\n    }\n    return isZoomedIn;\n};\n\nBookReader.prototype.onePageGetAutofitWidth = function() {\n    var widthPadding = 20;\n    return (this.getMedianPageSize().width + 0.0) / (this.refs.$brContainer.prop('clientWidth') - widthPadding * 2);\n};\n\nBookReader.prototype.onePageGetAutofitHeight = function() {\n    var availableHeight = this.refs.$brContainer.innerHeight();\n    return (this.getMedianPageSize().height + 0.0) / (availableHeight - this.padding * 2); // make sure a little of adjacent pages show\n};\n\n/**\n * Returns where the top of the page with given index should be in one page view\n * @param {number}\n * @return {number}\n */\nBookReader.prototype.onePageGetPageTop = function(index) {\n    var i;\n    var leafTop = 0;\n    var h;\n    for (i=0; i<index; i++) {\n        h = parseInt(this._getPageHeight(i)/this.reduce);\n        leafTop += h + this.padding;\n    }\n    return leafTop;\n};\n\nBookReader.prototype.getMedianPageSize = function() {\n    if (this._medianPageSize) {\n        return this._medianPageSize;\n    }\n\n    // A little expensive but we just do it once\n    var widths = [];\n    var heights = [];\n    for (var i = 0; i < this.getNumLeafs(); i++) {\n        widths.push(this.getPageWidth(i));\n        heights.push(this.getPageHeight(i));\n    }\n\n    widths.sort();\n    heights.sort();\n\n    this._medianPageSize = { width: widths[parseInt(widths.length / 2)], height: heights[parseInt(heights.length / 2)] };\n    return this._medianPageSize;\n};\n\n/**\n * Update the reduction factors for 1up mode given the available width and height.\n * Recalculates the autofit reduction factors.\n */\nBookReader.prototype.onePageCalculateReductionFactors = function() {\n    this.onePage.reductionFactors = this.reductionFactors.concat(\n        [\n            { reduce: this.onePageGetAutofitWidth(), autofit: 'width' },\n            { reduce: this.onePageGetAutofitHeight(), autofit: 'height'}\n        ]);\n    this.onePage.reductionFactors.sort(this._reduceSort);\n};\n\nBookReader.prototype.twoPageCalculateReductionFactors = function() {\n    this.twoPage.reductionFactors = this.reductionFactors.concat(\n        [\n            { reduce: this.getIdealSpreadSize( this.twoPage.currentIndexL, this.twoPage.currentIndexR ).reduce,\n              autofit: 'auto' }\n        ]);\n    this.twoPage.reductionFactors.sort(this._reduceSort);\n};\n\n/**\n * Set the cursor for two page view\n * @deprecated Since version 4.3.3. Will be deleted in version 5.0\n */\nBookReader.prototype.twoPageSetCursor = function() {\n    var $twoPageViewEl = this.refs.$brTwoPageView;\n    if ( ($twoPageViewEl.width() > this.refs.$brContainer.prop('clientWidth')) ||\n         ($twoPageViewEl.height() > this.refs.$brContainer.prop('clientHeight')) ) {\n        if (this.prefetchedImgs[this.twoPage.currentIndexL])\n          this.prefetchedImgs[this.twoPage.currentIndexL].style.cursor = 'move';\n        if (this.prefetchedImgs[this.twoPage.currentIndexR])\n          this.prefetchedImgs[this.twoPage.currentIndexR].style.cursor = 'move';\n    } else {\n      if (this.prefetchedImgs[this.twoPage.currentIndexL])\n        this.prefetchedImgs[this.twoPage.currentIndexL].style.cursor = '';\n      if (this.prefetchedImgs[this.twoPage.currentIndexR])\n        this.prefetchedImgs[this.twoPage.currentIndexR].style.cursor = '';\n    }\n};\n\n/**\n * Returns the currently active index\n * @return {number}\n * @throws\n */\nBookReader.prototype.currentIndex = function() {\n    // $$$ we should be cleaner with our idea of which index is active in 1up/2up\n    if (this.mode == this.constMode1up || this.mode == this.constModeThumb) {\n        return this.firstIndex; // $$$ TODO page in center of view would be better\n    } else if (this.mode == this.constMode2up) {\n        // Only allow indices that are actually present in book\n        return BookReader.util.clamp(this.firstIndex, 0, this.getNumLeafs() - 1);\n    } else {\n        throw 'currentIndex called for unimplemented mode ' + this.mode;\n    }\n};\n\n/**\n * Setter for this.firstIndex\n * Also triggers an event and updates the navbar slider position\n * @param {number}\n */\nBookReader.prototype.updateFirstIndex = function(index, options) {\n    this.firstIndex = index;\n    if (!options || options.suppressFragmentChange === false) {\n      this.trigger(BookReader.eventNames.fragmentChange);\n    }\n    this.updateNavIndexThrottled(index);\n};\n\n/**\n * Flip the right page over onto the left\n */\nBookReader.prototype.right = function() {\n    if ('rl' != this.pageProgression) {\n        this.next();\n    } else {\n        this.prev();\n    }\n};\n\n/**\n * Flip to the rightmost page\n */\nBookReader.prototype.rightmost = function() {\n    if ('rl' != this.pageProgression) {\n        this.last();\n    } else {\n        this.first();\n    }\n};\n\n/**\n * Flip the left page over onto the right\n */\nBookReader.prototype.left = function() {\n    if ('rl' != this.pageProgression) {\n        this.prev();\n    } else {\n        this.next();\n    }\n};\n\n/**\n * Flip to the leftmost page\n */\nBookReader.prototype.leftmost = function() {\n    if ('rl' != this.pageProgression) {\n        this.first();\n    } else {\n        this.last();\n    }\n};\n\nBookReader.prototype.next = function() {\n    if (this.constMode2up == this.mode) {\n        this.trigger(BookReader.eventNames.stop);\n        this.flipFwdToIndex(null);\n    } else {\n        if (this.firstIndex < this.lastDisplayableIndex()) {\n            this.jumpToIndex(this.firstIndex + 1);\n        }\n    }\n};\n\nBookReader.prototype.prev = function() {\n    if (this.constMode2up == this.mode) {\n        this.trigger(BookReader.eventNames.stop);\n        this.flipBackToIndex(null);\n    } else {\n        if (this.firstIndex >= 1) {\n            this.jumpToIndex(this.firstIndex - 1);\n        }\n    }\n};\n\nBookReader.prototype.first = function() {\n    this.jumpToIndex(this.firstDisplayableIndex());\n};\n\nBookReader.prototype.last = function() {\n    this.jumpToIndex(this.lastDisplayableIndex());\n};\n\n/**\n * Scrolls down one screen view\n */\nBookReader.prototype.scrollDown = function() {\n    if ($.inArray(this.mode, [this.constMode1up, this.constModeThumb]) >= 0) {\n        if ( this.mode == this.constMode1up && (this.reduce >= this.onePageGetAutofitHeight()) ) {\n            // Whole pages are visible, scroll whole page only\n            return this.next();\n        }\n\n        this.refs.$brContainer.stop(true).animate(\n            { scrollTop: '+=' + this._scrollAmount() + 'px'},\n            400, 'easeInOutExpo'\n        );\n        return true;\n    } else {\n        return false;\n    }\n};\n\n/**\n * Scrolls up one screen view\n */\nBookReader.prototype.scrollUp = function() {\n    if ($.inArray(this.mode, [this.constMode1up, this.constModeThumb]) >= 0) {\n        if ( this.mode == this.constMode1up && (this.reduce >= this.onePageGetAutofitHeight()) ) {\n            // Whole pages are visible, scroll whole page only\n            return this.prev();\n        }\n\n        this.refs.$brContainer.stop(true).animate(\n            { scrollTop: '-=' + this._scrollAmount() + 'px'},\n            400, 'easeInOutExpo'\n        );\n        return true;\n    } else {\n        return false;\n    }\n};\n\n/**\n * The amount to scroll vertically in integer pixels\n */\nBookReader.prototype._scrollAmount = function() {\n    if (this.constMode1up == this.mode) {\n        // Overlap by % of page size\n        return parseInt(this.refs.$brContainer.prop('clientHeight') - this.getPageHeight(this.currentIndex()) / this.reduce * 0.03);\n    }\n\n    return parseInt(0.9 * this.refs.$brContainer.prop('clientHeight'));\n};\n\n/**\n * @param {Number|null} index to flip back one spread, pass index=null\n */\nBookReader.prototype.flipBackToIndex = function(index) {\n    if (this.constMode1up == this.mode) return;\n\n    var leftIndex = this.twoPage.currentIndexL;\n\n    if (this.animating) return;\n\n    if (null != this.leafEdgeTmp) {\n        alert('error: leafEdgeTmp should be null!');\n        return;\n    }\n\n    if (null == index) {\n        index = leftIndex - 2;\n    }\n\n    this.updateNavIndexThrottled(index);\n\n    var previousIndices = this.getSpreadIndices(index);\n\n    if (previousIndices[0] < this.firstDisplayableIndex() || previousIndices[1] < this.firstDisplayableIndex()) {\n        return;\n    }\n\n    this.animating = true;\n\n    if ('rl' != this.pageProgression) {\n        // Assume LTR and we are going backward\n        this.prepareFlipLeftToRight(previousIndices[0], previousIndices[1]);\n        this.flipLeftToRight(previousIndices[0], previousIndices[1]);\n    } else {\n        // RTL and going backward\n        var gutter = this.prepareFlipRightToLeft(previousIndices[0], previousIndices[1]);\n        this.flipRightToLeft(previousIndices[0], previousIndices[1], gutter);\n    }\n};\n\n/**\n * Flips the page on the left towards the page on the right\n * @param {number}\n * @param {number}\n */\nBookReader.prototype.flipLeftToRight = function(newIndexL, newIndexR) {\n    var leftLeaf = this.twoPage.currentIndexL;\n\n    var oldLeafEdgeWidthL = this.leafEdgeWidth(this.twoPage.currentIndexL);\n    var newLeafEdgeWidthL = this.leafEdgeWidth(newIndexL);\n    var leafEdgeTmpW = oldLeafEdgeWidthL - newLeafEdgeWidthL;\n\n    var currWidthL   = this.getPageWidth2UP(leftLeaf);\n    var newWidthL    = this.getPageWidth2UP(newIndexL);\n    var newWidthR    = this.getPageWidth2UP(newIndexR);\n\n    var top  = this.twoPageTop();\n    var gutter = this.twoPage.middle + this.gutterOffsetForIndex(newIndexL);\n\n    //animation strategy:\n    // 0. remove search highlight, if any.\n    // 1. create a new div, called leafEdgeTmp to represent the leaf edge between the leftmost edge\n    //    of the left leaf and where the user clicked in the leaf edge.\n    //    Note that if this function was triggered by left() and not a\n    //    mouse click, the width of leafEdgeTmp is very small (zero px).\n    // 2. animate both leafEdgeTmp to the gutter (without changing its width) and animate\n    //    leftLeaf to width=0.\n    // 3. When step 2 is finished, animate leafEdgeTmp to right-hand side of new right leaf\n    //    (left=gutter+newWidthR) while also animating the new right leaf from width=0 to\n    //    its new full width.\n    // 4. After step 3 is finished, do the following:\n    //      - remove leafEdgeTmp from the dom.\n    //      - resize and move the right leaf edge (leafEdgeR) to left=gutter+newWidthR\n    //          and width=twoPage.edgeWidth-newLeafEdgeWidthL.\n    //      - resize and move the left leaf edge (leafEdgeL) to left=gutter-newWidthL-newLeafEdgeWidthL\n    //          and width=newLeafEdgeWidthL.\n    //      - resize the back cover (twoPage.coverDiv) to left=gutter-newWidthL-newLeafEdgeWidthL-10\n    //          and width=newWidthL+newWidthR+twoPage.edgeWidth+20\n    //      - move new left leaf (newIndexL) forward to zindex=2 so it can receive clicks.\n    //      - remove old left and right leafs from the dom [pruneUnusedImgs()].\n    //      - prefetch new adjacent leafs.\n    //      - set up click handlers for both new left and right leafs.\n    //      - redraw the search highlight.\n    //      - update the pagenum box and the url.\n\n    var $twoPageViewEl = this.refs.$brTwoPageView;\n    var leftEdgeTmpLeft = gutter - currWidthL - leafEdgeTmpW;\n\n    this.leafEdgeTmp = document.createElement('div');\n    this.leafEdgeTmp.className = 'BRleafEdgeTmp';\n    $(this.leafEdgeTmp).css({\n        width: leafEdgeTmpW + 'px',\n        height: this.twoPage.height + 'px',\n        left: leftEdgeTmpLeft + 'px',\n        top: top+'px',\n        zIndex:1000\n    }).appendTo($twoPageViewEl);\n\n    $(this.leafEdgeL).css({\n        width: newLeafEdgeWidthL+'px',\n        left: gutter-currWidthL-newLeafEdgeWidthL+'px'\n    });\n\n    // Left gets the offset of the current left leaf from the document\n    var left = $(this.prefetchedImgs[leftLeaf]).offset().left;\n    // $$$ This seems very similar to the gutter.  May be able to consolidate the logic.\n    var right = $twoPageViewEl.prop('clientWidth') - left - $(this.prefetchedImgs[leftLeaf]).width() + $twoPageViewEl.offset().left - 2 + 'px';\n\n    // We change the left leaf to right positioning\n    // $$$ This causes animation glitches during resize.  See https://bugs.edge.launchpad.net/gnubook/+bug/328327\n    $(this.prefetchedImgs[leftLeaf]).css({\n        right: right,\n        left: ''\n    });\n\n    $(this.leafEdgeTmp).animate({left: gutter}, this.flipSpeed, 'easeInSine');\n\n    var self = this;\n\n    if (this.enableSearch) this.removeSearchHilites();\n\n    $(this.prefetchedImgs[leftLeaf]).animate({width: '0px'}, self.flipSpeed, 'easeInSine', function() {\n\n        $(self.leafEdgeTmp).animate({left: gutter+newWidthR+'px'}, self.flipSpeed, 'easeOutSine');\n\n        self.$('.BRgutter').css({left: (gutter - self.twoPage.bookSpineDivWidth*0.5)+'px'});\n\n        $(self.prefetchedImgs[newIndexR]).animate({width: newWidthR+'px'}, self.flipSpeed, 'easeOutSine', function() {\n            $(self.prefetchedImgs[newIndexL]).css('zIndex', 2);\n\n            //jquery adds display:block to the element style, which interferes with our print css\n            $(self.prefetchedImgs[newIndexL]).css('display', '');\n            $(self.prefetchedImgs[newIndexR]).css('display', '');\n\n            $(self.leafEdgeR).css({\n                // Moves the right leaf edge\n                width: self.twoPage.edgeWidth-newLeafEdgeWidthL+'px',\n                left:  gutter+newWidthR+'px'\n            });\n\n            $(self.leafEdgeL).css({\n                // Moves and resizes the left leaf edge\n                width: newLeafEdgeWidthL+'px',\n                left:  gutter-newWidthL-newLeafEdgeWidthL+'px'\n            });\n\n            // Resizes the brown border div\n            $(self.twoPage.coverDiv).css({\n                width: self.twoPageCoverWidth(newWidthL+newWidthR)+'px',\n                left: gutter-newWidthL-newLeafEdgeWidthL-self.twoPage.coverInternalPadding+'px'\n            });\n\n            $(self.leafEdgeTmp).remove();\n            self.leafEdgeTmp = null;\n\n            // $$$ TODO refactor with opposite direction flip\n\n            self.twoPage.currentIndexL = newIndexL;\n            self.twoPage.currentIndexR = newIndexR;\n            self.twoPage.scaledWL = newWidthL;\n            self.twoPage.scaledWR = newWidthR;\n            self.twoPage.gutter = gutter;\n\n            self.updateFirstIndex(self.twoPage.currentIndexL);\n            self.displayedIndices = [newIndexL, newIndexR];\n            self.pruneUnusedImgs();\n            self.prefetch();\n            self.animating = false;\n\n            if (self.enableSearch) self.updateSearchHilites2UP();\n\n            self.setMouseHandlers2UP();\n\n            if (self.animationFinishedCallback) {\n                self.animationFinishedCallback();\n                self.animationFinishedCallback = null;\n            }\n        });\n    });\n\n};\n\n/**\n * Whether we flip left or right is dependent on the page progression\n * to flip forward one spread, pass index=null\n * @param {number}\n */\nBookReader.prototype.flipFwdToIndex = function(index) {\n    if (this.animating) return;\n\n    if (null != this.leafEdgeTmp) {\n        alert('error: leafEdgeTmp should be null!');\n        return;\n    }\n\n    if (null == index) {\n        index = this.twoPage.currentIndexL + 2; // $$$ assumes indices are continuous\n    }\n    if (index > this.lastDisplayableIndex()) return;\n\n    this.updateNavIndexThrottled(index);\n\n    this.animating = true;\n\n    var nextIndices = this.getSpreadIndices(index);\n    var gutter;\n\n    if ('rl' != this.pageProgression) {\n        // We did not specify RTL\n        gutter = this.prepareFlipRightToLeft(nextIndices[0], nextIndices[1]);\n        this.flipRightToLeft(nextIndices[0], nextIndices[1], gutter);\n    } else {\n        // RTL\n        gutter = this.prepareFlipLeftToRight(nextIndices[0], nextIndices[1]);\n        this.flipLeftToRight(nextIndices[0], nextIndices[1]);\n    }\n};\n\n/**\n * Flip from left to right and show the nextL and nextR indices on those sides\n * $$$ better not to have to pass gutter in\n * @param {number}\n * @param {number}\n */\nBookReader.prototype.flipRightToLeft = function(newIndexL, newIndexR) {\n    var oldLeafEdgeWidthL = this.leafEdgeWidth(this.twoPage.currentIndexL);\n    var oldLeafEdgeWidthR = this.twoPage.edgeWidth-oldLeafEdgeWidthL;\n    var newLeafEdgeWidthL = this.leafEdgeWidth(newIndexL);\n    var newLeafEdgeWidthR = this.twoPage.edgeWidth-newLeafEdgeWidthL;\n\n    var leafEdgeTmpW = oldLeafEdgeWidthR - newLeafEdgeWidthR;\n\n    var top = this.twoPageTop();\n    var scaledW = this.getPageWidth2UP(this.twoPage.currentIndexR);\n\n    var middle = this.twoPage.middle;\n    var gutter = middle + this.gutterOffsetForIndex(newIndexL);\n\n    var $twoPageViewEl = this.refs.$brTwoPageView;\n\n    this.leafEdgeTmp = document.createElement('div');\n    this.leafEdgeTmp.className = 'BRleafEdgeTmp';\n    $(this.leafEdgeTmp).css({\n        width: leafEdgeTmpW + 'px',\n        height: this.twoPage.height + 'px',\n        left: gutter+scaledW+'px',\n        top: top+'px',\n        zIndex:1000\n    }).appendTo($twoPageViewEl);\n\n    var newWidthL = this.getPageWidth2UP(newIndexL);\n    var newWidthR = this.getPageWidth2UP(newIndexR);\n\n    $(this.leafEdgeR).css({width: newLeafEdgeWidthR+'px', left: gutter+newWidthR+'px' });\n\n    var self = this;\n\n    var speed = this.flipSpeed;\n\n    if (this.enableSearch) this.removeSearchHilites();\n\n    $(this.leafEdgeTmp).animate({left: gutter}, speed, 'easeInSine');\n    $(this.prefetchedImgs[this.twoPage.currentIndexR]).animate({width: '0px'}, speed, 'easeInSine', function() {\n        self.$('BRgutter').css({left: (gutter - self.twoPage.bookSpineDivWidth*0.5)+'px'});\n        $(self.leafEdgeTmp).animate({left: gutter-newWidthL-leafEdgeTmpW+'px'}, speed, 'easeOutSine');\n        $(self.prefetchedImgs[newIndexL]).animate({width: newWidthL+'px'}, speed, 'easeOutSine', function() {\n            $(self.prefetchedImgs[newIndexR]).css('zIndex', 2);\n\n            //jquery adds display:block to the element style, which interferes with our print css\n            $(self.prefetchedImgs[newIndexL]).css('display', '');\n            $(self.prefetchedImgs[newIndexR]).css('display', '');\n\n            $(self.leafEdgeL).css({\n                width: newLeafEdgeWidthL+'px',\n                left: gutter-newWidthL-newLeafEdgeWidthL+'px'\n            });\n\n            // Resizes the book cover\n            $(self.twoPage.coverDiv).css({\n                width: self.twoPageCoverWidth(newWidthL+newWidthR)+'px',\n                left: gutter - newWidthL - newLeafEdgeWidthL - self.twoPage.coverInternalPadding + 'px'\n            });\n\n            $(self.leafEdgeTmp).remove();\n            self.leafEdgeTmp = null;\n\n            self.twoPage.currentIndexL = newIndexL;\n            self.twoPage.currentIndexR = newIndexR;\n            self.twoPage.scaledWL = newWidthL;\n            self.twoPage.scaledWR = newWidthR;\n            self.twoPage.gutter = gutter;\n\n            self.updateFirstIndex(self.twoPage.currentIndexL);\n            self.displayedIndices = [newIndexL, newIndexR];\n            self.pruneUnusedImgs();\n            self.prefetch();\n            self.animating = false;\n\n\n            if (self.enableSearch) self.updateSearchHilites2UP();\n\n            self.setMouseHandlers2UP();\n\n            if (self.animationFinishedCallback) {\n                self.animationFinishedCallback();\n                self.animationFinishedCallback = null;\n            }\n        });\n    });\n};\n\nBookReader.prototype.setMouseHandlers2UP = function() {\n    var self = this;\n    var handler = function(element, e) {\n        if (e.which == 3) {\n            // right click\n            return !e.data.self.protected;\n        }\n\n        // Changes per WEBDEV-2737\n        // BookReader: zoomed-in 2 page view, clicking page should change the page\n        $(element)\n        .mousemove(function() {\n            e.preventDefault();\n        })\n        .mouseup(function() {\n            e.data.self.trigger(BookReader.eventNames.stop);\n            e.data.self[e.data.direction === 'L' ? 'left' : 'right']();\n        });\n    }\n\n    this.setClickHandler2UP(\n        this.prefetchedImgs[self.twoPage['currentIndexR']],\n        { self: self, direction: 'R' },\n        handler\n    );\n    this.setClickHandler2UP(\n        this.prefetchedImgs[self.twoPage['currentIndexL']],\n        { self: self, direction: 'L' },\n        handler\n    );\n};\n\nBookReader.prototype.prefetchImg = function(index) {\n    var pageURI = this._getPageURI(index);\n\n    // Load image if not loaded or URI has changed (e.g. due to scaling)\n    var loadImage = false;\n    if (undefined == this.prefetchedImgs[index]) {\n        loadImage = true;\n    } else if (pageURI != this.prefetchedImgs[index].uri) {\n        loadImage = true;\n    }\n\n    if (loadImage) {\n        var img = document.createElement(\"img\");\n        $(img).addClass('BRpageimage').addClass('BRnoselect');\n        if (index < 0 || index > (this.getNumLeafs() - 1) ) {\n            // Facing page at beginning or end, or beyond\n            $(img).addClass('BRemptypage');\n        }\n        img.src = pageURI;\n        img.uri = pageURI; // browser may rewrite src so we stash raw URI here\n        this.prefetchedImgs[index] = img;\n    }\n};\n\n/**\n * Prepare to flip the left page towards the right.  This corresponds to moving\n * backward when the page progression is left to right.\n * @param {number}\n * @param {number}\n */\nBookReader.prototype.prepareFlipLeftToRight = function(prevL, prevR) {\n    this.prefetchImg(prevL);\n    this.prefetchImg(prevR);\n\n    var height  = this._getPageHeight(prevL);\n    var width   = this._getPageWidth(prevL);\n    var middle = this.twoPage.middle;\n    var top  = this.twoPageTop();\n    var scaledW = this.twoPage.height*width/height; // $$$ assumes height of page is dominant\n\n    // The gutter is the dividing line between the left and right pages.\n    // It is offset from the middle to create the illusion of thickness to the pages\n    var gutter = middle + this.gutterOffsetForIndex(prevL);\n\n    var leftCSS = {\n        position: 'absolute',\n        left: gutter-scaledW+'px',\n        right: '', // clear right property\n        top:    top+'px',\n        height: this.twoPage.height,\n        width:  scaledW+'px',\n        zIndex: 1\n    };\n\n    $(this.prefetchedImgs[prevL]).css(leftCSS);\n\n    var $twoPageViewEl = this.refs.$brTwoPageView;\n    $twoPageViewEl.append(this.prefetchedImgs[prevL]);\n\n    var rightCSS = {\n        position: 'absolute',\n        left:   gutter+'px',\n        right: '',\n        top:    top+'px',\n        height: this.twoPage.height,\n        width:  '0',\n        zIndex: 2\n    };\n\n    $(this.prefetchedImgs[prevR]).css(rightCSS);\n\n    $twoPageViewEl.append(this.prefetchedImgs[prevR]);\n};\n\n// $$$ mang we're adding an extra pixel in the middle.  See https://bugs.edge.launchpad.net/gnubook/+bug/411667\nBookReader.prototype.prepareFlipRightToLeft = function(nextL, nextR) {\n    // Prefetch images\n    this.prefetchImg(nextL);\n    this.prefetchImg(nextR);\n\n    var height  = this._getPageHeight(nextR);\n    var width   = this._getPageWidth(nextR);\n    var middle = this.twoPage.middle;\n    var top  = this.twoPageTop();\n    var scaledW = this.twoPage.height*width/height;\n\n    var gutter = middle + this.gutterOffsetForIndex(nextL);\n\n    $(this.prefetchedImgs[nextR]).css({\n        position: 'absolute',\n        left:   gutter+'px',\n        top:    top+'px',\n        height: this.twoPage.height,\n        width:  scaledW+'px',\n        zIndex: 1\n    });\n\n    var $twoPageViewEl = this.refs.$brTwoPageView;\n    $twoPageViewEl.append(this.prefetchedImgs[nextR]);\n\n    height  = this._getPageHeight(nextL);\n    width   = this._getPageWidth(nextL);\n    scaledW = this.twoPage.height*width/height;\n\n    $(this.prefetchedImgs[nextL]).css({\n        position: 'absolute',\n        right:   $twoPageViewEl.prop('clientWidth')-gutter+'px',\n        top:    top+'px',\n        height: this.twoPage.height,\n        width:  0+'px', // Start at 0 width, then grow to the left\n        zIndex: 2\n    });\n\n    $twoPageViewEl.append(this.prefetchedImgs[nextL]);\n};\n\nBookReader.prototype.pruneUnusedImgs = function() {\n    for (var key in this.prefetchedImgs) {\n        if ((key != this.twoPage.currentIndexL) && (key != this.twoPage.currentIndexR)) {\n            $(this.prefetchedImgs[key]).remove();\n        }\n        if ((key < this.twoPage.currentIndexL-4) || (key > this.twoPage.currentIndexR+4)) {\n            delete this.prefetchedImgs[key];\n        }\n    }\n};\n\nBookReader.prototype.prefetch = function() {\n    // $$$ We should check here if the current indices have finished\n    //     loading (with some timeout) before loading more page images\n    //     See https://bugs.edge.launchpad.net/bookreader/+bug/511391\n\n    // prefetch visible pages first\n    this.prefetchImg(this.twoPage.currentIndexL);\n    this.prefetchImg(this.twoPage.currentIndexR);\n\n    var adjacentPagesToLoad = 3;\n\n    var lowCurrent = Math.min(this.twoPage.currentIndexL, this.twoPage.currentIndexR);\n    var highCurrent = Math.max(this.twoPage.currentIndexL, this.twoPage.currentIndexR);\n\n    var start = Math.max(lowCurrent - adjacentPagesToLoad, 0);\n    var end = Math.min(highCurrent + adjacentPagesToLoad, this.getNumLeafs() - 1);\n\n    // Load images spreading out from current\n    for (var i = 1; i <= adjacentPagesToLoad; i++) {\n        var goingDown = lowCurrent - i;\n        if (goingDown >= start) {\n            this.prefetchImg(goingDown);\n        }\n        var goingUp = highCurrent + i;\n        if (goingUp <= end) {\n            this.prefetchImg(goingUp);\n        }\n    }\n};\n\nBookReader.prototype.getPageWidth2UP = function(index) {\n    // We return the width based on the dominant height\n    var height  = this._getPageHeight(index);\n    var width   = this._getPageWidth(index);\n    return Math.floor(this.twoPage.height*width/height); // $$$ we assume width is relative to current spread\n};\n\n/**\n * Returns the position of the gutter (line between the page images)\n */\nBookReader.prototype.twoPageGutter = function() {\n    return this.twoPage.middle + this.gutterOffsetForIndex(this.twoPage.currentIndexL);\n};\n\n/**\n * Returns the offset for the top of the page images\n */\nBookReader.prototype.twoPageTop = function() {\n    return this.twoPage.coverExternalPadding + this.twoPage.coverInternalPadding; // $$$ + border?\n};\n\n/**\n * Returns the width of the cover div given the total page width\n * @param {number}\n * @return {number}\n */\nBookReader.prototype.twoPageCoverWidth = function(totalPageWidth) {\n    return totalPageWidth + this.twoPage.edgeWidth + 2*this.twoPage.coverInternalPadding;\n};\n\n/**\n * Returns the percentage offset into twopageview div at the center of container div\n * { percentageX: float, percentageY: float }\n */\nBookReader.prototype.twoPageGetViewCenter = function() {\n    var center = {};\n\n    var containerOffset = this.refs.$brContainer.offset();\n    var viewOffset = this.refs.$brTwoPageView.offset();\n    center.percentageX = (containerOffset.left - viewOffset.left + (this.refs.$brContainer.prop('clientWidth') >> 1)) / this.twoPage.totalWidth;\n    center.percentageY = (containerOffset.top - viewOffset.top + (this.refs.$brContainer.prop('clientHeight') >> 1)) / this.twoPage.totalHeight;\n\n    return center;\n};\n\n/**\n * Centers the point given by percentage from left,top of twopageview\n * @param {number}\n * @param {number}\n */\nBookReader.prototype.twoPageCenterView = function(percentageX, percentageY) {\n    if ('undefined' == typeof(percentageX)) {\n        percentageX = 0.5;\n    }\n    if ('undefined' == typeof(percentageY)) {\n        percentageY = 0.5;\n    }\n\n    var viewWidth = this.refs.$brTwoPageView.width();\n    var containerClientWidth = this.refs.$brContainer.prop('clientWidth');\n    var intoViewX = percentageX * viewWidth;\n\n    var viewHeight = this.refs.$brTwoPageView.height();\n    var containerClientHeight = this.refs.$brContainer.prop('clientHeight');\n    var intoViewY = percentageY * viewHeight;\n\n    if (viewWidth < containerClientWidth) {\n        // Can fit width without scrollbars - center by adjusting offset\n        this.refs.$brTwoPageView.css('left', (containerClientWidth >> 1) - intoViewX + 'px');\n    } else {\n        // Need to scroll to center\n        this.refs.$brTwoPageView.css('left', 0);\n        this.refs.$brContainer.scrollLeft(intoViewX - (containerClientWidth >> 1));\n    }\n\n    if (viewHeight < containerClientHeight) {\n        // Fits with scrollbars - add offset\n        this.refs.$brTwoPageView.css('top', (containerClientHeight >> 1) - intoViewY + 'px');\n    } else {\n        this.refs.$brTwoPageView.css('top', 0);\n        this.refs.$brContainer.scrollTop(intoViewY - (containerClientHeight >> 1));\n    }\n};\n\n/**\n * Returns the integer height of the click-to-flip areas at the edges of the book\n * @return {number}\n */\nBookReader.prototype.twoPageFlipAreaHeight = function() {\n    return parseInt(this.twoPage.height);\n};\n\n/**\n * Returns the the integer width of the flip areas\n * @return {number}\n */\nBookReader.prototype.twoPageFlipAreaWidth = function() {\n    var max = 100; // $$$ TODO base on view width?\n    var min = 10;\n\n    var width = this.twoPage.width * 0.15;\n    return parseInt(BookReader.util.clamp(width, min, max));\n};\n\n/**\n * Returns integer top offset for flip areas\n * @return {number}\n */\nBookReader.prototype.twoPageFlipAreaTop = function() {\n    return parseInt(this.twoPage.bookCoverDivTop + this.twoPage.coverInternalPadding);\n};\n\n/**\n * Left offset for left flip area\n * @return {number}\n */\nBookReader.prototype.twoPageLeftFlipAreaLeft = function() {\n    return parseInt(this.twoPage.gutter - this.twoPage.scaledWL);\n};\n\n/**\n * Left offset for right flip area\n * @return {number}\n */\nBookReader.prototype.twoPageRightFlipAreaLeft = function() {\n    return parseInt(this.twoPage.gutter + this.twoPage.scaledWR - this.twoPageFlipAreaWidth());\n};\n\n/**\n * Position calculation shared between search and text-to-speech functions\n */\nBookReader.prototype.setHilightCss2UP = function(div, index, left, right, top, bottom) {\n    // We calculate the reduction factor for the specific page because it can be different\n    // for each page in the spread\n    var height = this._getPageHeight(index);\n    var width  = this._getPageWidth(index);\n    var reduce = this.twoPage.height/height;\n    var scaledW = parseInt(width*reduce);\n\n    var gutter = this.twoPageGutter();\n    var pageL;\n    if ('L' == this.getPageSide(index)) {\n        pageL = gutter-scaledW;\n    } else {\n        pageL = gutter;\n    }\n    var pageT  = this.twoPageTop();\n\n    $(div).css({\n        width:  (right-left)*reduce + 'px',\n        height: (bottom-top)*reduce + 'px',\n        left:   pageL+left*reduce + 'px',\n        top:    pageT+top*reduce +'px'\n    });\n};\n\n/**\n * Immediately stop flip animations.  Callbacks are triggered.\n */\nBookReader.prototype.stopFlipAnimations = function() {\n    this.trigger(BookReader.eventNames.stop);\n\n    // Stop animation, clear queue, trigger callbacks\n    if (this.leafEdgeTmp) {\n        $(this.leafEdgeTmp).stop(false, true);\n    }\n    jQuery.each(this.prefetchedImgs, function() {\n        $(this).stop(false, true);\n    });\n\n    // And again since animations also queued in callbacks\n    if (this.leafEdgeTmp) {\n        $(this.leafEdgeTmp).stop(false, true);\n    }\n    jQuery.each(this.prefetchedImgs, function() {\n        $(this).stop(false, true);\n    });\n};\n\n/**\n * Returns true if keyboard navigation should be disabled for the event\n * @param {Event}\n * @return {boolean}\n */\nBookReader.prototype.keyboardNavigationIsDisabled = function(event) {\n    return event.target.tagName == \"INPUT\";\n};\n\n/**\n * Returns the gutter offset for the spread containing the given index.\n * This function supports RTL\n * @param {number}\n * @return {number}\n */\nBookReader.prototype.gutterOffsetForIndex = function(pindex) {\n    // To find the offset of the gutter from the middle we calculate our percentage distance\n    // through the book (0..1), remap to (-0.5..0.5) and multiply by the total page edge width\n    var offset = parseInt(((pindex / this.getNumLeafs()) - 0.5) * this.twoPage.edgeWidth);\n\n    // But then again for RTL it's the opposite\n    if ('rl' == this.pageProgression) {\n        offset = -offset;\n    }\n\n    return offset;\n};\n\n/**\n * Returns the width of the leaf edge div for the page with index given\n * @param {number}\n * @return {number}\n */\nBookReader.prototype.leafEdgeWidth = function(pindex) {\n    // $$$ could there be single pixel rounding errors for L vs R?\n    if ((this.getPageSide(pindex) == 'L') && (this.pageProgression != 'rl')) {\n        return parseInt( (pindex/this.getNumLeafs()) * this.twoPage.edgeWidth + 0.5);\n    } else {\n        return parseInt( (1 - pindex/this.getNumLeafs()) * this.twoPage.edgeWidth + 0.5);\n    }\n};\n\n/**\n * Returns the target jump leaf given a page coordinate (inside the left page edge div)\n * @param {number}\n * @return {number}\n */\nBookReader.prototype.jumpIndexForLeftEdgePageX = function(pageX) {\n    var jumpIndex;\n    if ('rl' != this.pageProgression) {\n        // LTR - flipping backward\n        jumpIndex = this.twoPage.currentIndexL - ($(this.leafEdgeL).offset().left + $(this.leafEdgeL).width() - pageX) * 10;\n\n        // browser may have resized the div due to font size change -- see https://bugs.launchpad.net/gnubook/+bug/333570\n        jumpIndex = BookReader.util.clamp(Math.round(jumpIndex), this.firstDisplayableIndex(), this.twoPage.currentIndexL - 2);\n        return jumpIndex;\n\n    } else {\n        jumpIndex = this.twoPage.currentIndexL + ($(this.leafEdgeL).offset().left + $(this.leafEdgeL).width() - pageX) * 10;\n        jumpIndex = BookReader.util.clamp(Math.round(jumpIndex), this.twoPage.currentIndexL + 2, this.lastDisplayableIndex());\n        return jumpIndex;\n    }\n};\n\n/**\n * Returns the target jump leaf given a page coordinate (inside the right page edge div)\n */\nBookReader.prototype.jumpIndexForRightEdgePageX = function(pageX) {\n    var jumpIndex;\n    if ('rl' != this.pageProgression) {\n        // LTR\n        jumpIndex = this.twoPage.currentIndexL + (pageX - $(this.leafEdgeR).offset().left) * 10;\n        jumpIndex = BookReader.util.clamp(Math.round(jumpIndex), this.twoPage.currentIndexL + 2, this.lastDisplayableIndex());\n        return jumpIndex;\n    } else {\n        jumpIndex = this.twoPage.currentIndexL - (pageX - $(this.leafEdgeR).offset().left) * 10;\n        jumpIndex = BookReader.util.clamp(Math.round(jumpIndex), this.firstDisplayableIndex(), this.twoPage.currentIndexL - 2);\n        return jumpIndex;\n    }\n};\n\n/**\n * Initialize the navigation bar (bottom)\n */\nBookReader.prototype.initNavbar = function() {\n    // Setup nav / chapter / search results bar\n    var navbarTitleHtml = '';\n    if (this.options.navbarTitle) {\n        navbarTitleHtml = \"<div class=\\\"BRnavTitle\\\">\" + this.options.navbarTitle + \"</div>\";\n    }\n\n    this.refs.$BRfooter = $('<div class=\"BRfooter\"></div>');\n    this.refs.$BRnav = $(\n        \"<div class=\\\"BRnav BRnavDesktop\\\">\"\n        +\"  <div class=\\\"BRnavCntl BRnavCntlBtm BRdn js-tooltip\\\" title=\\\"Toogle toolbars\\\"></div>\"\n        + navbarTitleHtml\n        +\"  <div class=\\\"BRnavpos\\\">\"\n        +\"    <div class=\\\"BRpager\\\"></div>\"\n        +\"    <div class=\\\"BRnavline\\\">\"\n        +\"    </div>\"\n        +\"  </div>\"\n        +\"  <div class=\\\"BRpage\\\">\"\n\n        // Note, it's important for there to not be whitespace\n        +     \"<span class='BRcurrentpage'></span>\"\n        +     \"<button class=\\\"BRicon book_left js-tooltip\\\"></button>\"\n        +     \"<button class=\\\"BRicon book_right js-tooltip\\\"></button>\"\n        +     \"<button class=\\\"BRicon onepg desktop-only js-tooltip\\\"></button>\"\n        +     \"<button class=\\\"BRicon twopg desktop-only js-tooltip\\\"></button>\"\n        +     \"<button class=\\\"BRicon thumb desktop-only js-tooltip\\\"></button>\"\n\n        // zoomx\n        +     \"<button class='BRicon zoom_out desktop-only js-tooltip'></button>\"\n        +     \"<button class='BRicon zoom_in desktop-only js-tooltip'></button>\"\n        +     \"<button class='BRicon full js-tooltip'></button>\"\n        +\"  </div>\"\n        +\"</div>\"\n    );\n    this.refs.$BRfooter.append(this.refs.$BRnav);\n    this.refs.$br.append(this.refs.$BRfooter);\n\n    var self = this;\n    this.$('.BRpager').slider({\n        animate: true,\n        min: 0,\n        max: this.getNumLeafs() - 1,\n        value: this.currentIndex(),\n        range: \"min\"\n    })\n    .bind('slide', function(event, ui) {\n        self.updateNavPageNum(ui.value);\n        return true;\n    })\n    .bind('slidechange', function(event, ui) {\n        self.updateNavPageNum(ui.value);\n        // recursion prevention for jumpToIndex\n        if ( $(this).data('swallowchange') ) {\n            $(this).data('swallowchange', false);\n        } else {\n            self.jumpToIndex(ui.value);\n        }\n        return true;\n    });\n\n    this.updateNavPageNum(this.currentIndex());\n\n    return this.refs.$BRnav;\n};\n\n/**\n * Initialize the navigation bar when embedded\n */\nBookReader.prototype.initEmbedNavbar = function() {\n    // IA-specific\n    var thisLink = (window.location + '')\n        .replace('?ui=embed','')\n        .replace('/stream/', '/details/')\n        .replace('#', '/')\n    ;\n\n    var logoHtml = '';\n    if (this.showLogo) {\n      logoHtml = \"<a class='logo' href='\" + this.logoURL + \"' 'target='_blank' ></a>\";\n    }\n\n    this.refs.$BRfooter = $('<div class=\"BRfooter\"></div>');\n    this.refs.$BRnav = $('<div class=\"BRnav BRnavEmbed\">'\n        +   logoHtml\n        +   \"<span class='BRembedreturn'>\"\n        +      \"<a href='\" + thisLink + \"' target='_blank'>\"+this.bookTitle+\"</a>\"\n        +   \"</span>\"\n        +   \"<span class='BRtoolbarbuttons'>\"\n        +         '<button class=\"BRicon book_left\"></button>'\n        +         '<button class=\"BRicon book_right\"></button>'\n        +         '<button class=\"BRicon full\"></button>'\n        +   \"</span>\"\n        + '</div>');\n    this.refs.$BRfooter.append(this.refs.$BRnav);\n    this.refs.$br.append(this.refs.$BRfooter);\n};\n\n/**\n * Returns the textual representation of the current page for the navbar\n * @param {number}\n * @return {string}\n */\nBookReader.prototype.getNavPageNumString = function(index) {\n    // Accessible index starts at 0 (alas) so we add 1 to make human\n    var pageNum = this.getPageNum(index);\n    var pageType = this.getPageProp(index, 'pageType');\n    var numLeafs = this.getNumLeafs();\n\n    if (!this.getNavPageNumString.maxPageNum) {\n        // Calculate Max page num (used for pagination display)\n        var maxPageNum = 0;\n        var pageNumVal;\n        for (var i = 0; i < numLeafs; i++) {\n            pageNumVal = this.getPageNum(i);\n            if (!isNaN(pageNumVal) && pageNumVal > maxPageNum) {\n                maxPageNum = pageNumVal;\n            }\n        }\n        this.getNavPageNumString.maxPageNum = maxPageNum;\n    }\n\n    return this.getNavPageNumHtml(index, numLeafs, pageNum, pageType, this.getNavPageNumString.maxPageNum);\n}\n\n/**\n * Renders the html for the page string\n * @param {number} index\n * @param {number} numLeafs\n * @param {number} pageNum\n * @param {string} pageType\n */\nBookReader.prototype.getNavPageNumHtml = function(index, numLeafs, pageNum, pageType, maxPageNum) {\n    var pageStr;\n    if (pageNum[0] != 'n') {\n        pageStr = ' Page ' + pageNum;\n        if (maxPageNum) {\n            pageStr += ' of ' + maxPageNum;\n        }\n    } else {\n        pageStr = (index + 1) + '&nbsp;/&nbsp;' + numLeafs;\n    }\n    return pageStr;\n};\n\n/**\n * Renders the navbar string to the DOM\n * @param {number}\n */\nBookReader.prototype.updateNavPageNum = function(index) {\n    this.$('.BRcurrentpage').html(this.getNavPageNumString(index));\n};\n\n/**\n * Update the nav bar display - does not cause navigation.\n * @param {number}\n */\nBookReader.prototype.updateNavIndex = function(index) {\n    // We want to update the value, but normally moving the slider\n    // triggers jumpToIndex which triggers this method\n    index = index !== undefined ? index : this.currentIndex();\n    this.$('.BRpager').data('swallowchange', true).slider('value', index);\n};\n\nBookReader.prototype.updateNavIndexDebounced = BookReader.util.debounce(BookReader.prototype.updateNavIndex, 500);\nBookReader.prototype.updateNavIndexThrottled = BookReader.util.throttle(BookReader.prototype.updateNavIndex, 250, false);\n\n/**\n * This method builds the html for the toolbar. It can be decorated to extend\n * the toolbar.\n * @return {jqueryElement}\n */\nBookReader.prototype.buildToolbarElement = function() {\n  var logoHtml = '';\n  if (this.showLogo) {\n    logoHtml = \"<span class='BRtoolbarSection BRtoolbarSectionLogo'>\"\n    +  \"<a class='logo' href='\" + this.logoURL + \"'></a>\"\n    + \"</span>\";\n  }\n\n  // Add large screen navigation\n  this.refs.$BRtoolbar = $(\n    \"<div class='BRtoolbar header'>\"\n    +   \"<div class='BRtoolbarbuttons'>\"\n    +     \"<div class='BRtoolbarLeft'>\"\n    +       logoHtml\n    +       \"<span class='BRtoolbarSection BRtoolbarSectionTitle'></span>\"\n    +    \"</div>\"\n\n    +     \"<div class='BRtoolbarRight'>\"\n    +       \"<span class='BRtoolbarSection BRtoolbarSectionInfo'>\"\n    +         \"<button class='BRpill info js-tooltip'>Info</button>\"\n    +         \"<button class='BRpill share js-tooltip'>Share</button>\"\n    +       \"</span>\"\n    // +       \"<span class='BRtoolbarSection BRtoolbarSectionMenu'>\"\n              // TODO actual hamburger menu\n    // +         \"<button class='BRpill BRtoolbarHamburger'>\"\n    // +           \"<img src='\"+this.imagesBaseURL+\"icon_hamburger.svg' />\"\n    // +           \"<div class='BRhamburgerDrawer'><ul><li>hi</li></ul></div>\"\n    // +         \"</button>\"\n    // +       \"</span>\"\n    +     \"</div>\" // end BRtoolbarRight\n    +   \"</div>\"\n    + \"</div>\"\n    );\n\n    var $titleSectionEl = this.refs.$BRtoolbar.find('.BRtoolbarSectionTitle');\n\n    if (this.bookUrl && this.options.enableBookTitleLink) {\n        $titleSectionEl.append(\n            $('<a>')\n            .attr({'href': this.bookUrl, 'title': this.bookUrlTitle})\n            .addClass('BRreturn')\n            .html(this.bookUrlText || this.bookTitle)\n        )\n    } else if (this.bookTitle) {\n        $titleSectionEl.append(this.bookUrlText || this.bookTitle);\n    }\n\n    // var $hamburger = this.refs.$BRtoolbar.find('BRtoolbarHamburger');\n    return this.refs.$BRtoolbar;\n}\n\n/**\n * Initializes the toolbar (top)\n * @param {string} mode\n * @param {string} ui\n */\n// eslint-disable-next-line no-unused-vars\nBookReader.prototype.initToolbar = function(mode, ui) {\n    var self = this;\n\n    this.refs.$br.append(this.buildToolbarElement());\n\n    this.$('.BRnavCntl').addClass('BRup');\n    this.$('.pause').hide();\n\n    this.updateToolbarZoom(this.reduce); // Pretty format\n\n    // We build in mode 2\n    this.refs.$BRtoolbar.append();\n\n    // Hide mode buttons and autoplay if 2up is not available\n    // $$$ if we end up with more than two modes we should show the applicable buttons\n    if ( !this.canSwitchToMode(this.constMode2up) ) {\n        this.$('.two_page_mode, .play, .pause').hide();\n    }\n    if ( !this.canSwitchToMode(this.constModeThumb) ) {\n        this.$('.thumbnail_mode').hide();\n    }\n\n    // Hide one page button if it is the only mode available\n    if ( ! (this.canSwitchToMode(this.constMode2up) || this.canSwitchToMode(this.constModeThumb)) ) {\n        this.$('.one_page_mode').hide();\n    }\n\n    $('<div style=\"display: none;\"></div>').append(\n        this.blankShareDiv()\n    ).append(\n        this.blankInfoDiv()\n    ).appendTo(this.refs.$br);\n\n    this.$('.BRinfo .BRfloatTitle a')\n        .attr({'href': this.bookUrl})\n        .text(this.bookTitle)\n        .addClass('title');\n\n    // These functions can be overridden\n    this.buildInfoDiv(this.$('.BRinfo'));\n    this.buildShareDiv(this.$('.BRshare'));\n\n\n    this.$('.share').colorbox({\n        inline: true,\n        opacity: \"0.5\",\n        href: this.$('.BRshare'),\n        onLoad: function() {\n            self.trigger(BookReader.eventNames.stop);\n            self.$('.BRpageviewValue').val(window.location.href);\n        }\n    });\n    this.$('.info').colorbox({\n        inline: true,\n        opacity: \"0.5\",\n        href: this.$('.BRinfo'),\n        onLoad: function() {\n            self.trigger(BookReader.eventNames.stop);\n        }\n    });\n};\n\nBookReader.prototype.blankInfoDiv = function() {\n    return $([\n        '<div class=\"BRfloat BRinfo\">',\n            '<div class=\"BRfloatHead\">About this book',\n                '<button class=\"floatShut\" href=\"javascript:;\" onclick=\"$.fn.colorbox.close();\"><span class=\"shift\">Close</span></a>',\n            '</div>',\n            '<div class=\"BRfloatBody\">',\n                '<div class=\"BRfloatCover\">',\n                '</div>',\n                '<div class=\"BRfloatMeta\">',\n                    '<div class=\"BRfloatTitle\">',\n                        '<h2><a/></h2>',\n                    '</div>',\n                '</div>',\n            '</div>',\n            '<div class=\"BRfloatFoot\">',\n                '<a href=\"https://openlibrary.org/dev/docs/bookreader\">About the BookReader</a>',\n            '</div>',\n        '</div>'].join('\\n')\n    );\n};\n\nBookReader.prototype.blankShareDiv = function() {\n    return $([\n        '<div class=\"BRfloat BRshare\">',\n            '<div class=\"BRfloatHead\">',\n                'Share',\n                '<button class=\"floatShut\" href=\"javascript:;\" onclick=\"$.fn.colorbox.close();\"><span class=\"shift\">Close</span></a>',\n            '</div>',\n        '</div>'].join('\\n')\n    );\n};\n\n/**\n * Update the displayed zoom factor based on reduction factor\n * @param {number} reduce\n */\nBookReader.prototype.updateToolbarZoom = function(reduce) {\n    var value;\n    var autofit = null;\n\n    // $$$ TODO preserve zoom/fit for each mode\n    if (this.mode == this.constMode2up) {\n        autofit = this.twoPage.autofit;\n    } else {\n        autofit = this.onePage.autofit;\n    }\n\n    if (autofit) {\n        value = autofit.slice(0,1).toUpperCase() + autofit.slice(1);\n    } else {\n        value = (100 / reduce).toFixed(2);\n        // Strip trailing zeroes and decimal if all zeroes\n        value = value.replace(/0+$/,'');\n        value = value.replace(/\\.$/,'');\n        value += '%';\n    }\n    this.$('.BRzoom').text(value);\n};\n\n/**\n * Bind navigation handlers\n */\nBookReader.prototype.bindNavigationHandlers = function() {\n    var self = this;\n\n    // Note the mobile plugin attaches itself to body, so we need to select outside\n    var jIcons = this.$('.BRicon').add('.BRmobileMenu .BRicon');\n\n    jIcons.filter('.onepg').bind('click', function() {\n        self.switchMode(self.constMode1up);\n    });\n\n    jIcons.filter('.twopg').bind('click', function() {\n        self.switchMode(self.constMode2up);\n    });\n\n    jIcons.filter('.thumb').bind('click', function() {\n        self.switchMode(self.constModeThumb);\n    });\n\n    jIcons.filter('.fit').bind('fit', function() {\n        // XXXmang implement autofit zoom\n    });\n\n    jIcons.filter('.book_left').click(function() {\n        self.trigger(BookReader.eventNames.stop);\n        self.left();\n        return false;\n    });\n\n    jIcons.filter('.book_right').click(function() {\n        self.trigger(BookReader.eventNames.stop);\n        self.right();\n        return false;\n    });\n\n    jIcons.filter('.book_up').bind('click', function() {\n        if ($.inArray(self.mode, [self.constMode1up, self.constModeThumb]) >= 0) {\n            self.scrollUp();\n        } else {\n            self.prev();\n        }\n        return false;\n    });\n\n    jIcons.filter('.book_down').bind('click', function() {\n        if ($.inArray(self.mode, [self.constMode1up, self.constModeThumb]) >= 0) {\n            self.scrollDown();\n        } else {\n            self.next();\n        }\n        return false;\n    });\n\n    jIcons.filter('.book_top').click(function() {\n        self.first();\n        return false;\n    });\n\n    jIcons.filter('.book_bottom').click(function() {\n        self.last();\n        return false;\n    });\n\n    jIcons.filter('.book_leftmost').click(function() {\n        self.leftmost();\n        return false;\n    });\n\n    jIcons.filter('.book_rightmost').click(function() {\n        self.rightmost();\n        return false;\n    });\n\n    jIcons.filter('.zoom_in').bind('click', function() {\n        self.trigger(BookReader.eventNames.stop);\n        self.zoom(1);\n        self.trigger(BookReader.eventNames.zoomIn);\n        return false;\n    });\n\n    jIcons.filter('.zoom_out').bind('click', function() {\n        self.trigger(BookReader.eventNames.stop);\n        self.zoom(-1);\n        self.trigger(BookReader.eventNames.zoomOut);\n        return false;\n    });\n\n    jIcons.filter('.full').bind('click', function() {\n        if (self.ui == 'embed') {\n            var url = self.$('.BRembedreturn a').attr('href');\n            window.open(url);\n        } else {\n            self.toggleFullscreen();\n        }\n    });\n\n    var $brNavCntlBtmEl = this.$('.BRnavCntlBtm');\n    var $brNavCntlTopEl = this.$('.BRnavCntlTop');\n\n    this.$('.BRnavCntl').click(\n        function(){\n            var promises = [];\n            // TODO don't use magic constants\n            // TODO move this to a function\n            if ($brNavCntlBtmEl.hasClass('BRdn')) {\n                if (self.refs.$BRtoolbar)\n                    promises.push(self.refs.$BRtoolbar.animate(\n                        {top: self.getToolBarHeight() * -1}\n                    ).promise());\n                promises.push(self.$('.BRfooter').animate({bottom: self.getFooterHeight() * -1}).promise());\n                $brNavCntlBtmEl.addClass('BRup').removeClass('BRdn');\n                $brNavCntlTopEl.addClass('BRdn').removeClass('BRup');\n                self.$('.BRnavCntlBtm.BRnavCntl').animate({height:'45px'});\n                self.$('.BRnavCntl').delay(1000).animate({opacity:.75}, 1000);\n            } else {\n                if (self.refs.$BRtoolbar)\n                    promises.push(self.refs.$BRtoolbar.animate({top:0}).promise());\n                promises.push(self.$('.BRfooter').animate({bottom:0}).promise());\n                $brNavCntlBtmEl.addClass('BRdn').removeClass('BRup');\n                $brNavCntlTopEl.addClass('BRup').removeClass('BRdn');\n                self.$('.BRnavCntlBtm.BRnavCntl').animate({height:'30px'});\n                self.$('.BRvavCntl').animate({opacity:1})\n            }\n            $.when.apply($, promises).done(function() {\n                // Only do full resize in auto mode and need to recalc. size\n                if (self.mode == self.constMode2up && self.twoPage.autofit != null\n                    && self.twoPage.autofit != 'none'\n                   ) {\n                    self.resize();\n                } else if (self.mode == self.constMode1up && self.onePage.autofit != null\n                           && self.onePage.autofit != 'none') {\n                    self.resize();\n                } else {\n                    // Don't do a full resize to avoid redrawing images\n                    self.resizeBRcontainer();\n                }\n            });\n        }\n    );\n    $brNavCntlBtmEl.mouseover(function(){\n        if ($(this).hasClass('BRup')) {\n            self.$('.BRnavCntl').animate({opacity:1},250);\n        }\n    }).mouseleave(function(){\n        if ($(this).hasClass('BRup')) {\n            self.$('.BRnavCntl').animate({opacity:.75},250);\n        }\n    });\n    $brNavCntlTopEl.mouseover(function(){\n        if ($(this).hasClass('BRdn')) {\n            self.$('.BRnavCntl').animate({opacity:1},250);\n        }\n    }).mouseleave(function(){\n        if ($(this).hasClass('BRdn')) {\n            self.$('.BRnavCntl').animate({opacity:.75},250);\n        }\n    });\n\n    this.initSwipeData();\n\n    $(document).off('mousemove.navigation', this.el);\n    $(document).on(\n      'mousemove.navigation',\n      this.el,\n      { 'br': this },\n      this.navigationMousemoveHandler\n    );\n\n    $(document).off('mousedown.swipe', '.BRpageimage');\n    $(document).on(\n      'mousedown.swipe',\n      '.BRpageimage',\n      { 'br': this },\n      this.swipeMousedownHandler\n    );\n\n    this.bindMozTouchHandlers();\n};\n\n/**\n * Unbind navigation handlers\n */\nBookReader.prototype.unbindNavigationHandlers = function() {\n    $(document).off('mousemove.navigation', this.el);\n};\n\n/**\n * Handle mousemove related to navigation.  Bind at #BookReader level to allow autohide.\n */\nBookReader.prototype.navigationMousemoveHandler = function(event) {\n    // $$$ possibly not great to be calling this for every mousemove\n    if (event.data['br'].uiAutoHide) {\n        // 77px is an approximate height of the Internet Archive Top Nav\n        // 75 & 76 (pixels) provide used in this context is checked againt the IA top nav height\n        var navkey = $(document).height() - 75;\n        if ((event.pageY < 76) || (event.pageY > navkey)) {\n            // inside or near navigation elements\n            event.data['br'].hideNavigation();\n        } else {\n            event.data['br'].showNavigation();\n        }\n    }\n};\n\nBookReader.prototype.initSwipeData = function(clientX, clientY) {\n    /*\n     * Based on the really quite awesome \"Today's Guardian\" at http://guardian.gyford.com/\n     */\n    this._swipe = {\n        mightBeSwiping: false,\n        didSwipe: false,\n        mightBeDraggin: false,\n        didDrag: false,\n        startTime: (new Date).getTime(),\n        startX: clientX,\n        startY: clientY,\n        lastX: clientX,\n        lastY: clientY,\n        deltaX: 0,\n        deltaY: 0,\n        deltaT: 0\n    }\n};\n\nBookReader.prototype.swipeMousedownHandler = function(event) {\n    var self = event.data['br'];\n\n    // We should be the last bubble point for the page images\n    // Disable image drag and select, but keep right-click\n    if (event.which == 3) {\n        return !self.protected;\n    }\n\n    $(event.target).bind('mouseout.swipe',\n        { 'br': self},\n        self.swipeMouseupHandler\n    ).bind('mouseup.swipe',\n        { 'br': self},\n        self.swipeMouseupHandler\n    ).bind('mousemove.swipe',\n        { 'br': self },\n        self.swipeMousemoveHandler\n    );\n\n    self.initSwipeData(event.clientX, event.clientY);\n    self._swipe.mightBeSwiping = true;\n    self._swipe.mightBeDragging = true;\n\n    event.preventDefault();\n    event.returnValue  = false;\n    event.cancelBubble = true;\n    return false;\n};\n\nBookReader.prototype.swipeMousemoveHandler = function(event) {\n    var self = event.data['br'];\n    var _swipe = self._swipe;\n    if (! _swipe.mightBeSwiping) {\n        return;\n    }\n\n    // Update swipe data\n    _swipe.deltaX = event.clientX - _swipe.startX;\n    _swipe.deltaY = event.clientY - _swipe.startY;\n    _swipe.deltaT = (new Date).getTime() - _swipe.startTime;\n\n    var absX = Math.abs(_swipe.deltaX);\n    var absY = Math.abs(_swipe.deltaY);\n\n    // Minimum distance in the amount of tim to trigger the swipe\n    var minSwipeLength = Math.min(self.refs.$br.width() / 5, 80);\n    var maxSwipeTime = 400;\n\n    // Check for horizontal swipe\n    if (absX > absY && (absX > minSwipeLength) && _swipe.deltaT < maxSwipeTime) {\n        _swipe.mightBeSwiping = false; // only trigger once\n        _swipe.didSwipe = true;\n        if (self.mode == self.constMode2up) {\n            if (_swipe.deltaX < 0) {\n                self.right();\n            } else {\n                self.left();\n            }\n        }\n    }\n\n    if ( _swipe.deltaT > maxSwipeTime && !_swipe.didSwipe) {\n        if (_swipe.mightBeDragging) {\n            // Dragging\n            _swipe.didDrag = true;\n            self.refs.$brContainer\n            .scrollTop(self.refs.$brContainer.scrollTop() - event.clientY + _swipe.lastY)\n            .scrollLeft(self.refs.$brContainer.scrollLeft() - event.clientX + _swipe.lastX);\n        }\n    }\n    _swipe.lastX = event.clientX;\n    _swipe.lastY = event.clientY;\n\n    event.preventDefault();\n    event.returnValue  = false;\n    event.cancelBubble = true;\n    return false;\n};\n\nBookReader.prototype.swipeMouseupHandler = function(event) {\n    var _swipe = event.data['br']._swipe;\n    _swipe.mightBeSwiping = false;\n    _swipe.mightBeDragging = false;\n\n    $(event.target).unbind('mouseout.swipe').unbind('mouseup.swipe').unbind('mousemove.swipe');\n\n    if (_swipe.didSwipe || _swipe.didDrag) {\n        // Swallow event if completed swipe gesture\n        event.preventDefault();\n        event.returnValue  = false;\n        event.cancelBubble = true;\n        return false;\n    }\n    return true;\n};\n\nBookReader.prototype.bindMozTouchHandlers = function() {\n    var self = this;\n\n    // Currently only want touch handlers in 2up\n    this.refs.$br.bind('MozTouchDown', function(event) {\n        if (this.mode == self.constMode2up) {\n            event.preventDefault();\n        }\n    })\n    .bind('MozTouchMove', function(event) {\n        if (this.mode == self.constMode2up) {\n            event.preventDefault();\n        }\n    })\n    .bind('MozTouchUp', function(event) {\n        if (this.mode == self.constMode2up) {\n            event.preventDefault();\n        }\n    });\n};\n\n/**\n * Returns true if the navigation elements are currently visible\n * @return {boolean}\n */\nBookReader.prototype.navigationIsVisible = function() {\n    // $$$ doesn't account for transitioning states, nav must be fully visible to return true\n    var toolpos = this.refs.$BRtoolbar.position();\n    var tooltop = toolpos.top;\n    return tooltop == 0;\n};\n\n/**\n * Main controller that sets navigation into view.\n * Defaults to SHOW the navigation chrome\n */\nBookReader.prototype.setNavigationView = function brSetNavigationView(hide) {\n    var animationLength = this.constNavAnimationDuration;\n    var animationType = 'linear';\n    var resizePageContainer = function resizePageContainer () {\n        /* main page container fills whole container */\n        if (this.constMode2up !== this.mode) {\n            var animate = true;\n            this.resizeBRcontainer(animate);\n        }\n        this.trigger(BookReader.eventNames.navToggled);\n    }.bind(this);\n\n    var toolbarHeight = 0;\n    var navbarHeight = 0;\n    if (hide) {\n        toolbarHeight = this.getToolBarHeight() * -1;\n        navbarHeight = this.getFooterHeight() * -1;\n\n        this.refs.$BRtoolbar.addClass('js-menu-hide');\n        this.refs.$BRfooter.addClass('js-menu-hide');\n    } else {\n        this.refs.$BRtoolbar.removeClass('js-menu-hide');\n        this.refs.$BRfooter.removeClass('js-menu-hide');\n    }\n\n    this.refs.$BRtoolbar.animate(\n        { top: toolbarHeight },\n        animationLength,\n        animationType,\n        resizePageContainer\n    );\n    this.refs.$BRfooter.animate(\n        { bottom: navbarHeight },\n        animationLength,\n        animationType,\n        resizePageContainer\n    );\n};\n/**\n * Hide navigation elements, if visible\n */\nBookReader.prototype.hideNavigation = function() {\n    // Check if navigation is showing\n    if (this.navigationIsVisible()) {\n        var hide = true;\n        this.setNavigationView(hide);\n    }\n};\n\n/**\n * Show navigation elements\n */\nBookReader.prototype.showNavigation = function() {\n    // Check if navigation is hidden\n    if (!this.navigationIsVisible()) {\n        this.setNavigationView();\n    }\n};\n\n/**\n * Returns the index of the first visible page, dependent on the mode.\n * $$$ Currently we cannot display the front/back cover in 2-up and will need to update\n * this function when we can as part of https://bugs.launchpad.net/gnubook/+bug/296788\n * @return {number}\n */\nBookReader.prototype.firstDisplayableIndex = function() {\n    if (this.mode != this.constMode2up) {\n        return 0;\n    }\n\n    if ('rl' != this.pageProgression) {\n        // LTR\n        if (this.getPageSide(0) == 'L') {\n            return 0;\n        } else {\n            return -1;\n        }\n    } else {\n        // RTL\n        if (this.getPageSide(0) == 'R') {\n            return 0;\n        } else {\n            return -1;\n        }\n    }\n};\n\n/**\n * Returns the index of the last visible page, dependent on the mode.\n * $$$ Currently we cannot display the front/back cover in 2-up and will need to update\n * this function when we can as part of https://bugs.launchpad.net/gnubook/+bug/296788\n * @return {number}\n */\nBookReader.prototype.lastDisplayableIndex = function() {\n\n    var lastIndex = this.getNumLeafs() - 1;\n\n    if (this.mode != this.constMode2up) {\n        return lastIndex;\n    }\n\n    if ('rl' != this.pageProgression) {\n        // LTR\n        if (this.getPageSide(lastIndex) == 'R') {\n            return lastIndex;\n        } else {\n            return lastIndex + 1;\n        }\n    } else {\n        // RTL\n        if (this.getPageSide(lastIndex) == 'L') {\n            return lastIndex;\n        } else {\n            return lastIndex + 1;\n        }\n    }\n};\n\n// Parameter related functions\n\n/**\n * Update from the params object\n * @param {Object}\n */\nBookReader.prototype.updateFromParams = function(params) {\n    if ('undefined' != typeof(params.mode)) {\n        this.switchMode(params.mode);\n    }\n\n    // $$$ process /zoom\n    var pageFound = false;\n    // We only respect page if index is not set\n    if ('undefined' != typeof(params.index)) {\n        pageFound = true;\n        if (params.index != this.currentIndex()) {\n            this.jumpToIndex(params.index);\n        }\n    } else if ('undefined' != typeof(params.page)) {\n        pageFound = true;\n        // $$$ this assumes page numbers are unique\n        if (params.page != this.getPageNum(this.currentIndex())) {\n            this.jumpToPage(params.page);\n        }\n    }\n\n    // process /search\n    if (this.enableSearch && 'undefined' != typeof(params.search)) {\n        if (this.searchTerm != params.search) {\n            this.search(params.search, {goToFirstResult: !pageFound});\n            this.$('.BRsearchInput').val(params.search);\n        }\n    }\n\n    // $$$ process /region\n    // $$$ process /highlight\n\n    // $$$ process /theme\n    if (this.enableThemesPlugin && 'undefined' != typeof(params.theme)) {\n        this.updateTheme(params.theme);\n    }\n};\n\n/**\n * Returns the *highest* index the given page number, or undefined\n * @param {string}\n * @return {Array|undefined}\n */\nBookReader.prototype.getPageIndex = function(pageNum) {\n    var pageIndices = this.getPageIndices(pageNum);\n\n    if (pageIndices.length > 0) {\n        return pageIndices[pageIndices.length - 1];\n    }\n\n    return undefined;\n};\n\n/**\n * Returns an array (possibly empty) of the indices with the given page number\n * @param {string}\n * @return {array}\n */\nBookReader.prototype.getPageIndices = function(pageNum) {\n    var indices = [];\n\n    // Check for special \"nXX\" page number\n    if (pageNum.slice(0,1) == 'n') {\n        try {\n            var pageIntStr = pageNum.slice(1, pageNum.length);\n            var pageIndex = parseInt(pageIntStr);\n            indices.push(pageIndex);\n            return indices;\n        } catch(err) {\n            // Do nothing... will run through page names and see if one matches\n        }\n    }\n\n    var i;\n    for (i=0; i<this.getNumLeafs(); i++) {\n        if (this.getPageNum(i) == pageNum) {\n            indices.push(i);\n        }\n    }\n\n    return indices;\n};\n\n/**\n * Returns the name of the page as it should be displayed in the user interface\n * @param {number} index\n * @return {string}\n */\nBookReader.prototype.getPageName = function(index) {\n    return 'Page ' + this.getPageNum(index);\n};\n\n/**\n * Returns true if we can switch to the requested mode\n * @param {number} mode\n * @return {boolean}\n */\nBookReader.prototype.canSwitchToMode = function(mode) {\n    if (mode == this.constMode2up || mode == this.constModeThumb) {\n        // check there are enough pages to display\n        // $$$ this is a workaround for the mis-feature that we can't display\n        //     short books in 2up mode\n        if (this.getNumLeafs() < 2) {\n            return false;\n        }\n    }\n\n    return true;\n};\n\n/**\n * Returns the page width for the given index, or first or last page if out of range\n * @deprecated see getPageWidth\n */\nBookReader.prototype._getPageWidth = function(index) {\n    // Synthesize a page width for pages not actually present in book.\n    // May or may not be the best approach.\n    // If index is out of range we return the width of first or last page\n    index = BookReader.util.clamp(index, 0, this.getNumLeafs() - 1);\n    return this.getPageWidth(index);\n};\n\n/**\n * Returns the page height for the given index, or first or last page if out of range\n * @deprecated see getPageHeight\n */\nBookReader.prototype._getPageHeight = function(index) {\n    var clampedIndex = BookReader.util.clamp(index, 0, this.getNumLeafs() - 1);\n    return this.getPageHeight(clampedIndex);\n};\n\n/**\n * Returns the page URI or transparent image if out of range\n * Also makes the reduce argument optional\n * @param {number} index\n * @param {number} [reduce]\n * @param {number} [rotate]\n * @return {string}\n */\nBookReader.prototype._getPageURI = function(index, reduce, rotate) {\n    if (index < 0 || index >= this.getNumLeafs()) { // Synthesize page\n        return this.imagesBaseURL + \"transparent.png\";\n    }\n\n    if ('undefined' == typeof(reduce)) {\n        // reduce not passed in\n        // $$$ this probably won't work for thumbnail mode\n        var ratio = this.getPageHeight(index) / this.twoPage.height;\n        var scale;\n        // $$$ we make an assumption here that the scales are available pow2 (like kakadu)\n        if (ratio < 2) {\n            scale = 1;\n        } else if (ratio < 4) {\n            scale = 2;\n        } else if (ratio < 8) {\n            scale = 4;\n        } else if (ratio < 16) {\n            scale = 8;\n        } else  if (ratio < 32) {\n            scale = 16;\n        } else {\n            scale = 32;\n        }\n        reduce = scale;\n    }\n\n    return this.getPageURI(index, reduce, rotate);\n};\n\n/**\n * @param {string}\n */\nBookReader.prototype.showProgressPopup = function(msg) {\n    if (this.popup) return;\n\n    this.popup = document.createElement(\"div\");\n    $(this.popup).css({\n        top:      (this.refs.$br.height()*0.5-100) + 'px',\n        left:     (this.refs.$br.width()-300)*0.5 + 'px'\n    }).prop('className', 'BRprogresspopup');\n\n    var bar = document.createElement(\"div\");\n    $(bar).css({\n        height:   '20px'\n    }).prop('className', 'BRprogressbar');\n    $(this.popup).append(bar);\n\n    if (msg) {\n        var msgdiv = document.createElement(\"div\");\n        msgdiv.innerHTML = msg;\n        $(this.popup).append(msgdiv);\n    }\n\n    $(this.popup).appendTo(this.refs.$br);\n};\n\nBookReader.prototype.removeProgressPopup = function() {\n    $(this.popup).remove();\n    this.$('.BRprogresspopup').remove();\n    this.popup=null;\n};\n\nBookReader.prototype.buildShareDiv = function(jShareDiv) {\n    var pageView = document.location + '';\n    var bookView = (pageView + '').replace(/#.*/,'');\n    var self = this;\n\n    var embedHtml = '';\n    if (this.getEmbedCode) {\n      embedHtml = [\n        '<div class=\"share-embed\">',\n          '<p class=\"share-embed-prompt\">Copy and paste one of these options to share this book elsewhere.</p>',\n          '<form method=\"post\" action=\"\">',\n              '<fieldset class=\"fieldset-share-pageview\">',\n                  '<label for=\"pageview\">Link to this page view</label>',\n                  '<input type=\"text\" name=\"pageview\" class=\"BRpageviewValue\" value=\"' + pageView + '\"/>',\n              '</fieldset>',\n              '<fieldset class=\"fieldset-share-book-link\">',\n                  '<label for=\"booklink\">Link to the book</label>',\n                  '<input type=\"text\" name=\"booklink\" class=\"booklink\" value=\"' + bookView + '\"/>',\n              '</fieldset>',\n              '<fieldset class=\"fieldset-embed\">',\n                  '<label for=\"iframe\">Embed a mini Book Reader</label>',\n                  '<fieldset class=\"sub\">',\n                      '<label class=\"sub\">',\n                          '<input type=\"radio\" name=\"pages\" value=\"' + this.constMode1up + '\" checked=\"checked\"/>',\n                          '1 page',\n                      '</label>',\n                      '<label class=\"sub\">',\n                          '<input type=\"radio\" name=\"pages\" value=\"' + this.constMode2up + '\"/>',\n                          '2 pages',\n                      '</label>',\n                      '<label class=\"sub\">',\n                          '<input type=\"checkbox\" name=\"thispage\" value=\"thispage\"/>',\n                          'Open to this page?',\n                      '</label>',\n                  '</fieldset>',\n                  '<textarea cols=\"30\" rows=\"4\" name=\"iframe\" class=\"BRframeEmbed\"></textarea>',\n              '</fieldset>',\n          '</form>',\n        '</div>'\n      ].join('\\n');\n    }\n\n    var jForm = $([\n        '<div class=\"share-title\">Share this book</div>',\n        '<div class=\"share-social\">',\n            '<label class=\"sub open-to-this-page\">',\n                '<input class=\"thispage-social\" type=\"checkbox\" />',\n                'Open to this page?',\n            '</label>',\n            '<div><button class=\"BRaction share facebook-share-button\"><i class=\"BRicon fb\" /> Facebook</button></div>',\n            '<div><button class=\"BRaction share twitter-share-button\"><i class=\"BRicon twitter\" /> Twitter</button></div>',\n            '<div><button class=\"BRaction share email-share-button\"><i class=\"BRicon email\" /> Email</button></div>',\n        '</div>',\n        embedHtml,\n        '<div class=\"BRfloatFoot\">',\n            '<button class=\"share-finished\" type=\"button\" onclick=\"$.fn.colorbox.close();\">Finished</button>',\n        '</div>'\n        ].join('\\n'));\n\n    jForm.appendTo(jShareDiv);\n\n    jForm.find('.fieldset-embed input').bind('change', function() {\n        var form = $(this).parents('form:first');\n        var params = {};\n        params.mode = $(form.find('.fieldset-embed input[name=pages]:checked')).val();\n        if (form.find('.fieldset-embed input[name=thispage]').prop('checked')) {\n            params.page = self.getPageNum(self.currentIndex());\n        }\n\n        if (self.getEmbedCode) {\n          // $$$ changeable width/height to be added to share UI\n          var frameWidth = \"480px\";\n          var frameHeight = \"430px\";\n          form.find('.BRframeEmbed').val(self.getEmbedCode(frameWidth, frameHeight, params));\n        }\n    });\n\n    jForm.find('input, textarea').bind('focus', function() {\n        this.select();\n    });\n\n    // Bind share buttons\n\n    // Use url without hashes\n    jForm.find('.facebook-share-button').click(function(){\n      var params = $.param({ u: self._getSocialShareUrl() });\n      var url = 'https://www.facebook.com/sharer.php?' + params;\n      self.createPopup(url, 600, 400, 'Share')\n    });\n    jForm.find('.twitter-share-button').click(function(){\n      var params = $.param({\n        url: self._getSocialShareUrl(),\n        text: self.bookTitle\n      });\n      var url = 'https://twitter.com/intent/tweet?' + params;\n      self.createPopup(url, 600, 400, 'Share')\n    });\n    jForm.find('.email-share-button').click(function(){\n      var body = self.bookTitle + \"\\n\\n\" + self._getSocialShareUrl();\n      window.location.href = 'mailto:?subject=' + encodeURI(self.bookTitle) + '&body=' + encodeURI(body);\n    });\n\n    jForm.find('input[name=thispage]').trigger('change');\n\n    jForm.appendTo(jShareDiv);\n};\n\nBookReader.prototype._getSocialShareUrl = function() {\n    var shareThisPage = this.$('.thispage-social').prop('checked');\n    if (shareThisPage) {\n      return window.location.href;\n    } else {\n      return document.location.protocol + \"//\" + window.location.hostname + window.location.pathname;\n    }\n};\n\n/**\n * @param JInfoDiv DOM element. Appends info to this element\n * Can be overridden or extended\n */\nBookReader.prototype.buildInfoDiv = function(jInfoDiv) {\n    // Remove these legacy elements\n    jInfoDiv.find('.BRfloatBody, .BRfloatCover, .BRfloatFoot').remove();\n\n    var $leftCol = $(\"<div class=\\\"BRinfoLeftCol\\\"></div>\");\n    if (this.thumbnail) {\n      $leftCol.append($(\"<div class=\\\"BRimageW\\\">\"\n      +\"  <img src=\\\"\"+this.thumbnail+\"\\\" \"\n      +\"       alt=\\\"\"+BookReader.util.escapeHTML(this.bookTitle)+\"\\\" />\"\n      +\"</div>\"));\n    }\n\n    var $rightCol = $(\"<div class=\\\"BRinfoRightCol\\\">\");\n\n    // A loop to build fields\n    var extraClass;\n    for (var i = 0; i < this.metadata.length; i++) {\n      extraClass = this.metadata[i].extraValueClass || '';\n      $rightCol.append($(\"<div class=\\\"BRinfoValueWrapper\\\">\"\n      +\"  <div class=\\\"BRinfoLabel\\\">\"\n      +     this.metadata[i].label\n      +\"  </div>\"\n      +\"  <div class=\\\"BRinfoValue \" + extraClass + \"\\\">\"\n      +     this.metadata[i].value\n      +\"  </div>\"\n      +\"</div>\"));\n    }\n\n    var moreInfoText;\n    if (this.bookUrlMoreInfo) {\n      moreInfoText = this.bookUrlMoreInfo;\n    } else if (this.bookTitle) {\n      moreInfoText = this.bookTitle;\n    }\n\n    if (moreInfoText && this.bookUrl) {\n      $rightCol.append($(\"<div class=\\\"BRinfoValueWrapper\\\">\"\n        +\"<div class=\\\"BRinfoMoreInfoWrapper\\\">\"\n        +\"  <a class=\\\"BRinfoMoreInfo\\\" href=\\\"\"+this.bookUrl+\"\\\">\"\n        +   moreInfoText\n        +\"  </a>\"\n        +\"</div>\"\n      +\"</div>\"));\n    }\n\n\n    var footerEl = \"<div class=\\\"BRfloatFoot BRinfoFooter\\\"></div>\";\n\n    var children = [\n      $leftCol,\n      $rightCol,\n      '<br style=\"clear:both\"/>'\n    ];\n    var childrenEl = $('<div class=\"BRinfoW mv20-lg\">').append(children);\n\n    jInfoDiv.append(\n      childrenEl,\n      $(footerEl)\n    ).addClass('wide');\n};\n\n/**\n * Can be overriden\n */\nBookReader.prototype.initUIStrings = function() {\n    // Navigation handlers will be bound after all UI is in place -- makes moving icons between\n    // the toolbar and nav bar easier\n\n    // Setup tooltips -- later we could load these from a file for i18n\n    var titles = { '.logo': 'Go to Archive.org', // $$$ update after getting OL record\n                   '.zoom_in': 'Zoom in',\n                   '.zoom_out': 'Zoom out',\n                   '.onepg': 'One-page view',\n                   '.twopg': 'Two-page view',\n                   '.thumb': 'Thumbnail view',\n                   '.print': 'Print this page',\n                   '.embed': 'Embed BookReader',\n                   '.link': 'Link to this book (and page)',\n                   '.bookmark': 'Bookmark this page',\n                   '.read': 'Read this book aloud',\n                   '.share': 'Share this book',\n                   '.info': 'About this book',\n                   '.full': 'Toggle fullscreen',\n                   '.book_left': 'Flip left',\n                   '.book_right': 'Flip right',\n                   '.book_up': 'Page up',\n                   '.book_down': 'Page down',\n                   '.play': 'Play',\n                   '.pause': 'Pause',\n                   '.BRdn': 'Show/hide nav bar', // Would have to keep updating on state change to have just \"Hide nav bar\"\n                   '.BRup': 'Show/hide nav bar',\n                   '.book_top': 'First page',\n                   '.book_bottom': 'Last page'\n                  };\n    if ('rl' == this.pageProgression) {\n        titles['.book_leftmost'] = 'Last page';\n        titles['.book_rightmost'] = 'First page';\n    } else { // LTR\n        titles['.book_leftmost'] = 'First page';\n        titles['.book_rightmost'] = 'Last page';\n    }\n\n    for (var icon in titles) {\n        if (titles.hasOwnProperty(icon)) {\n            this.$(icon).prop('title', titles[icon]);\n        }\n    }\n}\n\n/**\n * Helper opens a popup window. On mobile it only opens a new tab. Used for share.\n */\nBookReader.prototype.createPopup = function(href, width, height, name) {\n  // Fixes dual-screen position\n  var dualScreenLeft = window.screenLeft != undefined ? window.screenLeft : screen.left;\n  var dualScreenTop = window.screenTop != undefined ? window.screenTop : screen.top;\n\n  var win_w = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width;\n  var win_h = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;\n\n  var left   = ((win_w / 2) - (width / 2)) + dualScreenLeft,\n      top    = ((win_h / 2) - (height / 2)) + dualScreenTop,\n      url    = href,\n      opts   = 'status=1' +\n               ',width='  + width  +\n               ',height=' + height +\n               ',top='    + top    +\n               ',left='   + left;\n\n  window.open(url, name, opts);\n};\n\n/**\n * Reloads images. Useful when some images might have failed.\n */\nBookReader.prototype.reloadImages = function() {\n  this.refs.$brContainer.find('img').each(function(index, elem) {\n    if (!elem.complete || elem.naturalHeight === 0) {\n      var src = elem.src;\n      elem.src = '';\n      setTimeout(function() {\n        elem.src = src;\n      }, 1000);\n    }\n  });\n};\n\n/**\n * @return {number} (in pixels) of the toolbar height. 0 if no toolbar.\n */\nBookReader.prototype.getToolBarHeight = function() {\n  if (this.refs.$BRtoolbar && this.refs.$BRtoolbar.css('display') === 'block') {\n    return (this.refs.$BRtoolbar.outerHeight() + parseInt(this.refs.$BRtoolbar.css('top')));\n  } else {\n    return 0;\n  }\n}\n\n/**\n * @param {boolean} ignoreDisplay - bypass the display check\n * @return {number}\n */\nBookReader.prototype.getFooterHeight = function() {\n    var $heightEl = this.mode == this.constMode2up ? this.refs.$BRfooter : this.refs.$BRnav;\n    if ($heightEl && this.refs.$BRfooter) {\n        var outerHeight = $heightEl.outerHeight();\n        var bottom = parseInt(this.refs.$BRfooter.css('bottom'));\n        if (!isNaN(outerHeight) && !isNaN(bottom)) {\n          return outerHeight + bottom;\n        }\n    }\n    return 0;\n}\n\n// Basic Usage built-in Methods (can be overridden through options)\n// This implementation uses options.data value for populating BookReader\n\n/**\n * @return {number} the total number of leafs (like an array length)\n */\nBookReader.prototype.getNumLeafs = function() {\n    // For deprecated interface support, if numLeafs is set, use that.\n    if (this.numLeafs !== undefined)\n      return this.numLeafs;\n    return this._getDataFlattened().length;\n};\n\n/**\n * @param  {number} index\n * @return {Number|undefined}\n */\nBookReader.prototype.getPageWidth = function(index) {\n    return this.getPageProp(index, 'width');\n};\n\n/**\n * @param  {number} index\n * @return {Number|undefined}\n */\nBookReader.prototype.getPageHeight = function(index) {\n    return this.getPageProp(index, 'height');\n};\n\n/**\n * @param  {number} index\n * @param  {number} reduce - not used in default implementation\n * @param  {number} rotate - not used in default implementation\n * @return {Number|undefined}\n */\n// eslint-disable-next-line no-unused-vars\nBookReader.prototype.getPageURI = function(index, reduce, rotate) {\n    return this.getPageProp(index, 'uri');\n};\n\n/**\n * @param  {number} index\n * @return {string} - L or R\n */\nBookReader.prototype.getPageSide = function(index) {\n    var pageSide = this.getPageProp(index, 'pageSide');\n    if (!pageSide) {\n        pageSide = index % 2 === 0 ? 'R' : 'L';\n    }\n    return pageSide;\n};\n\n/**\n * @param  {number} index\n * @return {string}\n */\nBookReader.prototype.getPageNum = function(index) {\n    var pageNum = this.getPageProp(index, 'pageNum');\n    if (pageNum === undefined) {\n        pageNum = 'n' + index;\n    }\n    return pageNum;\n};\n\n/**\n * Generalized property accessor.\n * @param  {number} index\n * @return {mixed|undefined}\n */\nBookReader.prototype.getPageProp = function(index, propName) {\n    return this._getDataProp(index, propName);\n};\n\n/**\n * This function returns the left and right indices for the user-visible\n * spread that contains the given index.  The return values may be\n * null if there is no facing page or the index is invalid.\n * @param  {number} pindex\n * @return {array} - eg [0, 1]\n */\nBookReader.prototype.getSpreadIndices = function(pindex) {\n    var spreadIndices;\n    if ('rl' == this.pageProgression) {\n        spreadIndices = this.getPageSide(pindex) == 'R' ? [pindex + 1, pindex] : [pindex, pindex - 1];\n    } else {\n        spreadIndices = this.getPageSide(pindex) == 'L' ? [pindex, pindex + 1] : [pindex - 1, pindex];\n    }\n    return spreadIndices;\n};\n\n/**\n * Single images in the Internet Archive scandata.xml metadata are (somewhat incorrectly)\n * given a \"leaf\" number.  Some of these images from the scanning process should not\n * be displayed in the BookReader (for example colour calibration cards).  Since some\n * of the scanned images will not be displayed in the BookReader (those marked with\n * addToAccessFormats false in the scandata.xml) leaf numbers and BookReader page\n * indexes are generally not the same.  This function returns the BookReader page\n * index given a scanned leaf number.\n *\n * This function is used, for example, to map between search results (that use the\n * leaf numbers) and the displayed pages in the BookReader.\n * @param  {number} index\n * @return {number}\n */\nBookReader.prototype.leafNumToIndex = function(leafNum) {\n    var dataf = this._getDataFlattened();\n    for (var i = 0; i < dataf.length; i++) {\n        if (dataf[i].leafNum == leafNum) {\n            return i;\n        }\n    }\n    // If no match is found, fall back to the leafNum provide (leafNum == index)\n    return leafNum;\n};\n\n/**\n * Create a params object from the current parameters.\n * @return {Object}\n */\nBookReader.prototype.paramsFromCurrent = function() {\n    var params = {};\n\n    var index = this.currentIndex();\n    var pageNum = this.getPageNum(index);\n    if ((pageNum === 0) || pageNum) {\n        params.page = pageNum;\n    }\n\n    params.index = index;\n    params.mode = this.mode;\n\n    // $$$ highlight\n    // $$$ region\n\n    // search\n    if (this.enableSearch) {\n        params.search = this.searchTerm;\n    }\n\n    return params;\n};\n\n/**\n * Return an object with configuration parameters from a fragment string.\n *\n * Fragments are formatted as a URL path but may be used outside of URLs as a\n * serialization format for BookReader parameters\n *\n * @see http://openlibrary.org/dev/docs/bookurls for fragment syntax\n *\n * @param {string} fragment initial # is allowed for backwards compatibility\n *                          but is deprecated\n * @return {Object}\n */\nBookReader.prototype.paramsFromFragment = function(fragment) {\n    var params = {};\n\n    // For backwards compatibility we allow an initial # character\n    // (as from window.location.hash) but don't require it\n    if (fragment.substr(0, 1) == '#') {\n        fragment = fragment.substr(1);\n    }\n\n    // Simple #nn syntax\n    var oldStyleLeafNum = parseInt( /^\\d+$/.exec(fragment) );\n    if ( !isNaN(oldStyleLeafNum) ) {\n        params.index = oldStyleLeafNum;\n\n        // Done processing if using old-style syntax\n        return params;\n    }\n\n    // Split into key-value pairs\n    var urlArray = fragment.split('/');\n    var urlHash = {};\n    for (var i = 0; i < urlArray.length; i += 2) {\n        urlHash[urlArray[i]] = urlArray[i+1];\n    }\n\n    // Mode\n    if ('1up' == urlHash['mode']) {\n        params.mode = this.constMode1up;\n    } else if ('2up' == urlHash['mode']) {\n        params.mode = this.constMode2up;\n    } else if ('thumb' == urlHash['mode']) {\n        params.mode = this.constModeThumb;\n    }\n\n    // Index and page\n    if ('undefined' != typeof(urlHash['page'])) {\n        // page was set -- may not be int\n        params.page = urlHash['page'];\n    }\n\n    // $$$ process /region\n    // $$$ process /search\n\n    if (urlHash['search'] != undefined) {\n        params.search = BookReader.util.decodeURIComponentPlus(urlHash['search']);\n    }\n\n    // $$$ process /highlight\n\n    // $$$ process /theme\n    if (urlHash['theme'] != undefined) {\n        params.theme = urlHash['theme']\n    }\n    return params;\n};\n\n/**\n * Create a fragment string from the params object.\n *\n * Fragments are formatted as a URL path but may be used outside of URLs as a\n * serialization format for BookReader parameters\n *\n * @see https://openlibrary.org/dev/docs/bookurls for fragment syntax\n *\n * @param {Object} params\n * @return {string}\n */\nBookReader.prototype.fragmentFromParams = function(params) {\n    var separator = '/';\n\n    var fragments = [];\n\n    if ('undefined' != typeof(params.page)) {\n        fragments.push('page', params.page);\n    } else {\n        if ('undefined' != typeof(params.index)) {\n            // Don't have page numbering but we do have the index\n            fragments.push('page', 'n' + params.index);\n        }\n    }\n\n    // $$$ highlight\n    // $$$ region\n\n    // mode\n    if ('undefined' != typeof(params.mode)) {\n        if (params.mode == this.constMode1up) {\n            fragments.push('mode', '1up');\n        } else if (params.mode == this.constMode2up) {\n            fragments.push('mode', '2up');\n        } else if (params.mode == this.constModeThumb) {\n            fragments.push('mode', 'thumb');\n        } else {\n            throw 'fragmentFromParams called with unknown mode ' + params.mode;\n        }\n    }\n\n    // search\n    if (params.search) {\n        fragments.push('search', params.search);\n    }\n\n    return BookReader.util.encodeURIComponentPlus(fragments.join(separator)).replace(/%2F/g, '/');\n};\n\n/**\n * Parses the pageString format\n * @param {string} pageNum\n * @return {number|undefined}\n */\nBookReader.prototype.parsePageString = function(pageNum) {\n    var pageIndex;\n    // Check for special \"leaf\"\n    var re = new RegExp('^leaf(\\\\d+)');\n    var leafMatch = re.exec(pageNum);\n    if (leafMatch) {\n        pageIndex = this.leafNumToIndex(parseInt(leafMatch[1], 10));\n        if (pageIndex === null) {\n            pageIndex = undefined; // to match return type of getPageIndex\n        }\n    } else {\n        pageIndex = this.getPageIndex(pageNum);\n    }\n    return pageIndex;\n}\n\n/**\n * Helper. Flatten the nested structure (make 1d array),\n * and also add pageSide prop\n * @return {array}\n */\nBookReader.prototype._getDataFlattened = function() {\n    if (this._getDataFlattened.cached && this._getDataFlattened.cached[1] === this.data.length)\n        return this._getDataFlattened.cached[0];\n\n    var flattend = [];\n    var prevPageSide = null;\n    for (var i = 0; i < this.data.length; i++) {\n        for (var j = 0; j < this.data[i].length; j++) {\n            if (!this.data[i][j].pageSide) {\n                if (prevPageSide === null) {\n                    this.data[i][j].pageSide = this.data[i].length === 2 ? 'L' : 'R';\n                } else {\n                    this.data[i][j].pageSide = prevPageSide === 'L' ? 'R' : 'L';\n                }\n            }\n            prevPageSide = this.data[i][j].pageSide;\n            flattend.push(this.data[i][j]);\n        }\n    }\n    // length is used as a cache breaker\n    this._getDataFlattened.cached = [flattend, this.data.length];\n    return flattend;\n};\n\n/**\n * Helper. Return a prop for a given index\n * @param {number} index\n * @param {string} prop\n * @return {array}\n */\nBookReader.prototype._getDataProp = function(index, prop) {\n    var dataf = this._getDataFlattened();\n    if (isNaN(index) || index < 0 || index >= dataf.length)\n        return;\n    if ('undefined' == typeof(dataf[index][prop]))\n        return;\n    return dataf[index][prop];\n};\n\n/**\n * Helper to select within instance's elements\n */\nBookReader.prototype.$ = function(selector) {\n    return this.refs.$br.find(selector);\n}\n\n/**\n * Polyfill for deprecated method\n */\njQuery.curCSS = function(element, prop, val) {\n    return jQuery(element).css(prop, val);\n};\n\nreturn BookReader;\n\n})(jQuery);\n","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\n\nvar IS_CONCAT_SPREADABLE_SUPPORT = !fails(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  concat: function concat(arg) { // eslint-disable-line no-unused-vars\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = toLength(E.length);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict';\nvar nativePropertyIsEnumerable = {}.propertyIsEnumerable;\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !nativePropertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.github.io/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : nativePropertyIsEnumerable;\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","var global = require('../internals/global');\nvar nativeFunctionToString = require('../internals/function-to-string');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = typeof WeakMap === 'function' && /native code/.test(nativeFunctionToString.call(WeakMap));\n","var has = require('../internals/has');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!has(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n  }\n};\n","var getBuiltIn = require('../internals/get-built-in');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;\n};\n","module.exports = require('../internals/global');\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toLength = require('../internals/to-length');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","exports.f = Object.getOwnPropertySymbols;\n","var fails = require('../internals/fails');\n\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  // Chrome 38 Symbol has incorrect toString conversion\n  // eslint-disable-next-line no-undef\n  return !String(Symbol());\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $filter = require('../internals/array-iteration').filter;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\n// `Array.prototype.filter` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.filter\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !arrayMethodHasSpeciesSupport('filter') }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  createNonEnumerableProperty(ArrayPrototype, UNSCOPABLES, create(null));\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperties\nmodule.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], Properties[key]);\n  return O;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.github.io/ecma262/#sec-object.keys\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","var $ = require('../internals/export');\nvar from = require('../internals/array-from');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\n\nvar INCORRECT_ITERATION = !checkCorrectnessOfIteration(function (iterable) {\n  Array.from(iterable);\n});\n\n// `Array.from` method\n// https://tc39.github.io/ecma262/#sec-array.from\n$({ target: 'Array', stat: true, forced: INCORRECT_ITERATION }, {\n  from: from\n});\n","'use strict';\nvar bind = require('../internals/bind-context');\nvar toObject = require('../internals/to-object');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\n// `Array.from` method implementation\n// https://tc39.github.io/ecma262/#sec-array.from\nmodule.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n  var O = toObject(arrayLike);\n  var C = typeof this == 'function' ? this : Array;\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  var index = 0;\n  var iteratorMethod = getIteratorMethod(O);\n  var length, result, step, iterator, next;\n  if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined, 2);\n  // if the target is not iterable or it's an array with the default iterator - use a simple case\n  if (iteratorMethod != undefined && !(C == Array && isArrayIteratorMethod(iteratorMethod))) {\n    iterator = iteratorMethod.call(O);\n    next = iterator.next;\n    result = new C();\n    for (;!(step = next.call(iterator)).done; index++) {\n      createProperty(result, index, mapping\n        ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true)\n        : step.value\n      );\n    }\n  } else {\n    length = toLength(O.length);\n    result = new C(length);\n    for (;length > index; index++) {\n      createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);\n    }\n  }\n  result.length = index;\n  return result;\n};\n","var anObject = require('../internals/an-object');\n\n// call something on iterator step with safe closing on error\nmodule.exports = function (iterator, fn, value, ENTRIES) {\n  try {\n    return ENTRIES ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (error) {\n    var returnMethod = iterator['return'];\n    if (returnMethod !== undefined) anObject(returnMethod.call(iterator));\n    throw error;\n  }\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar ArrayPrototype = Array.prototype;\n\n// check on default Array iterator\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayPrototype[ITERATOR] === it);\n};\n","var classof = require('../internals/classof');\nvar Iterators = require('../internals/iterators');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var called = 0;\n  var iteratorWithReturn = {\n    next: function () {\n      return { done: !!called++ };\n    },\n    'return': function () {\n      SAFE_CLOSING = true;\n    }\n  };\n  iteratorWithReturn[ITERATOR] = function () {\n    return this;\n  };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(iteratorWithReturn, function () { throw 2; });\n} catch (error) { /* empty */ }\n\nmodule.exports = function (exec, SKIP_CLOSING) {\n  if (!SKIP_CLOSING && !SAFE_CLOSING) return false;\n  var ITERATION_SUPPORT = false;\n  try {\n    var object = {};\n    object[ITERATOR] = function () {\n      return {\n        next: function () {\n          return { done: ITERATION_SUPPORT = true };\n        }\n      };\n    };\n    exec(object);\n  } catch (error) { /* empty */ }\n  return ITERATION_SUPPORT;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar sloppyArrayMethod = require('../internals/sloppy-array-method');\n\nvar nativeJoin = [].join;\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar SLOPPY_METHOD = sloppyArrayMethod('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || SLOPPY_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin.call(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !method || !fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\n// `Array.prototype.map` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !arrayMethodHasSpeciesSupport('map') }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar isObject = require('../internals/is-object');\nvar isArray = require('../internals/is-array');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toLength = require('../internals/to-length');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar createProperty = require('../internals/create-property');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\nvar nativeSlice = [].slice;\nvar max = Math.max;\n\n// `Array.prototype.slice` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.slice\n// fallback for not array-like ES3 strings and DOM objects\n$({ target: 'Array', proto: true, forced: !arrayMethodHasSpeciesSupport('slice') }, {\n  slice: function slice(start, end) {\n    var O = toIndexedObject(this);\n    var length = toLength(O.length);\n    var k = toAbsoluteIndex(start, length);\n    var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n    // inline `ArraySpeciesCreate` for usage native `Array#slice` where it's possible\n    var Constructor, result, n;\n    if (isArray(O)) {\n      Constructor = O.constructor;\n      // cross-realm fallback\n      if (typeof Constructor == 'function' && (Constructor === Array || isArray(Constructor.prototype))) {\n        Constructor = undefined;\n      } else if (isObject(Constructor)) {\n        Constructor = Constructor[SPECIES];\n        if (Constructor === null) Constructor = undefined;\n      }\n      if (Constructor === Array || Constructor === undefined) {\n        return nativeSlice.call(O, k, fin);\n      }\n    }\n    result = new (Constructor === undefined ? Array : Constructor)(max(fin - k, 0));\n    for (n = 0; k < fin; k++, n++) if (k in O) createProperty(result, n, O[k]);\n    result.length = n;\n    return result;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar toInteger = require('../internals/to-integer');\nvar thisNumberValue = require('../internals/this-number-value');\nvar repeat = require('../internals/string-repeat');\nvar fails = require('../internals/fails');\n\nvar nativeToFixed = 1.0.toFixed;\nvar floor = Math.floor;\n\nvar pow = function (x, n, acc) {\n  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);\n};\n\nvar log = function (x) {\n  var n = 0;\n  var x2 = x;\n  while (x2 >= 4096) {\n    n += 12;\n    x2 /= 4096;\n  }\n  while (x2 >= 2) {\n    n += 1;\n    x2 /= 2;\n  } return n;\n};\n\nvar FORCED = nativeToFixed && (\n  0.00008.toFixed(3) !== '0.000' ||\n  0.9.toFixed(0) !== '1' ||\n  1.255.toFixed(2) !== '1.25' ||\n  1000000000000000128.0.toFixed(0) !== '1000000000000000128'\n) || !fails(function () {\n  // V8 ~ Android 4.3-\n  nativeToFixed.call({});\n});\n\n// `Number.prototype.toFixed` method\n// https://tc39.github.io/ecma262/#sec-number.prototype.tofixed\n$({ target: 'Number', proto: true, forced: FORCED }, {\n  // eslint-disable-next-line max-statements\n  toFixed: function toFixed(fractionDigits) {\n    var number = thisNumberValue(this);\n    var fractDigits = toInteger(fractionDigits);\n    var data = [0, 0, 0, 0, 0, 0];\n    var sign = '';\n    var result = '0';\n    var e, z, j, k;\n\n    var multiply = function (n, c) {\n      var index = -1;\n      var c2 = c;\n      while (++index < 6) {\n        c2 += n * data[index];\n        data[index] = c2 % 1e7;\n        c2 = floor(c2 / 1e7);\n      }\n    };\n\n    var divide = function (n) {\n      var index = 6;\n      var c = 0;\n      while (--index >= 0) {\n        c += data[index];\n        data[index] = floor(c / n);\n        c = (c % n) * 1e7;\n      }\n    };\n\n    var dataToString = function () {\n      var index = 6;\n      var s = '';\n      while (--index >= 0) {\n        if (s !== '' || index === 0 || data[index] !== 0) {\n          var t = String(data[index]);\n          s = s === '' ? t : s + repeat.call('0', 7 - t.length) + t;\n        }\n      } return s;\n    };\n\n    if (fractDigits < 0 || fractDigits > 20) throw RangeError('Incorrect fraction digits');\n    // eslint-disable-next-line no-self-compare\n    if (number != number) return 'NaN';\n    if (number <= -1e21 || number >= 1e21) return String(number);\n    if (number < 0) {\n      sign = '-';\n      number = -number;\n    }\n    if (number > 1e-21) {\n      e = log(number * pow(2, 69, 1)) - 69;\n      z = e < 0 ? number * pow(2, -e, 1) : number / pow(2, e, 1);\n      z *= 0x10000000000000;\n      e = 52 - e;\n      if (e > 0) {\n        multiply(0, z);\n        j = fractDigits;\n        while (j >= 7) {\n          multiply(1e7, 0);\n          j -= 7;\n        }\n        multiply(pow(10, j, 1), 0);\n        j = e - 1;\n        while (j >= 23) {\n          divide(1 << 23);\n          j -= 23;\n        }\n        divide(1 << j);\n        multiply(1, 1);\n        divide(2);\n        result = dataToString();\n      } else {\n        multiply(0, z);\n        multiply(1 << -e, 0);\n        result = dataToString() + repeat.call('0', fractDigits);\n      }\n    }\n    if (fractDigits > 0) {\n      k = result.length;\n      result = sign + (k <= fractDigits\n        ? '0.' + repeat.call('0', fractDigits - k) + result\n        : result.slice(0, k - fractDigits) + '.' + result.slice(k - fractDigits));\n    } else {\n      result = sign + result;\n    } return result;\n  }\n});\n","var classof = require('../internals/classof-raw');\n\n// `thisNumberValue` abstract operation\n// https://tc39.github.io/ecma262/#sec-thisnumbervalue\nmodule.exports = function (value) {\n  if (typeof value != 'number' && classof(value) != 'Number') {\n    throw TypeError('Incorrect invocation');\n  }\n  return +value;\n};\n","'use strict';\nvar toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.repeat` method implementation\n// https://tc39.github.io/ecma262/#sec-string.prototype.repeat\nmodule.exports = ''.repeat || function repeat(count) {\n  var str = String(requireObjectCoercible(this));\n  var result = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError('Wrong number of repetitions');\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) result += str;\n  return result;\n};\n","var redefine = require('../internals/redefine');\nvar toString = require('../internals/object-to-string');\n\nvar ObjectPrototype = Object.prototype;\n\n// `Object.prototype.toString` method\n// https://tc39.github.io/ecma262/#sec-object.prototype.tostring\nif (toString !== ObjectPrototype.toString) {\n  redefine(ObjectPrototype, 'toString', toString, { unsafe: true });\n}\n","'use strict';\nvar classof = require('../internals/classof');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\n// `Object.prototype.toString` method implementation\n// https://tc39.github.io/ecma262/#sec-object.prototype.tostring\nmodule.exports = String(test) !== '[object z]' ? function toString() {\n  return '[object ' + classof(this) + ']';\n} : test.toString;\n","var DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isForced = require('../internals/is-forced');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar defineProperty = require('../internals/object-define-property').f;\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar isRegExp = require('../internals/is-regexp');\nvar getFlags = require('../internals/regexp-flags');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar setSpecies = require('../internals/set-species');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\nvar NativeRegExp = global.RegExp;\nvar RegExpPrototype = NativeRegExp.prototype;\nvar re1 = /a/g;\nvar re2 = /a/g;\n\n// \"new\" should create a new object, old webkit bug\nvar CORRECT_NEW = new NativeRegExp(re1) !== re1;\n\nvar FORCED = DESCRIPTORS && isForced('RegExp', (!CORRECT_NEW || fails(function () {\n  re2[MATCH] = false;\n  // RegExp constructor can alter flags and IsRegExp works correct with @@match\n  return NativeRegExp(re1) != re1 || NativeRegExp(re2) == re2 || NativeRegExp(re1, 'i') != '/a/i';\n})));\n\n// `RegExp` constructor\n// https://tc39.github.io/ecma262/#sec-regexp-constructor\nif (FORCED) {\n  var RegExpWrapper = function RegExp(pattern, flags) {\n    var thisIsRegExp = this instanceof RegExpWrapper;\n    var patternIsRegExp = isRegExp(pattern);\n    var flagsAreUndefined = flags === undefined;\n    return !thisIsRegExp && patternIsRegExp && pattern.constructor === RegExpWrapper && flagsAreUndefined ? pattern\n      : inheritIfRequired(CORRECT_NEW\n        ? new NativeRegExp(patternIsRegExp && !flagsAreUndefined ? pattern.source : pattern, flags)\n        : NativeRegExp((patternIsRegExp = pattern instanceof RegExpWrapper)\n          ? pattern.source\n          : pattern, patternIsRegExp && flagsAreUndefined ? getFlags.call(pattern) : flags)\n      , thisIsRegExp ? this : RegExpPrototype, RegExpWrapper);\n  };\n  var proxy = function (key) {\n    key in RegExpWrapper || defineProperty(RegExpWrapper, key, {\n      configurable: true,\n      get: function () { return NativeRegExp[key]; },\n      set: function (it) { NativeRegExp[key] = it; }\n    });\n  };\n  var keys = getOwnPropertyNames(NativeRegExp);\n  var index = 0;\n  while (keys.length > index) proxy(keys[index++]);\n  RegExpPrototype.constructor = RegExpWrapper;\n  RegExpWrapper.prototype = RegExpPrototype;\n  redefine(global, 'RegExp', RegExpWrapper);\n}\n\n// https://tc39.github.io/ecma262/#sec-get-regexp-@@species\nsetSpecies('RegExp');\n","var isObject = require('../internals/is-object');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// makes subclassing work correct for wrapped built-ins\nmodule.exports = function ($this, dummy, Wrapper) {\n  var NewTarget, NewTargetPrototype;\n  if (\n    // it can work only with native `setPrototypeOf`\n    setPrototypeOf &&\n    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this\n    typeof (NewTarget = dummy.constructor) == 'function' &&\n    NewTarget !== Wrapper &&\n    isObject(NewTargetPrototype = NewTarget.prototype) &&\n    NewTargetPrototype !== Wrapper.prototype\n  ) setPrototypeOf($this, NewTargetPrototype);\n  return $this;\n};\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it) && it !== null) {\n    throw TypeError(\"Can't set \" + String(it) + ' as a prototype');\n  } return it;\n};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar definePropertyModule = require('../internals/object-define-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (CONSTRUCTOR_NAME) {\n  var Constructor = getBuiltIn(CONSTRUCTOR_NAME);\n  var defineProperty = definePropertyModule.f;\n\n  if (DESCRIPTORS && Constructor && !Constructor[SPECIES]) {\n    defineProperty(Constructor, SPECIES, {\n      configurable: true,\n      get: function () { return this; }\n    });\n  }\n};\n","'use strict';\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar fails = require('../internals/fails');\nvar flags = require('../internals/regexp-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar nativeToString = RegExpPrototype[TO_STRING];\n\nvar NOT_GENERIC = fails(function () { return nativeToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = nativeToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.github.io/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var p = String(R.source);\n    var rf = R.flags;\n    var f = String(rf === undefined && R instanceof RegExp && !('flags' in RegExpPrototype) ? flags.call(R) : rf);\n    return '/' + p + '/' + f;\n  }, { unsafe: true });\n}\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// `String.prototype[@@iterator]` method\n// https://tc39.github.io/ecma262/#sec-string.prototype-@@iterator\ndefineIterator(String, 'String', function (iterated) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: String(iterated),\n    index: 0\n  });\n// `%StringIteratorPrototype%.next` method\n// https://tc39.github.io/ecma262/#sec-%stringiteratorprototype%.next\n}, function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: point, done: false };\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\nvar Iterators = require('../internals/iterators');\nvar IteratorsCore = require('../internals/iterators-core');\n\nvar IteratorPrototype = IteratorsCore.IteratorPrototype;\nvar BUGGY_SAFARI_ITERATORS = IteratorsCore.BUGGY_SAFARI_ITERATORS;\nvar ITERATOR = wellKnownSymbol('iterator');\nvar KEYS = 'keys';\nvar VALUES = 'values';\nvar ENTRIES = 'entries';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Iterable, NAME, IteratorConstructor, next, DEFAULT, IS_SET, FORCED) {\n  createIteratorConstructor(IteratorConstructor, NAME, next);\n\n  var getIterationMethod = function (KIND) {\n    if (KIND === DEFAULT && defaultIterator) return defaultIterator;\n    if (!BUGGY_SAFARI_ITERATORS && KIND in IterablePrototype) return IterablePrototype[KIND];\n    switch (KIND) {\n      case KEYS: return function keys() { return new IteratorConstructor(this, KIND); };\n      case VALUES: return function values() { return new IteratorConstructor(this, KIND); };\n      case ENTRIES: return function entries() { return new IteratorConstructor(this, KIND); };\n    } return function () { return new IteratorConstructor(this); };\n  };\n\n  var TO_STRING_TAG = NAME + ' Iterator';\n  var INCORRECT_VALUES_NAME = false;\n  var IterablePrototype = Iterable.prototype;\n  var nativeIterator = IterablePrototype[ITERATOR]\n    || IterablePrototype['@@iterator']\n    || DEFAULT && IterablePrototype[DEFAULT];\n  var defaultIterator = !BUGGY_SAFARI_ITERATORS && nativeIterator || getIterationMethod(DEFAULT);\n  var anyNativeIterator = NAME == 'Array' ? IterablePrototype.entries || nativeIterator : nativeIterator;\n  var CurrentIteratorPrototype, methods, KEY;\n\n  // fix native\n  if (anyNativeIterator) {\n    CurrentIteratorPrototype = getPrototypeOf(anyNativeIterator.call(new Iterable()));\n    if (IteratorPrototype !== Object.prototype && CurrentIteratorPrototype.next) {\n      if (!IS_PURE && getPrototypeOf(CurrentIteratorPrototype) !== IteratorPrototype) {\n        if (setPrototypeOf) {\n          setPrototypeOf(CurrentIteratorPrototype, IteratorPrototype);\n        } else if (typeof CurrentIteratorPrototype[ITERATOR] != 'function') {\n          createNonEnumerableProperty(CurrentIteratorPrototype, ITERATOR, returnThis);\n        }\n      }\n      // Set @@toStringTag to native iterators\n      setToStringTag(CurrentIteratorPrototype, TO_STRING_TAG, true, true);\n      if (IS_PURE) Iterators[TO_STRING_TAG] = returnThis;\n    }\n  }\n\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEFAULT == VALUES && nativeIterator && nativeIterator.name !== VALUES) {\n    INCORRECT_VALUES_NAME = true;\n    defaultIterator = function values() { return nativeIterator.call(this); };\n  }\n\n  // define iterator\n  if ((!IS_PURE || FORCED) && IterablePrototype[ITERATOR] !== defaultIterator) {\n    createNonEnumerableProperty(IterablePrototype, ITERATOR, defaultIterator);\n  }\n  Iterators[NAME] = defaultIterator;\n\n  // export additional methods\n  if (DEFAULT) {\n    methods = {\n      values: getIterationMethod(VALUES),\n      keys: IS_SET ? defaultIterator : getIterationMethod(KEYS),\n      entries: getIterationMethod(ENTRIES)\n    };\n    if (FORCED) for (KEY in methods) {\n      if (BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME || !(KEY in IterablePrototype)) {\n        redefine(IterablePrototype, KEY, methods[KEY]);\n      }\n    } else $({ target: NAME, proto: true, forced: BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME }, methods);\n  }\n\n  return methods;\n};\n","'use strict';\nvar IteratorPrototype = require('../internals/iterators-core').IteratorPrototype;\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar Iterators = require('../internals/iterators');\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (IteratorConstructor, NAME, next) {\n  var TO_STRING_TAG = NAME + ' Iterator';\n  IteratorConstructor.prototype = create(IteratorPrototype, { next: createPropertyDescriptor(1, next) });\n  setToStringTag(IteratorConstructor, TO_STRING_TAG, false, true);\n  Iterators[TO_STRING_TAG] = returnThis;\n  return IteratorConstructor;\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  function F() { /* empty */ }\n  F.prototype.constructor = null;\n  return Object.getPrototypeOf(new F()) !== F.prototype;\n});\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\nvar max = Math.max;\nvar min = Math.min;\nvar floor = Math.floor;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&'`]|\\d\\d?|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&'`]|\\d\\d?)/g;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// @@replace logic\nfixRegExpWellKnownSymbolLogic('replace', 2, function (REPLACE, nativeReplace, maybeCallNative) {\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = requireObjectCoercible(this);\n      var replacer = searchValue == undefined ? undefined : searchValue[REPLACE];\n      return replacer !== undefined\n        ? replacer.call(searchValue, O, replaceValue)\n        : nativeReplace.call(String(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace\n    function (regexp, replaceValue) {\n      var res = maybeCallNative(nativeReplace, regexp, this, replaceValue);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      var functionalReplace = typeof replaceValue === 'function';\n      if (!functionalReplace) replaceValue = String(replaceValue);\n\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n\n        results.push(result);\n        if (!global) break;\n\n        var matchStr = String(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n\n        var matched = String(result[0]);\n        var position = max(min(toInteger(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = [matched].concat(captures, position, S);\n          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n          var replacement = String(replaceValue.apply(undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + S.slice(nextSourcePosition);\n    }\n  ];\n\n  // https://tc39.github.io/ecma262/#sec-getsubstitution\n  function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {\n    var tailPos = position + matched.length;\n    var m = captures.length;\n    var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n    if (namedCaptures !== undefined) {\n      namedCaptures = toObject(namedCaptures);\n      symbols = SUBSTITUTION_SYMBOLS;\n    }\n    return nativeReplace.call(replacement, symbols, function (match, ch) {\n      var capture;\n      switch (ch.charAt(0)) {\n        case '$': return '$';\n        case '&': return matched;\n        case '`': return str.slice(0, position);\n        case \"'\": return str.slice(tailPos);\n        case '<':\n          capture = namedCaptures[ch.slice(1, -1)];\n          break;\n        default: // \\d\\d?\n          var n = +ch;\n          if (n === 0) return match;\n          if (n > m) {\n            var f = floor(n / 10);\n            if (f === 0) return match;\n            if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n            return match;\n          }\n          capture = captures[n - 1];\n      }\n      return capture === undefined ? '' : capture;\n    });\n  }\n});\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar sameValue = require('../internals/same-value');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@search logic\nfixRegExpWellKnownSymbolLogic('search', 1, function (SEARCH, nativeSearch, maybeCallNative) {\n  return [\n    // `String.prototype.search` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.search\n    function search(regexp) {\n      var O = requireObjectCoercible(this);\n      var searcher = regexp == undefined ? undefined : regexp[SEARCH];\n      return searcher !== undefined ? searcher.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));\n    },\n    // `RegExp.prototype[@@search]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@search\n    function (regexp) {\n      var res = maybeCallNative(nativeSearch, regexp, this);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      var previousLastIndex = rx.lastIndex;\n      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;\n      var result = regExpExec(rx, S);\n      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;\n      return result === null ? -1 : result.index;\n    }\n  ];\n});\n","// `SameValue` abstract operation\n// https://tc39.github.io/ecma262/#sec-samevalue\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar isRegExp = require('../internals/is-regexp');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar speciesConstructor = require('../internals/species-constructor');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar toLength = require('../internals/to-length');\nvar callRegExpExec = require('../internals/regexp-exec-abstract');\nvar regexpExec = require('../internals/regexp-exec');\nvar fails = require('../internals/fails');\n\nvar arrayPush = [].push;\nvar min = Math.min;\nvar MAX_UINT32 = 0xFFFFFFFF;\n\n// babel-minify transpiles RegExp('x', 'y') -> /x/y and it causes SyntaxError\nvar SUPPORTS_Y = !fails(function () { return !RegExp(MAX_UINT32, 'y'); });\n\n// @@split logic\nfixRegExpWellKnownSymbolLogic('split', 2, function (SPLIT, nativeSplit, maybeCallNative) {\n  var internalSplit;\n  if (\n    'abbc'.split(/(b)*/)[1] == 'c' ||\n    'test'.split(/(?:)/, -1).length != 4 ||\n    'ab'.split(/(?:ab)*/).length != 2 ||\n    '.'.split(/(.?)(.?)/).length != 4 ||\n    '.'.split(/()()/).length > 1 ||\n    ''.split(/.?/).length\n  ) {\n    // based on es5-shim implementation, need to rework it\n    internalSplit = function (separator, limit) {\n      var string = String(requireObjectCoercible(this));\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (separator === undefined) return [string];\n      // If `separator` is not a regex, use native split\n      if (!isRegExp(separator)) {\n        return nativeSplit.call(string, separator, lim);\n      }\n      var output = [];\n      var flags = (separator.ignoreCase ? 'i' : '') +\n                  (separator.multiline ? 'm' : '') +\n                  (separator.unicode ? 'u' : '') +\n                  (separator.sticky ? 'y' : '');\n      var lastLastIndex = 0;\n      // Make `global` and avoid `lastIndex` issues by working with a copy\n      var separatorCopy = new RegExp(separator.source, flags + 'g');\n      var match, lastIndex, lastLength;\n      while (match = regexpExec.call(separatorCopy, string)) {\n        lastIndex = separatorCopy.lastIndex;\n        if (lastIndex > lastLastIndex) {\n          output.push(string.slice(lastLastIndex, match.index));\n          if (match.length > 1 && match.index < string.length) arrayPush.apply(output, match.slice(1));\n          lastLength = match[0].length;\n          lastLastIndex = lastIndex;\n          if (output.length >= lim) break;\n        }\n        if (separatorCopy.lastIndex === match.index) separatorCopy.lastIndex++; // Avoid an infinite loop\n      }\n      if (lastLastIndex === string.length) {\n        if (lastLength || !separatorCopy.test('')) output.push('');\n      } else output.push(string.slice(lastLastIndex));\n      return output.length > lim ? output.slice(0, lim) : output;\n    };\n  // Chakra, V8\n  } else if ('0'.split(undefined, 0).length) {\n    internalSplit = function (separator, limit) {\n      return separator === undefined && limit === 0 ? [] : nativeSplit.call(this, separator, limit);\n    };\n  } else internalSplit = nativeSplit;\n\n  return [\n    // `String.prototype.split` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.split\n    function split(separator, limit) {\n      var O = requireObjectCoercible(this);\n      var splitter = separator == undefined ? undefined : separator[SPLIT];\n      return splitter !== undefined\n        ? splitter.call(separator, O, limit)\n        : internalSplit.call(String(O), separator, limit);\n    },\n    // `RegExp.prototype[@@split]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@split\n    //\n    // NOTE: This cannot be properly polyfilled in engines that don't support\n    // the 'y' flag.\n    function (regexp, limit) {\n      var res = maybeCallNative(internalSplit, regexp, this, limit, internalSplit !== nativeSplit);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var C = speciesConstructor(rx, RegExp);\n\n      var unicodeMatching = rx.unicode;\n      var flags = (rx.ignoreCase ? 'i' : '') +\n                  (rx.multiline ? 'm' : '') +\n                  (rx.unicode ? 'u' : '') +\n                  (SUPPORTS_Y ? 'y' : 'g');\n\n      // ^(? + rx + ) is needed, in combination with some S slicing, to\n      // simulate the 'y' flag.\n      var splitter = new C(SUPPORTS_Y ? rx : '^(?:' + rx.source + ')', flags);\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];\n      var p = 0;\n      var q = 0;\n      var A = [];\n      while (q < S.length) {\n        splitter.lastIndex = SUPPORTS_Y ? q : 0;\n        var z = callRegExpExec(splitter, SUPPORTS_Y ? S : S.slice(q));\n        var e;\n        if (\n          z === null ||\n          (e = min(toLength(splitter.lastIndex + (SUPPORTS_Y ? 0 : q)), S.length)) === p\n        ) {\n          q = advanceStringIndex(S, q, unicodeMatching);\n        } else {\n          A.push(S.slice(p, q));\n          if (A.length === lim) return A;\n          for (var i = 1; i <= z.length - 1; i++) {\n            A.push(z[i]);\n            if (A.length === lim) return A;\n          }\n          q = p = e;\n        }\n      }\n      A.push(S.slice(p));\n      return A;\n    }\n  ];\n}, !SUPPORTS_Y);\n","var anObject = require('../internals/an-object');\nvar aFunction = require('../internals/a-function');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `SpeciesConstructor` abstract operation\n// https://tc39.github.io/ecma262/#sec-speciesconstructor\nmodule.exports = function (O, defaultConstructor) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? defaultConstructor : aFunction(S);\n};\n"],"sourceRoot":""}