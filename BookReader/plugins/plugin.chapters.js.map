{"version":3,"file":"plugins/plugin.chapters.js","mappings":"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","sources":["webpack://@internetarchive/bookreader/./node_modules/@internetarchive/icon-toc/index.js","webpack://@internetarchive/bookreader/./node_modules/@internetarchive/icon-toc/icon-toc.js","webpack://@internetarchive/bookreader/./src/plugins/plugin.chapters.js","webpack://@internetarchive/bookreader/../src/directives/if-defined.ts"],"sourcesContent":["import { html } from 'lit';\n\nexport default html`\n<svg\n  viewBox=\"0 0 24 24\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  aria-labelledby=\"tocTitleID tocDescID\"\n>\n  <title id=\"tocTitleID\">Table of contents icon</title>\n  <desc id=\"tocDescID\">An illustration of three text list items</desc>\n  <g class=\"fill-color\" fill-rule=\"evenodd\"><rect height=\"3\" rx=\"1.5\" width=\"18\" x=\"6\"/><rect height=\"3\" rx=\"1.5\" width=\"18\" x=\"6\" y=\"21\"/><rect height=\"3\" rx=\"1.5\" width=\"18\" x=\"6\" y=\"14\"/><rect height=\"3\" rx=\"1.5\" width=\"18\" x=\"6\" y=\"7\"/><rect height=\"3\" rx=\"1.5\" width=\"4\"/><rect height=\"3\" rx=\"1.5\" width=\"4\" y=\"21\"/><rect height=\"3\" rx=\"1.5\" width=\"4\" y=\"14\"/><rect height=\"3\" rx=\"1.5\" width=\"4\" y=\"7\"/></g>\n</svg>\n`;\n","import icon from './index.js';\nimport { css, LitElement } from 'lit';\n\nclass IAIconToc extends LitElement {\n  static get styles() {\n    return css`\n      :host {\n        width: var(--iconWidth, 'auto');\n        height: var(--iconHeight, 'auto');\n      }\n\n      .fill-color {\n        fill: var(--iconFillColor);\n      }\n\n      .stroke-color {\n        stroke: var(--iconStrokeColor);\n      }\n    `;\n  }\n\n  render() {\n    return icon;\n  }\n}\n\ncustomElements.define('ia-icon-toc', IAIconToc);\n\nexport default IAIconToc;\n","/* global BookReader */\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property } from 'lit/decorators.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { styleMap } from 'lit/directives/style-map.js';\nimport '@internetarchive/icon-toc/icon-toc';\n/** @typedef {import('@/src/BookNavigator/book-navigator.js').BookNavigator} BookNavigator */\n\n/**\n * Plugin for chapter markers in BookReader. Fetches from openlibrary.org\n * Could be forked, or extended to alter behavior\n */\n\njQuery.extend(BookReader.defaultOptions, {\n  olHost: 'https://openlibrary.org',\n  enableChaptersPlugin: true,\n  bookId: '',\n});\n\n/** @override Extend to call Open Library for TOC */\nBookReader.prototype.init = (function(super_) {\n  return function() {\n    super_.call(this);\n    if (this.options.enableChaptersPlugin && this.ui !== 'embed') {\n      this._chapterInit();\n    }\n  };\n})(BookReader.prototype.init);\n\nBookReader.prototype._chapterInit = async function() {\n  const olEdition = await this.getOpenLibraryRecord(this.options.olHost, this.options.bookId);\n  if (olEdition?.table_of_contents?.length) {\n    this._tocEntries = olEdition.table_of_contents.map(rawTOCEntry => (\n      Object.assign({}, rawTOCEntry, {pageIndex: this.book.getPageIndex(rawTOCEntry.pagenum)})\n    ));\n    this._chaptersRender(this._tocEntries);\n    this.bind(BookReader.eventNames.pageChanged, () => this._chaptersUpdateCurrent());\n  }\n};\n\n/**\n * Update the table of contents based on array of TOC entries.\n */\nBookReader.prototype._chaptersRender = function() {\n  const shell = /** @type {BookNavigator} */(this.shell);\n  shell.menuProviders['chapters'] = {\n    id: 'chapters',\n    icon: html`<ia-icon-toc style=\"width: var(--iconWidth); height: var(--iconHeight);\"></ia-icon-toc>`,\n    label: 'Table of Contents',\n    component: html`<br-chapters-panel\n      .contents=\"${this._tocEntries}\"\n      .jumpToPage=\"${(pageIndex) => {\n      this._chaptersUpdateCurrent(pageIndex);\n      this.jumpToIndex(pageIndex);\n    }}\"\n      @connected=\"${(e) => {\n      this._chaptersPanel = e.target;\n      this._chaptersUpdateCurrent();\n    }}\"\n    />`,\n  };\n  shell.updateMenuContents();\n  for (const tocEntry of this._tocEntries) {\n    this._chaptersRenderMarker(tocEntry);\n  }\n};\n\n/**\n * @typedef {Object} TocEntry\n * Table of contents entry as defined by Open Library, with some extra values for internal use\n * @property {string} pagenum\n * @property {number} level\n * @property {string} label\n * @property {string} title\n * @property {number} pageIndex - Added\n *\n * @example {\n *   \"pagenum\": \"17\",\n *   \"level\": 1,\n *   \"label\": \"CHAPTER I\",\n *   \"title\": \"THE COUNTRY AND THE MISSION\"\n * }\n */\n\n/**\n * @param {TocEntry} tocEntry\n */\nBookReader.prototype._chaptersRenderMarker = function(tocEntry) {\n  if (tocEntry.pageIndex == undefined) return;\n\n  //creates a string with non-void tocEntry.label and tocEntry.title\n  const chapterStr = [tocEntry.label, tocEntry.title]\n    .filter(x => x)\n    .join(' ');\n\n  const percentThrough = BookReader.util.cssPercentage(tocEntry.pageIndex, this.book.getNumLeafs() - 1);\n  $(`<div></div>`)\n    .append(\n      $('<div />')\n        .text(chapterStr)\n        .append($('<div class=\"BRchapterPage\" />').text(`Page ${tocEntry.pagenum}`))\n    )\n    .addClass('BRchapter')\n    .css({ left: percentThrough })\n    .appendTo(this.$('.BRnavline'))\n    .on(\"mouseenter\", event => {\n      // remove hover effect from other markers then turn on just for this\n      const marker = event.currentTarget;\n      const tooltip = marker.querySelector('div');\n      const tooltipOffset = tooltip.getBoundingClientRect();\n      const targetOffset = marker.getBoundingClientRect();\n      const boxSizeAdjust = parseInt(getComputedStyle(tooltip).paddingLeft) * 2;\n      if (tooltipOffset.x - boxSizeAdjust < 0) {\n        tooltip.style.setProperty('transform', `translateX(-${targetOffset.left - boxSizeAdjust}px)`);\n      }\n      this.$('.BRsearch,.BRchapter').removeClass('front');\n      $(event.target).addClass('front');\n    })\n    .on(\"mouseleave\", event => $(event.target).removeClass('front'))\n    .on('click', () => {\n      this._chaptersUpdateCurrent(tocEntry.pageIndex);\n      this.jumpToIndex(tocEntry.pageIndex);\n    });\n\n  this.$('.BRchapter, .BRsearch').each((i, el) => {\n    const $el = $(el);\n    $el\n      .on(\"mouseenter\", () => $el.addClass('front'))\n      .on(\"mouseleave\", () => $el.removeClass('front'));\n  });\n};\n\n/**\n * This makes a call to OL API and calls the given callback function with the\n * response from the API.\n *\n * @param {string} olHost\n * @param {string} ocaid\n */\nBookReader.prototype.getOpenLibraryRecord = async function (olHost, ocaid) {\n  // Try looking up by ocaid first, then by source_record\n  const baseURL = `${olHost}/query.json?type=/type/edition&*=`;\n  const fetchUrlByBookId = `${baseURL}&ocaid=${ocaid}`;\n\n  let data = await $.ajax({ url: fetchUrlByBookId, dataType: 'jsonp' });\n\n  if (!data || !data.length) {\n    // try sourceid\n    data = await $.ajax({ url: `${baseURL}&source_records=ia:${ocaid}`, dataType: 'jsonp' });\n  }\n\n  return data?.[0];\n};\n\n/**\n * @private\n * Highlights the current chapter based on current page\n * @param {PageIndex} curIndex\n */\nBookReader.prototype._chaptersUpdateCurrent = function(\n  curIndex = (this.mode == 2 ? Math.max(...this.displayedIndices) : this.firstIndex)\n) {\n  const tocEntriesIndexed = this._tocEntries.filter((el) => el.pageIndex != undefined).reverse();\n  const currChapter = tocEntriesIndexed[\n    // subtract one so that 2up shows the right label\n    tocEntriesIndexed.findIndex((chapter) => chapter.pageIndex <= curIndex)\n  ];\n  if (this._chaptersPanel) {\n    this._chaptersPanel.currentChapter = currChapter;\n  }\n};\n\n@customElement('br-chapters-panel')\nexport class BRChaptersPanel extends LitElement {\n  /** @type {TocEntry[]} */\n  @property({ type: Array })\n  contents = [];\n\n  /** @type {TocEntry?} */\n  @property({ type: Object })\n  currentChapter = {};\n\n  /** @type {(pageIndex: PageIndex) => void} */\n  jumpToPage = () => {};\n\n  /**\n   * @param {TocEntry[]} contents\n   */\n  constructor(contents) {\n    super();\n    this.contents = contents;\n  }\n\n  render() {\n    return html`\n    <ol>\n      ${this.contents.map(tocEntry => this.renderTOCEntry(tocEntry))}\n    </ol>\n    `;\n  }\n\n  /**\n   * @param {TocEntry} tocEntry\n   */\n  renderTOCEntry(tocEntry) {\n    const chapterTitle = [tocEntry.label, tocEntry.title]\n      .filter(x => x)\n      .join(' ');\n    const clickable = tocEntry.pageIndex != undefined;\n    // note the click-tracking won't work...\n    return html`\n    <li\n      class=\"\n        BRtable-contents-el\n        ${clickable ? 'clickable' : ''}\n        ${tocEntry == this.currentChapter ? 'current' : ''}\n      \"\n      style=\"${styleMap({marginLeft: (tocEntry.level - 1) * 10 + 'px'})}\"\n      data-event-click-tracking=\"${ifDefined(clickable ? \"BRTOCPanel|GoToChapter\" : undefined)}\"\n      @click=\"${() => this.jumpToPage(tocEntry.pageIndex)}\"\n    >\n      ${chapterTitle}\n      ${tocEntry.pagenum ? html`\n        <br />\n        <span class=\"BRTOCElementPage\">Page ${tocEntry.pagenum}</span>\n      ` : nothing}\n    </li>`;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.dispatchEvent(new CustomEvent('connected'));\n  }\n\n  updated(changedProperties) {\n    if (changedProperties.has('currentChapter')) {\n      this.shadowRoot.querySelector('li.current')?.scrollIntoView({\n        block: 'nearest',\n        behavior: 'smooth',\n      });\n    }\n  }\n\n  static get styles() {\n    return css`\n      ol {\n        padding: 0;\n        margin: 0;\n        margin-right: 5px;\n      }\n      li {\n        padding: 10px;\n        overflow: hidden;\n        border-radius: 4px;\n      }\n      li.clickable {\n        font-weight: normal;\n        cursor: pointer;\n        transition: background-color 0.2s;\n      }\n\n      li.clickable:not(.current):hover {\n        background-color: rgba(255,255,255, 0.05);\n      }\n\n      li.current {\n        background-color: rgba(255,255,255,0.9);\n        color: #333;\n      }\n\n      .BRTOCElementPage {\n        font-size: 0.85em;\n        opacity: .8;\n      }`;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\nimport {nothing} from '../lit-html.js';\n\n/**\n * For AttributeParts, sets the attribute if the value is defined and removes\n * the attribute if the value is undefined.\n *\n * For other part types, this directive is a no-op.\n */\nexport const ifDefined = <T>(value: T) => value ?? nothing;\n"],"names":["IAIconToc","styles","render","customElements","define","super_","_regeneratorRuntime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","_typeof","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","undefined","done","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","methodName","return","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","doneResult","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","jQuery","extend","BookReader","defaultOptions","olHost","enableChaptersPlugin","bookId","init","this","options","ui","_chapterInit","_callee","_olEdition$table_of_c","olEdition","_this","_context","getOpenLibraryRecord","table_of_contents","_tocEntries","map","rawTOCEntry","assign","pageIndex","book","getPageIndex","pagenum","_chaptersRender","bind","eventNames","pageChanged","_chaptersUpdateCurrent","_this2","shell","menuProviders","id","icon","html","_templateObject","_taggedTemplateLiteral","label","component","_templateObject2","jumpToIndex","e","_chaptersPanel","target","updateMenuContents","_step","_iterator","_createForOfIteratorHelper","s","n","tocEntry","_chaptersRenderMarker","f","_this3","chapterStr","title","filter","x","join","percentThrough","util","cssPercentage","getNumLeafs","$","append","text","concat","addClass","css","left","appendTo","on","event","marker","currentTarget","tooltip","querySelector","tooltipOffset","getBoundingClientRect","targetOffset","boxSizeAdjust","parseInt","getComputedStyle","paddingLeft","style","setProperty","removeClass","each","el","$el","_ref2","_callee2","ocaid","_data","baseURL","fetchUrlByBookId","data","_context2","ajax","url","dataType","_x","_x2","curIndex","mode","Math","max","displayedIndices","firstIndex","tocEntriesIndexed","currChapter","findIndex","chapter","currentChapter","_decorate","customElement","_initialize","_LitElement","BRChaptersPanel","_LitElement2","_inherits","_super","contents","_this4","_classCallCheck","_assertThisInitialized","F","d","kind","decorators","property","Array","_this5","_templateObject3","renderTOCEntry","l","_this6","chapterTitle","clickable","_templateObject4","styleMap","marginLeft","level","t","jumpToPage","_templateObject5","nothing","_get","_getPrototypeOf","dispatchEvent","CustomEvent","changedProperties","_this$shadowRoot$quer","has","shadowRoot","scrollIntoView","block","behavior","static","_templateObject6","LitElement"],"sourceRoot":""}