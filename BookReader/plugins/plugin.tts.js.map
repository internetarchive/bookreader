{"version":3,"sources":["webpack://@internetarchive/bookreader/./src/js/plugins/tts/PageChunk.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/PageChunkIterator.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/AbstractTTSEngine.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/utils.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/FestivalTTSEngine.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/plugin.tts.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/WebTTSEngine.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/tooltip_dict.js","webpack://@internetarchive/bookreader/./src/util/browserSniffing.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/engine-is-ios.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/function-bind.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/host-report-errors.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/iterate.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/microtask.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/native-promise-constructor.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/new-promise-capability.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/perform.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/promise-resolve.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/set-species.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/task.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.object.get-own-property-descriptor.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.object.get-prototype-of.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.promise.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.reflect.construct.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.reflect.get.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.match.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.starts-with.js","webpack://@internetarchive/bookreader/./node_modules/iso-language-codes/js/data.js"],"names":["PageChunk","leafIndex","chunkIndex","text","lineRects","this","server","bookPath","Promise","res","rej","$","ajax","type","url","dataType","cache","data","path","page","error","then","chunks","_fromTextWrapperResponse","chunksResponse","map","c","i","correctedLineRects","_fixChunkRects","slice","correctedText","_removeDanglingHyphens","rects","length","firstRect","secondRect","left","bottom","width","secondHeight","secondWidth","secondRight","replace","PageChunkIterator","pageCount","start","opts","Object","assign","DEFAULT_OPTS","_cursor","chunk","_bufferedPages","_bufferingPages","_cursorLock","resolve","_nextUncontrolled","_decrementUncontrolled","AT_END","_recenterBuffer","_fetchPageChunks","cursorChangePromise","prevPageChunks","index","Math","max","pageBufferSize","end","min","_removePageFromBuffer","_fetchPageChunksDirect","AbstractTTSEngine","options","playing","paused","_chunkIterator","activeSound","playbackRate","events","voice","on","getBestBookVoice","getVoices","bookLanguage","trigger","Error","voices","userLanguages","navigator","languages","bookLangVoices","filter","v","lang","startsWith","matchingUserLangs","language","getMatchingVoice","find","default","matchingVoices","numLeafs","onLoadingStart","step","stop","fireEvent","pause","resume","finish","all","decrement","newRate","setPlaybackRate","next","onDone","sound","createSound","rate","load","onLoadingComplete","beforeChunkPlay","playPromise","playSound","afterChunkPlay","loaded","play","promisifyEvent","target","eventType","addEventListener","resolver","ev","removeEventListener","sleep","ms","setTimeout","isAndroid","userAgent","test","COLUMN_TO_LANG_INDEX","searchForISO6391","columnsToSearch","langs","colI","column","split","x","toLowerCase","indexOf","FestivalTTSEngine","audioFormat","browser","mozilla","soundManager","supported","localService","name","voiceURI","setup","debugMode","preferFlash","useHTML5Audio","flashVersion","promise","match","iOSCaptureUserIntentHack","FestivalTTSSound","getSoundUrl","dataString","encodeURIComponent","SILENCE_1MS","onfinish","destruct","soundUrl","_finishResolver","onload","onresume","mp3","ogg","super_","WebTTSEngine","speechSynthesis","window","audio","Audio","SILENCE_6S_MP3","loop","src","mediaSession","metadata","MediaMetadata","title","br","bookTitle","artist","m","label","value","artwork","thumbnail","setActionHandler","jumpBackward","jumpForward","WebTTSSound","started","stopped","utterance","_lastEvents","boundary","_charIndex","_finishPromise","SpeechSynthesisUtterance","location","toString","console","log","dispatchEvent","CustomEvent","wasPaused","recentEvent","charIndex","cancel","speak","isLocalVoice","isChrome","_chromePausingBugFix","endPromise","race","Event","pausePromise","pauseMightNotWork","isFirefox","timeoutPromise","result","resumeMightNotWork","resumeMightNotFire","resumePromise","reload","en","jQuery","extend","BookReader","defaultOptions","enableTtsPlugin","prototype","call","ttsHilites","TTSEngine","engineName","festival","web","ttsEngine","showProgressPopup","bind","removeProgressPopup","ttsStop","ttsBeforeChunkPlay","ttsSendChunkFinishedAnalyticsEvent","init","eventNames","fragmentChange","mode","constMode2up","visibleSelector","twoPage","currentIndexL","currentIndexR","join","show","not","hide","PostInit","click","ttsToggle","refs","$BRReadAloudToolbar","addClass","buildMobileDrawerElement","$el","after","imagesBaseURL","initNavbar","prepend","ttsUpdateState","ttsPlayPause","ttsJumpForward","ttsJumpBackward","$rateSelector","change","parseFloat","val","tooltips","insertBefore","closest","autoStop","ttsStart","constModeThumb","switchMode","constMode1up","ttsSendAnalyticsEvent","currentIndex","getNumLeafs","isPlaying","toggleClass","togglePlayPause","removeClass","ttsRemoveHilites","ttsMaybeFlipToIndex","ttsHighlightChunk","ttsScrollToChunk","in2PageMode","animationFinishedCallback","prev","jumpToIndex","ttsHilite2UP","ttsHilite1UP","leafTop","parseInt","_getPageHeight","reduce","padding","chunkTop","chunkBot","topOfFirstChunk","botOfLastChunk","containerTop","$brContainer","prop","containerBot","height","animate","scrollTop","l","b","r","t","div","document","createElement","push","appendTo","css","top","$brTwoPageView","setHilightCss2UP","remove","action","archiveAnalyticsSendEvent","extraValues","mediaLanguage","vendor","isSafari","module","exports","aFunction","isObject","factories","construct","C","argsLength","args","list","Function","that","fn","partArgs","arguments","boundFunction","concat","apply","global","a","anObject","isArrayIteratorMethod","toLength","getIteratorMethod","callWithSafeIterationClosing","Result","iterable","AS_ENTRIES","IS_ITERATOR","iterator","iterFn","TypeError","done","flush","head","last","notify","toggle","node","getOwnPropertyDescriptor","classof","macrotask","IS_IOS","MutationObserver","WebKitMutationObserver","process","IS_NODE","queueMicrotaskDescriptor","queueMicrotask","parent","domain","exit","undefined","enter","nextTick","createTextNode","observe","characterData","task","PromiseCapability","reject","$$resolve","$$reject","f","exec","newPromiseCapability","constructor","promiseCapability","getBuiltIn","definePropertyModule","wellKnownSymbol","DESCRIPTORS","SPECIES","CONSTRUCTOR_NAME","Constructor","defineProperty","configurable","get","defer","channel","port","fails","html","set","setImmediate","clear","clearImmediate","MessageChannel","Dispatch","counter","queue","run","id","hasOwnProperty","runner","listener","event","post","postMessage","protocol","host","now","port2","port1","onmessage","importScripts","appendChild","removeChild","toIndexedObject","nativeGetOwnPropertyDescriptor","FAILS_ON_PRIMITIVES","stat","forced","sham","it","key","toObject","nativeGetPrototypeOf","CORRECT_PROTOTYPE_GETTER","getPrototypeOf","Internal","OwnPromiseCapability","PromiseWrapper","nativeThen","IS_PURE","NativePromise","redefine","redefineAll","setToStringTag","setSpecies","anInstance","inspectSource","iterate","checkCorrectnessOfIteration","speciesConstructor","microtask","promiseResolve","hostReportErrors","newPromiseCapabilityModule","perform","InternalStateModule","isForced","V8_VERSION","PROMISE","getInternalState","setInternalState","getInternalPromiseState","getterFor","PromiseConstructor","$fetch","newGenericPromiseCapability","DISPATCH_EVENT","createEvent","UNHANDLED_REJECTION","FORCED","String","PromiseRejectionEvent","FakePromise","INCORRECT_ITERATION","isThenable","state","isReject","notified","chain","reactions","ok","exited","reaction","handler","fail","rejection","onHandleUnhandled","onUnhandled","reason","initEvent","isUnhandled","emit","unwrap","internalReject","internalResolve","wrapper","executor","onFulfilled","onRejected","unsafe","enumerable","fetch","input","wrap","capability","$promiseResolve","values","remaining","alreadyCalled","create","nativeConstruct","NEW_TARGET_BUG","F","ARGS_BUG","Target","newTarget","$args","proto","instance","has","getOwnPropertyDescriptorModule","propertyKey","descriptor","receiver","fixRegExpWellKnownSymbolLogic","requireObjectCoercible","advanceStringIndex","regExpExec","MATCH","nativeMatch","maybeCallNative","regexp","O","matcher","RegExp","rx","S","fullUnicode","unicode","lastIndex","A","n","matchStr","notARegExp","correctIsRegExpLogic","nativeStartsWith","CORRECT_IS_REGEXP_LOGIC","writable","searchString","search"],"mappings":"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","file":"plugins/plugin.tts.js","sourcesContent":["/**\n * Class to manage a 'chunk' (approximately a paragraph) of text on a page.\n */\nexport default class PageChunk {\n  /**\n   * @param {number} leafIndex\n   * @param {number} chunkIndex\n   * @param {string} text\n   * @param {DJVURect[]} lineRects\n   */\n  constructor(leafIndex, chunkIndex, text, lineRects) {\n    this.leafIndex = leafIndex;\n    this.chunkIndex = chunkIndex;\n    this.text = text;\n    this.lineRects = lineRects;\n  }\n\n  /**\n   * @param {string} server\n   * @param {string} bookPath\n   * @param {number} leafIndex\n   * @return {Promise<PageChunk[]>}\n   */\n  static fetch(server, bookPath, leafIndex) {\n    // jquery's ajax \"PromiseLike\" implementation is inconsistent with\n    // modern Promises, so convert it to a full promise (it doesn't forward\n    // a returned promise to the next handler in the chain, which kind of\n    // defeats the entire point of using promises to avoid \"callback hell\")\n    return new Promise((res, rej) => {\n      $.ajax({\n        type: 'GET',\n        url: `https://${server}/BookReader/BookReaderGetTextWrapper.php`,\n        dataType:'jsonp',\n        cache: true,\n        data: {\n          path: `${bookPath}_djvu.xml`,\n          page: leafIndex\n        },\n        error: rej,\n      })\n        .then(chunks => {\n          res(PageChunk._fromTextWrapperResponse(leafIndex, chunks));\n        });\n    });\n  }\n\n  /**\n   * Convert the response from BookReaderGetTextWrapper.php into a {@link PageChunk} instance\n   * @param {number} leafIndex\n   * @param {Array<[String, ...DJVURect[]]>} chunksResponse\n   * @return {PageChunk[]}\n   */\n  static _fromTextWrapperResponse(leafIndex, chunksResponse) {\n    return chunksResponse.map((c, i) => {\n      const correctedLineRects = PageChunk._fixChunkRects(c.slice(1));\n      const correctedText = PageChunk._removeDanglingHyphens(c[0]);\n      return new PageChunk(leafIndex, i, correctedText, correctedLineRects);\n    });\n  }\n\n  /**\n   * @private\n   * Sometimes the first rectangle will be ridiculously wide/tall. Find those and fix them\n   * *NOTE*: Modifies the original array and returns it.\n   * *NOTE*: This should probably be fixed on the petabox side, and then removed here\n   * Has 2 problems:\n   *  - If the rect is the last rect on the page (and hence the only rect in the array),\n   *    the rect's size isn't fixed\n   * - Because this relies on the second rect, there's a chance it won't be the right\n   *   width\n   * @param {DJVURect[]} rects\n   * @return {DJVURect[]}\n   */\n  static _fixChunkRects(rects) {\n    if (rects.length < 2) return rects;\n\n    const [firstRect, secondRect] = rects;\n    const [left, bottom, right] = firstRect;\n    const width = right - left;\n    const secondHeight = secondRect[1] - secondRect[3];\n    const secondWidth = secondRect[2] - secondRect[0];\n    const secondRight = secondRect[2];\n\n    if (width > secondWidth * 30) {\n      // Set the end to be the same\n      firstRect[2] = secondRight;\n      // And the top to be the same height\n      firstRect[3] = bottom - secondHeight;\n    }\n\n    return rects;\n  }\n\n  /**\n   * Remove \"dangling\" hyphens from read aloud text to avoid TTS stuttering\n   * @param {string} text\n   * @return {string}\n   */\n  static _removeDanglingHyphens(text) {\n    return text.replace(/-\\s+/g, '');\n  }\n}\n\n/**\n * @typedef {[number, number, number, number]} DJVURect\n * coords are in l,b,r,t order\n */\n","import PageChunk from './PageChunk.js';\n\n/**\n * Class that iterates over the page chunks of a book; caching/buffering\n * as much as possible to try to ensure a smooth experience.\n */\nexport default class PageChunkIterator {\n  /**\n   * @param {number} pageCount total number of pages\n   * @param {number} start page to start on\n   * @param {PageChunkIteratorOptions} opts\n   */\n  constructor(pageCount, start, opts) {\n    this.pageCount = pageCount;\n    this.opts = Object.assign({}, DEFAULT_OPTS, opts);\n    /** Position in the chunk sequence */\n    this._cursor = { page: start, chunk: 0 };\n    /** @type {Object<number, PageChunk[]>} leaf index -> chunks*/\n    this._bufferedPages = {};\n    /** @type {Object<number, PromiseLike<PageChunk[]>} leaf index -> chunks*/\n    this._bufferingPages = {};\n    /**\n     * @type {Promise} promise that manages cursor modifications so that they\n     * happen in order triggered as opposed to order the server responds\n     **/\n    this._cursorLock = Promise.resolve();\n  }\n\n  /**\n   * Get the next chunk\n   * @return {PromiseLike<\"__PageChunkIterator.AT_END__\" | PageChunk>}\n   */\n  next() {\n    return this._cursorLock = this._cursorLock\n      .then(() => this._nextUncontrolled());\n  }\n\n  /**\n   * Sends the cursor back 1\n   * @return {Promise}\n   **/\n  decrement() {\n    return this._cursorLock = this._cursorLock\n      .then(() => this._decrementUncontrolled());\n  }\n\n  /**\n   * Gets without ensuring synchronization. Since this iterator has a lot of async\n   * code, calling e.g. \"next\" twice (before the first call to next has finished)\n   * would cause the system to be in a weird state. To avoid that, we make sure calls\n   * to next and decrement (functions that modify the cursor) are synchronized,\n   * so that regardless how long it takes for one to respond, they'll always be executed\n   * in the correct order.\n   * @return {PromiseLike<\"__PageChunkIterator.AT_END__\" | PageChunk>}\n   */\n  _nextUncontrolled() {\n    if (this._cursor.page == this.pageCount) {\n      return Promise.resolve(PageChunkIterator.AT_END);\n    }\n\n    this._recenterBuffer(this._cursor.page);\n\n    return this._fetchPageChunks(this._cursor.page)\n      .then(chunks => {\n        if (this._cursor.chunk == chunks.length) {\n          this._cursor.page++;\n          this._cursor.chunk = 0;\n          return this._nextUncontrolled();\n        }\n        return chunks[this._cursor.chunk++];\n      });\n  }\n\n  /**\n   * Decrements without ensuring synchronization. (See {@link PageChunkIterator._nextUncontrolled});\n   * @return {Promise}\n   */\n  _decrementUncontrolled() {\n    let cursorChangePromise = Promise.resolve();\n\n    if (this._cursor.chunk > 0) {\n      this._cursor.chunk--;\n    } else if (this._cursor.page > 0) {\n      this._cursor.page--;\n      // Go back possibly multiple pages, because pages can be blank\n      cursorChangePromise = this._fetchPageChunks(this._cursor.page)\n        .then(prevPageChunks => {\n          if (prevPageChunks.length == 0) return this._decrementUncontrolled();\n          else this._cursor.chunk = prevPageChunks.length - 1;\n        });\n    }\n\n    return cursorChangePromise\n      .then(() => this._fetchPageChunks(this._cursor.page));\n  }\n\n  /**\n   * Recenter the buffer around the provided page index\n   * @param {number} index\n   */\n  _recenterBuffer(index) {\n    const start = Math.max(0, index - this.opts.pageBufferSize);\n    const end = Math.min(this.pageCount, index + this.opts.pageBufferSize + 1);\n    for (let i = start; i < end; i++) {\n      this._fetchPageChunks(i);\n    }\n\n    this._removePageFromBuffer(start - 1);\n    this._removePageFromBuffer(end + 1);\n  }\n\n  /**\n   * @param {number} index\n   */\n  _removePageFromBuffer(index) {\n    delete this._bufferingPages[index];\n    delete this._bufferedPages[index];\n  }\n\n  /**\n   * Fetches the chunks on a page; checks the buffer, so it won't make unnecessary\n   * requests if it's called multiple times for the same index.\n   * @param {number} index\n   * @return {Promise<PageChunk[]>}\n   */\n  _fetchPageChunks(index) {\n    if (index in this._bufferingPages) return this._bufferingPages[index];\n    if (index in this._bufferedPages) return Promise.resolve(this._bufferedPages[index]);\n\n    this._bufferingPages[index] = this._fetchPageChunksDirect(index)\n      .then(chunks => {\n        delete this._bufferingPages[index];\n        this._bufferedPages[index] = chunks;\n        return chunks;\n      });\n\n    return this._bufferingPages[index];\n  }\n\n  /**\n   * Fetches a page without checking buffer\n   * @param {number} index\n   */\n  _fetchPageChunksDirect(index) {\n    return PageChunk.fetch(this.opts.server, this.opts.bookPath, index);\n  }\n}\n\nPageChunkIterator.AT_END = \"__PageChunkIterator.AT_END__\";\n\n/** @type {PageChunkIteratorOptions} */\nconst DEFAULT_OPTS = {\n  server: null,\n  bookPath: null,\n  pageBufferSize: 2,\n};\n\n/**\n * @typedef {Object} PageChunkIteratorOptions\n * @property {string} server\n * @property {string} bookPath\n * @property {number} [pageBufferSize] number of pages to buffer before/after the current page\n */\n","import PageChunkIterator from './PageChunkIterator.js';\n/** @typedef {import('./utils.js').ISO6391} ISO6391 */\n/** @typedef {import('./PageChunk.js')} PageChunk */\n\n/**\n * @export\n * @typedef {Object} TTSEngineOptions\n * @property {String} server\n * @property {String} bookPath\n * @property {ISO6391} bookLanguage\n * @property {Function} onLoadingStart\n * @property {Function} onLoadingComplete\n * @property {Function} onDone called when the entire book is done\n * @property {function(PageChunk): PromiseLike} beforeChunkPlay will delay the playing of the chunk\n * @property {function(PageChunk): void} afterChunkPlay fires once a chunk has fully finished\n */\n\n/**\n * @typedef {Object} AbstractTTSSound\n * @property {PageChunk} chunk\n * @property {boolean} loaded\n * @property {number} rate\n * @property {SpeechSynthesisVoice} voice\n * @property {(callback: Function) => void} load\n * @property {() => PromiseLike} play\n * @property {() => Promise} stop\n * @property {() => void} pause\n * @property {() => void} resume\n * @property {() => void} finish force the sound to 'finish'\n * @property {number => void} setPlaybackRate\n **/\n\n/** Handling bookreader's text-to-speech */\nexport default class AbstractTTSEngine {\n  /**\n   * @protected\n   * @param {TTSEngineOptions} options\n   */\n  constructor(options) {\n    this.playing = false;\n    this.paused = false;\n    this.opts = options;\n    /** @type {PageChunkIterator} */\n    this._chunkIterator = null;\n    /** @type {AbstractTTSSound} */\n    this.activeSound = null;\n    this.playbackRate = 1;\n    /** Events we can bind to */\n    this.events = $({});\n    /** @type {SpeechSynthesisVoice} */\n    this.voice = null;\n    // Listen for voice changes (fired by subclasses)\n    this.events.on('voiceschanged', () => {\n      this.voice = AbstractTTSEngine.getBestBookVoice(this.getVoices(), this.opts.bookLanguage);\n    });\n    this.events.trigger('voiceschanged');\n  }\n\n  /**\n   * @abstract\n   * @return {boolean}\n   */\n  static isSupported() { throw new Error(\"Unimplemented abstract class\"); }\n\n  /**\n   * @abstract\n   * @return {SpeechSynthesisVoice[]}\n   */\n  getVoices() { throw new Error(\"Unimplemented abstract class\"); }\n\n  /** @abstract */\n  init() { return null; }\n\n  /**\n   * @param {number} leafIndex\n   * @param {number} numLeafs total number of leafs in the current book\n   */\n  start(leafIndex, numLeafs) {\n    this.playing = true;\n    this.opts.onLoadingStart();\n\n    this._chunkIterator = new PageChunkIterator(numLeafs, leafIndex, {\n      server: this.opts.server,\n      bookPath: this.opts.bookPath,\n      pageBufferSize: 5,\n    });\n\n    this.step();\n    this.events.trigger('start');\n  }\n\n  stop() {\n    if (this.activeSound) this.activeSound.stop();\n    this.playing = false;\n    this._chunkIterator = null;\n    this.activeSound = null;\n    this.events.trigger('stop');\n  }\n\n  /** @public */\n  pause() {\n    const fireEvent = !this.paused && this.activeSound;\n    this.paused = true;\n    if (this.activeSound) this.activeSound.pause();\n    if (fireEvent) this.events.trigger('pause');\n  }\n\n  /** @public */\n  resume() {\n    const fireEvent = this.paused && this.activeSound;\n    this.paused = false;\n    if (this.activeSound) this.activeSound.resume();\n    if (fireEvent) this.events.trigger('resume');\n  }\n\n  togglePlayPause() {\n    if (this.paused) this.resume();\n    else this.pause();\n  }\n\n  /** @public */\n  jumpForward() {\n    if (this.activeSound) this.activeSound.finish();\n  }\n\n  /** @public */\n  jumpBackward() {\n    Promise.all([\n      this.activeSound.stop(),\n      this._chunkIterator.decrement()\n        .then(() => this._chunkIterator.decrement())\n    ])\n      .then(() => this.step());\n  }\n\n  /** @param {number} newRate */\n  setPlaybackRate(newRate) {\n    this.playbackRate = newRate;\n    if (this.activeSound) this.activeSound.setPlaybackRate(newRate);\n  }\n\n  /** @private */\n  step() {\n    this._chunkIterator.next()\n      .then(chunk => {\n        if (chunk == PageChunkIterator.AT_END) {\n          this.stop();\n          this.opts.onDone();\n          return;\n        }\n\n        this.opts.onLoadingStart();\n        const sound = this.createSound(chunk);\n        sound.chunk = chunk;\n        sound.rate = this.playbackRate;\n        sound.voice = this.voice;\n        sound.load(() => this.opts.onLoadingComplete());\n\n        this.opts.onLoadingComplete();\n        return this.opts.beforeChunkPlay(chunk).then(() => sound);\n      })\n      .then(sound => {\n        if (!this.playing) return;\n\n        const playPromise = this.playSound(sound)\n          .then(() => this.opts.afterChunkPlay(sound.chunk));\n        if (this.paused) this.pause();\n        return playPromise;\n      })\n      .then(() => {\n        if (this.playing) return this.step();\n      });\n  }\n\n  /**\n   * @abstract\n   * @param {PageChunk} chunk\n   * @return {AbstractTTSSound}\n   */\n  createSound(chunk) { throw new Error(\"Unimplemented abstract class\"); }\n\n  /**\n   * @param {AbstractTTSSound} sound\n   * @return {PromiseLike} promise called once playing finished\n   */\n  playSound(sound) {\n    this.activeSound = sound;\n    if (!this.activeSound.loaded) this.opts.onLoadingStart();\n    return this.activeSound.play();\n  }\n\n  /** Convenience wrapper for {@see AbstractTTSEngine.getBestVoice} */\n  getBestVoice() {\n    return AbstractTTSEngine.getBestBookVoice(this.getVoices(), this.opts.bookLanguage);\n  }\n\n  /**\n   * @private\n   * Find the best voice to use given the available voices, the book language, and the user's\n   * languages.\n   * @param {SpeechSynthesisVoice[]} voices\n   * @param {ISO6391} bookLanguage\n   * @param {string[]} userLanguages languages in BCP47 format (e.g. en-US). Ordered by preference.\n   * @return {SpeechSynthesisVoice | undefined}\n   */\n  static getBestBookVoice(voices, bookLanguage, userLanguages = navigator.languages) {\n    const bookLangVoices = voices.filter(v => v.lang.startsWith(bookLanguage));\n    // navigator.languages browser support isn't great yet, so get just 1 langauge otherwise\n    // Sample navigator.languages: [\"en-CA\", \"fr-CA\", \"fr\", \"en-US\", \"en\", \"de-DE\", \"de\"]\n    userLanguages = userLanguages || (navigator.language ? [navigator.language] : []);\n\n    // user languages that match the book language\n    const matchingUserLangs = userLanguages.filter(lang => lang.startsWith(bookLanguage));\n\n    // Try to find voices that intersect these two sets\n    return AbstractTTSEngine.getMatchingVoice(matchingUserLangs, bookLangVoices) ||\n        // no user languages match the books; let's return the best voice for the book language\n        (bookLangVoices.find(v => v.default) || bookLangVoices[0])\n        // No voices match the book language? let's find a voice in the user's langauge\n        // and ignore book lang\n        || AbstractTTSEngine.getMatchingVoice(userLanguages, voices)\n        // C'mon! Ok, just read with whatever we got!\n        || (voices.find(v => v.default) || voices[0]);\n  }\n\n  /**\n     * @private\n     * Get the best voice that matches one of the BCP47 languages (order by preference)\n     * @param {string[]} languages in BCP 47 format (e.g. 'en-US', or 'en'); ordered by preference\n     * @param {SpeechSynthesisVoice[]} voices voices to choose from\n     * @return {SpeechSynthesisVoice | undefined}\n     */\n  static getMatchingVoice(languages, voices) {\n    for (const lang of languages) {\n      // Chrome Android was returning voice languages like `en_US` instead of `en-US`\n      const matchingVoices = voices.filter(v => v.lang.replace('_', '-').startsWith(lang));\n      if (matchingVoices.length) {\n        return matchingVoices.find(v => v.default) || matchingVoices[0];\n      }\n    }\n  }\n}\n","import langs from 'iso-language-codes/js/data.js';\n\n/**\n * Convert a EventTarget style event into a promise\n * @param {EventTarget} target\n * @param {string} eventType\n * @return {Promise<Event>}\n */\nexport function promisifyEvent(target, eventType) {\n  return new Promise(res => {\n    const resolver = ev => {\n      target.removeEventListener(eventType, resolver);\n      res(ev);\n    };\n    target.addEventListener(eventType, resolver);\n  });\n}\n\n/**\n * Use regex to approximate word count in a string\n * @param {string} text\n * @return {number}\n */\nexport function approximateWordCount(text) {\n  const m = text.match(/\\S+/g);\n  return m ? m.length : 0;\n}\n\n/**\n * Waits the provided number of ms and then resolves with a promise\n * @param {number} ms\n * @return {Promise}\n */\nexport function sleep(ms) {\n  return new Promise(res => setTimeout(res, ms));\n}\n\n/**\n * Checks whether the current browser is on android\n * @param {string} [userAgent]\n * @return {boolean}\n */\nexport function isAndroid(userAgent = navigator.userAgent) {\n  return /android/i.test(userAgent);\n}\n\n/**\n * @typedef {string} ISO6391\n * Language code in ISO 639-1 format. e.g. en, fr, zh\n **/\n\n/** Each lang is an array, with each index mapping to a different property */\nconst COLUMN_TO_LANG_INDEX = {\n  'Name': 0,\n  'Endonym': 1,\n  'ISO 639-1': 2,\n  'ISO 639-2/T': 3,\n  'ISO 639-2/B': 4\n};\n\n/**\n * @param {string} language in some format\n * @return {ISO6391?}\n */\nexport function toISO6391(language) {\n  if (!language) return null;\n  language = language.toLowerCase();\n\n  return searchForISO6391(language, ['ISO 639-1']) ||\n    searchForISO6391(language, ['ISO 639-2/B']) ||\n    searchForISO6391(language, ['ISO 639-2/T', 'Endonym', 'Name']);\n}\n\n/**\n * Searches for the given long in the given columns.\n * @param {string} language\n * @param {Array<keyof COLUMN_TO_LANG_INDEX>} columnsToSearch\n * @return {ISO6391?}\n */\nfunction searchForISO6391(language, columnsToSearch) {\n  for (let i = 0; i < langs.length; i++) {\n    for (let colI = 0; colI < columnsToSearch.length; colI++) {\n      const column = columnsToSearch[colI];\n      const columnValue = langs[i][COLUMN_TO_LANG_INDEX[column]];\n      if (columnValue.split(', ').map(x => x.toLowerCase()).indexOf(language) != -1) {\n        return langs[i][COLUMN_TO_LANG_INDEX['ISO 639-1']];\n      }\n    }\n  }\n  return null;\n}\n","/* global soundManager */\nimport AbstractTTSEngine from './AbstractTTSEngine.js';\nimport { sleep } from './utils.js';\n\n/** @typedef {import(\"./AbstractTTSEngine.js\").TTSEngineOptions} TTSEngineOptions */\n/** @typedef {import(\"./AbstractTTSEngine.js\").AbstractTTSSound} AbstractTTSSound */\n\n/**\n * @extends AbstractTTSEngine\n * TTS using Festival endpoint\n **/\nexport default class FestivalTTSEngine extends AbstractTTSEngine {\n  /** @override */\n  static isSupported() {\n    return typeof(soundManager) !== 'undefined' && soundManager.supported();\n  }\n\n  /** @param {TTSEngineOptions} options */\n  constructor(options) {\n    super(options);\n    /** @type {'mp3' | 'ogg'} format of audio to get */\n    this.audioFormat = $.browser.mozilla ? 'ogg' : 'mp3';\n  }\n\n  /** @override */\n  getVoices() {\n    return [\n      { default: true, lang: \"en-US\", localService: false, name: \"Festival - English (US)\", voiceURI: null }\n    ];\n  }\n\n  /** @override */\n  init() {\n    // setup sound manager\n    soundManager.setup({\n      debugMode: false,\n      // Note, there's a bug in Chrome regarding range requests.\n      // Flash is used as a workaround.\n      // See https://bugs.chromium.org/p/chromium/issues/detail?id=505707\n      preferFlash: true,\n      url: '/bookreader/BookReader/soundmanager/swf',\n      useHTML5Audio: true,\n      //flash 8 version of swf is buggy when calling play() on a sound that is still loading\n      flashVersion: 9\n    });\n  }\n\n  /**\n   * @override\n   * @param {number} leafIndex\n   * @param {number} numLeafs total number of leafs in the current book\n   */\n  start(leafIndex, numLeafs) {\n    let promise = null;\n\n    // Hack for iOS\n    if (navigator.userAgent.match(/mobile/i)) {\n      promise = this.iOSCaptureUserIntentHack();\n    }\n\n    promise = promise || Promise.resolve();\n    promise.then(() => super.start(leafIndex, numLeafs));\n  }\n\n  /** @override */\n  createSound(chunk) {\n    return new FestivalTTSSound(this.getSoundUrl(chunk.text));\n  }\n\n  /**\n   * @private\n   * Get URL for audio that says this text\n   * @param {String} dataString the thing to say\n   * @return {String} url\n   */\n  getSoundUrl(dataString) {\n    return 'https://' + this.opts.server + '/BookReader/BookReaderGetTTS.php?string='\n                  + encodeURIComponent(dataString)\n                  + '&format=.' + this.audioFormat;\n  }\n\n  /**\n   * @private\n   * Security restrictions require playback to be triggered\n   * by a user click/touch. This intention gets lost in the async calls\n   * on iOS, but, for some reason, if we start the audio here, it works.\n   * See https://stackoverflow.com/questions/12206631/html5-audio-cant-play-through-javascript-unless-triggered-manually-once\n   * @return {PromiseLike}\n   */\n  iOSCaptureUserIntentHack() {\n    const sound = soundManager.createSound({ url: SILENCE_1MS[this.audioFormat] });\n    return new Promise(res => sound.play({onfinish: res}))\n      .then(() => sound.destruct());\n  }\n}\n\n/** @extends AbstractTTSSound */\nclass FestivalTTSSound {\n  /** @param {string} soundUrl **/\n  constructor(soundUrl) {\n    this.soundUrl = soundUrl;\n    /** @type {SMSound} */\n    this.sound = null;\n    this.rate = 1;\n    /** @type {function} calling this resolves the \"play\" promise */\n    this._finishResolver = null\n  }\n\n  get loaded() {\n    return this.sound && this.sound.loaded;\n  }\n\n  load(onload) {\n    this.sound = soundManager.createSound({\n      url: this.soundUrl,\n      // API recommended, but only fires once play started on safari\n      onload: () => {\n        if (this.rate != 1) this.sound.setPlaybackRate(this.rate);\n        onload();\n      },\n      onresume: () => {\n        sleep(25).then(() => {\n          if (this.rate != 1) this.sound.setPlaybackRate(this.rate);\n        });\n      }\n    });\n    return this.sound.load();\n  }\n\n  play() {\n    return new Promise(res => {\n      this._finishResolver = res;\n      this.sound.play({ onfinish: res });\n    })\n      .then(() => this.sound.destruct());\n  }\n\n  /** @override */\n  stop() {\n    this.sound.stop();\n    return Promise.resolve();\n  }\n\n  /** @override */\n  pause() { this.sound.pause(); }\n  /** @override */\n  resume() { this.sound.resume(); }\n  /** @override */\n  setPlaybackRate(rate) {\n    this.rate = rate;\n    this.sound.setPlaybackRate(rate);\n  }\n\n  /** @override */\n  finish() {\n    this.sound.stop();\n    this._finishResolver();\n  }\n}\n\n/** Needed to capture the audio context for iOS hack. Generated using Audacity. */\nconst SILENCE_1MS = {\n  mp3: 'data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA//////////////////////////////////////////////////////////////////8AAAAeTEFNRTMuOTlyBJwAAAAAAAAAADUgJAaUQQABrgAAAnHIf8sZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//sQxAADwlwBKGAAACAAAD/AAAAEAAAAH///////////////+UBAMExBTUUzLjk5LjOqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDEIAPAAAGkAAAAIAAANIAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==',\n  ogg: 'data:audio/ogg;base64,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',\n};\n","/* global BookReader, soundManager */\n/**\n * Plugin for Text to Speech in BookReader\n */\nimport FestivalTTSEngine from './FestivalTTSEngine.js';\nimport WebTTSEngine from './WebTTSEngine.js';\nimport { toISO6391, approximateWordCount } from './utils.js';\nimport { en as tooltips } from './tooltip_dict.js';\n/** @typedef {import('./PageChunk.js')} PageChunk */\n/** @typedef {import(\"./AbstractTTSEngine.js\")} AbstractTTSEngine */\n\n// Default options for TTS\njQuery.extend(BookReader.defaultOptions, {\n  server: 'ia600609.us.archive.org',\n  bookPath: '',\n  enableTtsPlugin: true,\n});\n\n// Extend the constructor to add TTS properties\nBookReader.prototype.setup = (function (super_) {\n  return function (options) {\n    super_.call(this, options);\n\n    if (this.options.enableTtsPlugin) {\n      this.ttsHilites = [];\n      let TTSEngine = WebTTSEngine.isSupported() ? WebTTSEngine :\n        FestivalTTSEngine.isSupported() ? FestivalTTSEngine :\n          null;\n\n      if (/_forceTTSEngine=(festival|web)/.test(location.toString())) {\n        const engineName = location.toString().match(/_forceTTSEngine=(festival|web)/)[1];\n        TTSEngine = { festival: FestivalTTSEngine, web: WebTTSEngine }[engineName];\n      }\n\n      if (TTSEngine) {\n        /** @type {AbstractTTSEngine} */\n        this.ttsEngine = new TTSEngine({\n          server: options.server,\n          bookPath: options.bookPath,\n          bookLanguage: toISO6391(options.bookLanguage),\n          onLoadingStart: this.showProgressPopup.bind(this, 'Loading audio...'),\n          onLoadingComplete: this.removeProgressPopup.bind(this),\n          onDone: this.ttsStop.bind(this),\n          beforeChunkPlay: this.ttsBeforeChunkPlay.bind(this),\n          afterChunkPlay: this.ttsSendChunkFinishedAnalyticsEvent.bind(this),\n        });\n      }\n    }\n  };\n})(BookReader.prototype.setup);\n\nBookReader.prototype.init = (function(super_) {\n  return function() {\n    if (this.options.enableTtsPlugin) {\n      // Bind to events\n\n      // TODO move this to BookReader.js or something\n      this.bind(BookReader.eventNames.fragmentChange, () => {\n        if (this.mode == this.constMode2up) {\n          // clear highlights if they're no longer valid for this page\n          const visibleIndices = [this.twoPage.currentIndexL, this.twoPage.currentIndexR];\n          const visibleSelector = visibleIndices.map(i => `.BRReadAloudHilite.Leaf-${i}`).join(', ');\n          $(this.ttsHilites).filter(visibleSelector).show();\n          $(this.ttsHilites).not(visibleSelector).hide();\n        }\n      });\n\n      this.bind(BookReader.eventNames.PostInit, () => {\n        this.$('.BRicon.read').click(() => {\n          this.ttsToggle();\n          return false;\n        });\n        if (this.ttsEngine) {\n          this.ttsEngine.init();\n          if (/[?&]_autoReadAloud=show/.test(location.toString())) {\n            this.refs.$BRReadAloudToolbar.show();\n            this.$('.BRicon.read').addClass('unread active');\n            this.$('.read-aloud [name=play]').addClass('playing');\n          }\n        }\n      });\n\n      // This is fired when the hash changes by one of the other plugins!\n      // i.e. it will fire every time the page changes -_-\n      // this.bind(BookReader.eventNames.stop, function(e, br) {\n      //     this.ttsStop();\n      // }.bind(this));\n    }\n    super_.call(this);\n  };\n})(BookReader.prototype.init);\n\n\n// Extend buildMobileDrawerElement\nBookReader.prototype.buildMobileDrawerElement = (function (super_) {\n  return function () {\n    var $el = super_.call(this);\n    if (this.options.enableTtsPlugin && this.ttsEngine) {\n      $el.find('.BRmobileMenu__moreInfoRow').after($(`\n        <li>\n            <span>\n                <span class=\"DrawerIconWrapper\"><img class=\"DrawerIcon\" src=\"${this.imagesBaseURL}icon_speaker_open.svg\" alt=\"info-speaker\"/></span>\n                Read Aloud\n            </span>\n            <div>\n                <span class=\"larger\">Press to toggle read aloud</span>\n                <br/>\n                <button class=\"BRicon read\"></button>\n            </div>\n        </li>`));\n    }\n    return $el;\n  };\n})(BookReader.prototype.buildMobileDrawerElement);\n\n// Extend initNavbar\nBookReader.prototype.initNavbar = (function (super_) {\n  return function () {\n    var $el = super_.call(this);\n    if (this.options.enableTtsPlugin && this.ttsEngine) {\n      this.refs.$BRReadAloudToolbar = $(`\n        <ul class=\"read-aloud\">\n          <li>\n            <select class=\"playback-speed\" name=\"playback-speed\" title=\"${tooltips.playbackSpeed}\">\n              <option value=\"0.25\">0.25x</option>\n              <option value=\"0.5\">0.5x</option>\n              <option value=\"0.75\">0.75x</option>\n              <option value=\"1.0\" selected>1.0x</option>\n              <option value=\"1.25\">1.25x</option>\n              <option value=\"1.5\">1.5x</option>\n              <option value=\"1.75\">1.75x</option>\n              <option value=\"2\">2x</option>\n            </select>\n          </li>\n          <li>\n            <button type=\"button\" name=\"review\" title=\"${tooltips.review}\">\n              <div class=\"icon icon-review\"></div>\n            </button>\n          </li>\n          <li>\n            <button type=\"button\" name=\"play\" title=\"${tooltips.play}\">\n              <div class=\"icon icon-play\"></div>\n              <div class=\"icon icon-pause\"></div>\n            </button>\n          </li>\n          <li>\n            <button type=\"button\" name=\"advance\" title=\"${tooltips.advance}\">\n              <div class=\"icon icon-advance\"></div>\n            </button>\n          </li>\n        </ul>\n      `);\n      $el.find('.BRcontrols').prepend(this.refs.$BRReadAloudToolbar);\n      this.ttsEngine.events.on('pause resume start', () => this.ttsUpdateState());\n      this.refs.$BRReadAloudToolbar.find('[name=play]').click(this.ttsPlayPause.bind(this));\n      this.refs.$BRReadAloudToolbar.find('[name=advance]').click(this.ttsJumpForward.bind(this));\n      this.refs.$BRReadAloudToolbar.find('[name=review]').click(this.ttsJumpBackward.bind(this));\n      const $rateSelector = this.refs.$BRReadAloudToolbar.find('select[name=\"playback-speed\"]');\n      $rateSelector.change(ev => this.ttsEngine.setPlaybackRate(parseFloat($rateSelector.val())));\n      $(`<li>\n          <button class=\"BRicon read js-tooltip\" title=\"${tooltips.readAloud}\">\n            <div class=\"icon icon-read-aloud\"></div>\n            <span class=\"tooltip\">${tooltips.readAloud}</span>\n          </button>\n        </li>`).insertBefore($el.find('.BRcontrols .BRicon.zoom_out').closest('li'));\n    }\n    return $el;\n  };\n})(BookReader.prototype.initNavbar);\n\n// ttsToggle()\n//______________________________________________________________________________\nBookReader.prototype.ttsToggle = function () {\n  if (this.autoStop) this.autoStop();\n  if (this.ttsEngine.playing) {\n    this.ttsStop();\n  } else {\n    this.ttsStart();\n  }\n};\n\n// ttsStart(\n//______________________________________________________________________________\nBookReader.prototype.ttsStart = function () {\n  if (this.constModeThumb == this.mode)\n    this.switchMode(this.constMode1up);\n\n  this.refs.$BRReadAloudToolbar.addClass('visible');\n  this.$('.BRicon.read').addClass('unread active');\n  this.ttsSendAnalyticsEvent('Start');\n  this.ttsEngine.start(this.currentIndex(), this.getNumLeafs());\n};\n\nBookReader.prototype.ttsJumpForward = function () {\n  if (this.ttsEngine.paused) {\n    this.ttsEngine.resume();\n  }\n  this.ttsEngine.jumpForward();\n};\n\nBookReader.prototype.ttsJumpBackward = function () {\n  if (this.ttsEngine.paused) {\n    this.ttsEngine.resume();\n  }\n  this.ttsEngine.jumpBackward();\n};\n\nBookReader.prototype.ttsUpdateState = function() {\n  const isPlaying = !(this.ttsEngine.paused || !this.ttsEngine.playing);\n  this.$('.read-aloud [name=play]').toggleClass('playing', isPlaying);\n};\n\nBookReader.prototype.ttsPlayPause = function() {\n  if (!this.ttsEngine.playing) {\n    this.ttsToggle();\n  } else {\n    this.ttsEngine.togglePlayPause();\n    this.ttsUpdateState(this.ttsEngine.paused);\n  }\n};\n\n// ttsStop()\n//______________________________________________________________________________\nBookReader.prototype.ttsStop = function () {\n  this.refs.$BRReadAloudToolbar.removeClass('visible');\n  this.$('.BRicon.read').removeClass('unread active');\n  this.ttsSendAnalyticsEvent('Stop');\n  this.ttsEngine.stop();\n  this.ttsRemoveHilites();\n  this.removeProgressPopup();\n};\n\n/**\n * @param {PageChunk} chunk\n * @return {PromiseLike<void>} returns once the flip is done\n */\nBookReader.prototype.ttsBeforeChunkPlay = function(chunk) {\n  return this.ttsMaybeFlipToIndex(chunk.leafIndex)\n    .then(() => {\n      this.ttsHighlightChunk(chunk);\n      this.ttsScrollToChunk(chunk);\n    });\n};\n\n/**\n * @param {PageChunk} chunk\n */\nBookReader.prototype.ttsSendChunkFinishedAnalyticsEvent = function(chunk) {\n  this.ttsSendAnalyticsEvent('ChunkFinished-Words', approximateWordCount(chunk.text));\n};\n\n/**\n * Flip the page if the provided leaf index is not visible\n * @param {Number} leafIndex\n * @return {PromiseLike<void>} resolves once the flip animation has completed\n */\nBookReader.prototype.ttsMaybeFlipToIndex = function (leafIndex) {\n  var in2PageMode = this.constMode2up == this.mode;\n  var resolve = null;\n  var promise = new Promise(res => resolve = res);\n\n  if (!in2PageMode) {\n    this.jumpToIndex(leafIndex);\n    resolve();\n  } else {\n    var leafVisible = leafIndex == this.twoPage.currentIndexR || leafIndex == this.twoPage.currentIndexL;\n    if (leafVisible) {\n      resolve();\n    } else {\n      this.animationFinishedCallback = resolve;\n      const mustGoNext = leafIndex > Math.max(this.twoPage.currentIndexR, this.twoPage.currentIndexL);\n      if (mustGoNext) this.next();\n      else this.prev();\n      promise.then(this.ttsMaybeFlipToIndex.bind(this, leafIndex));\n    }\n  }\n\n  return promise;\n}\n\n/**\n * @param {PageChunk} chunk\n */\nBookReader.prototype.ttsHighlightChunk = function(chunk) {\n  this.ttsRemoveHilites();\n\n  if (this.constMode2up == this.mode) {\n    this.ttsHilite2UP(chunk);\n  } else {\n    this.ttsHilite1UP(chunk);\n  }\n};\n\n/**\n * @param {PageChunk} chunk\n */\nBookReader.prototype.ttsScrollToChunk = function(chunk) {\n  if (this.constMode1up != this.mode) return;\n\n  var leafTop = 0;\n  var h;\n  var i;\n  for (i = 0; i < chunk.leafIndex; i++) {\n    h = parseInt(this._getPageHeight(i) / this.reduce);\n    leafTop += h + this.padding;\n  }\n\n  var chunkTop = chunk.lineRects[0][3]; //coords are in l,b,r,t order\n  var chunkBot = chunk.lineRects[chunk.lineRects.length - 1][1];\n\n  var topOfFirstChunk = leafTop + chunkTop / this.reduce;\n  var botOfLastChunk  = leafTop + chunkBot / this.reduce;\n\n  if (soundManager.debugMode) console.log('leafTop = ' + leafTop + ' topOfFirstChunk = ' + topOfFirstChunk + ' botOfLastChunk = ' + botOfLastChunk);\n\n  var containerTop = this.refs.$brContainer.prop('scrollTop');\n  var containerBot = containerTop + this.refs.$brContainer.height();\n  if (soundManager.debugMode) console.log('containerTop = ' + containerTop + ' containerBot = ' + containerBot);\n\n  if ((topOfFirstChunk < containerTop) || (botOfLastChunk > containerBot)) {\n    this.refs.$brContainer.stop(true).animate({scrollTop: topOfFirstChunk},'fast');\n  }\n};\n\n/**\n * @param {PageChunk} chunk\n */\nBookReader.prototype.ttsHilite1UP = function(chunk) {\n  for (var i = 0; i < chunk.lineRects.length; i++) {\n    //each rect is an array of l,b,r,t coords (djvu.xml ordering...)\n    var l = chunk.lineRects[i][0];\n    var b = chunk.lineRects[i][1];\n    var r = chunk.lineRects[i][2];\n    var t = chunk.lineRects[i][3];\n\n    var div = document.createElement('div');\n    this.ttsHilites.push(div);\n    $(div).prop('className', 'BookReaderSearchHilite').appendTo(\n      this.$('.pagediv' + chunk.leafIndex)\n    );\n\n    $(div).css({\n      width:  (r - l) / this.reduce + 'px',\n      height: (b - t) / this.reduce + 'px',\n      left:   l / this.reduce + 'px',\n      top:    t / this.reduce + 'px'\n    });\n  }\n\n};\n\n/**\n * @param {PageChunk} chunk\n */\nBookReader.prototype.ttsHilite2UP = function (chunk) {\n  for (var i = 0; i < chunk.lineRects.length; i++) {\n    //each rect is an array of l,b,r,t coords (djvu.xml ordering...)\n    var l = chunk.lineRects[i][0];\n    var b = chunk.lineRects[i][1];\n    var r = chunk.lineRects[i][2];\n    var t = chunk.lineRects[i][3];\n\n    var div = document.createElement('div');\n    this.ttsHilites.push(div);\n    $(div)\n      .prop('className', 'BookReaderSearchHilite BRReadAloudHilite Leaf-' + chunk.leafIndex)\n      .css('zIndex', 3)\n      .appendTo(this.refs.$brTwoPageView);\n    this.setHilightCss2UP(div, chunk.leafIndex, l, r, t, b);\n  }\n};\n\n// ttsRemoveHilites()\n//______________________________________________________________________________\nBookReader.prototype.ttsRemoveHilites = function () {\n  $(this.ttsHilites).remove();\n  this.ttsHilites = [];\n};\n\n/**\n * @private\n * Send an analytics event with an optional value. Also attaches the book's language.\n * @param {string} action\n * @param {number} [value]\n */\nBookReader.prototype.ttsSendAnalyticsEvent = function(action, value) {\n  if (this.archiveAnalyticsSendEvent) {\n    const extraValues = {};\n    const mediaLanguage = this.ttsEngine.opts.bookLanguage;\n    if (mediaLanguage) extraValues.mediaLanguage = mediaLanguage;\n    this.archiveAnalyticsSendEvent('BRReadAloud', action, value, extraValues);\n  }\n};\n","/* global br */\nimport { isChrome, isFirefox } from '../../../util/browserSniffing.js';\nimport { sleep, promisifyEvent, isAndroid } from './utils.js';\nimport AbstractTTSEngine from './AbstractTTSEngine.js';\n/** @typedef {import(\"./AbstractTTSEngine.js\").PageChunk} PageChunk */\n/** @typedef {import(\"./AbstractTTSEngine.js\").AbstractTTSSound} AbstractTTSSound */\n/** @typedef {import(\"./AbstractTTSEngine.js\").TTSEngineOptions} TTSEngineOptions */\n\n/**\n * @extends AbstractTTSEngine\n * TTS using Web Speech APIs\n **/\nexport default class WebTTSEngine extends AbstractTTSEngine {\n  static isSupported() {\n    return typeof(window.speechSynthesis) !== 'undefined' && !/samsungbrowser/i.test(navigator.userAgent);\n  }\n\n  /** @param {TTSEngineOptions} options */\n  constructor(options) {\n    super(options);\n\n    // SAFARI doesn't have addEventListener on speechSynthesis\n    if (speechSynthesis.addEventListener) {\n      speechSynthesis.addEventListener('voiceschanged', () => this.events.trigger('voiceschanged'));\n    }\n  }\n\n  /** @override */\n  start(leafIndex, numLeafs) {\n    // Need to run in this function to capture user intent to start playing audio\n    if ('mediaSession' in navigator) {\n      const audio = new Audio(SILENCE_6S_MP3);\n      audio.loop = true;\n\n      this.events.on('pause', () => audio.pause());\n      this.events.on('resume', () => audio.play());\n      // apparently this is what you need to do to make the media session notification go away\n      // See https://developers.google.com/web/updates/2017/02/media-session#implementation_notes\n      this.events.on('stop', () => audio.src = '');\n      audio.play().then(() => {\n        navigator.mediaSession.metadata = new MediaMetadata({\n          title: br.bookTitle,\n          artist: br.options.metadata.filter(m => m.label == 'Author').map(m => m.value)[0],\n          // album: 'The Ultimate Collection (Remastered)',\n          artwork: [\n            { src: br.options.thumbnail, type: 'image/jpg' },\n          ]\n        });\n\n        navigator.mediaSession.setActionHandler('play', () => {\n          audio.play();\n          this.resume();\n        });\n        navigator.mediaSession.setActionHandler('pause', () => {\n          audio.pause();\n          this.pause();\n        });\n\n        // navigator.mediaSession.setActionHandler('seekbackward', () => this.jumpBackward());\n        // navigator.mediaSession.setActionHandler('seekforward', () => this.jumpForward());\n        // Some devices only support the previoustrack/nexttrack (e.g. Win10), so show those.\n        // Android devices do support the seek actions, but we don't want to show both buttons\n        // and have them do the same thing.\n        navigator.mediaSession.setActionHandler('previoustrack', () => this.jumpBackward());\n        navigator.mediaSession.setActionHandler('nexttrack', () => this.jumpForward());\n      });\n    }\n\n    return super.start(leafIndex, numLeafs);\n  }\n\n  /** @override */\n  getVoices() { return speechSynthesis.getVoices(); }\n\n  /** @override */\n  createSound(chunk) {\n    return new WebTTSSound(chunk.text);\n  }\n}\n\n/** @extends AbstractTTSSound */\nexport class WebTTSSound {\n  /** @param {string} text **/\n  constructor(text) {\n    this.text = text;\n    this.loaded = false;\n    this.paused = false;\n    this.started = false;\n    /** Whether the audio was stopped with a .stop() call */\n    this.stopped = false;\n    this.rate = 1;\n\n    /** @type {SpeechSynthesisUtterance} */\n    this.utterance = null;\n\n    /** @type {SpeechSynthesisVoice} */\n    this.voice = null;\n\n    this._lastEvents = {\n      /** @type {SpeechSynthesisEvent} */\n      pause: null,\n      /** @type {SpeechSynthesisEvent} */\n      boundary: null,\n      /** @type {SpeechSynthesisEvent} */\n      start: null,\n    };\n\n    /** Store where we are in the text. Only works on some browsers. */\n    this._charIndex = 0;\n\n    /** @type {Function} resolve function called when playback finished */\n    this._finishResolver = null;\n\n    /** @type {Promise} promise resolved by _finishResolver */\n    this._finishPromise = null;\n  }\n\n  /** @override **/\n  load(onload) {\n    this.loaded = false;\n    this.started = false;\n\n    this.utterance = new SpeechSynthesisUtterance(this.text.slice(this._charIndex));\n    this.utterance.voice = this.voice;\n    // Need to also set lang (for some reason); won't set voice on Chrome@Android otherwise\n    if (this.voice) this.utterance.lang = this.voice.lang;\n    this.utterance.rate = this.rate;\n\n    // Useful for debugging things\n    if (location.toString().indexOf('_debugReadAloud=true') != -1) {\n      this.utterance.addEventListener('pause', () => console.log('pause'));\n      this.utterance.addEventListener('resume', () => console.log('resume'));\n      this.utterance.addEventListener('start', () => console.log('start'));\n      this.utterance.addEventListener('end', () => console.log('end'));\n      this.utterance.addEventListener('error', () => console.log('error'));\n      this.utterance.addEventListener('boundary', () => console.log('boundary'));\n      this.utterance.addEventListener('mark', () => console.log('mark'));\n      this.utterance.addEventListener('finish', () => console.log('finish'));\n    }\n\n    // Keep track of the speech synthesis events that come in; they have useful info\n    // about progress (like charIndex)\n    this.utterance.addEventListener('start', ev => this._lastEvents.start = ev);\n    this.utterance.addEventListener('boundary', ev => this._lastEvents.boundary = ev);\n    this.utterance.addEventListener('pause', ev => this._lastEvents.pause = ev);\n\n    // Update our state\n    this.utterance.addEventListener('start', () => {\n      this.started = true;\n      this.stopped = false;\n      this.paused = false;\n    });\n    this.utterance.addEventListener('pause', () => this.paused = true);\n    this.utterance.addEventListener('resume', () => this.paused = false);\n    this.utterance.addEventListener('end', ev => {\n      if (!this.paused && !this.stopped) {\n        // Trigger a new event, finish, which only fires when audio fully completed\n        this.utterance.dispatchEvent(new CustomEvent('finish', ev));\n      }\n    });\n    this.loaded = true;\n    onload && onload();\n  }\n\n  /**\n   * Run whenever properties have changed. Tries to restart in the same spot it\n   * left off.\n   * @return {Promise<void>}\n   */\n  reload() {\n    // We'll restore the pause state, so copy it here\n    const wasPaused = this.paused;\n    // Use recent event to determine where we'll restart from\n    // Browser support for this is mixed, but it degrades to restarting the chunk\n    // and that's ok\n    const recentEvent = this._lastEvents.boundary || this._lastEvents.pause;\n    if (recentEvent) {\n      this._charIndex = this.text.indexOf(recentEvent.target.text) + recentEvent.charIndex;\n    }\n\n    // We can't modify the utterance object, so we have to make a new one\n    return this.stop()\n      .then(() => {\n        this.load();\n        // Instead of playing and immediately pausing, we don't start playing. Note\n        // this is a requirement because pause doesn't work consistently across\n        // browsers.\n        if (!wasPaused) this.play();\n      });\n  }\n\n  play() {\n    this._finishPromise = this._finishPromise || new Promise(res => this._finishResolver = res);\n    this.utterance.addEventListener('finish', this._finishResolver);\n\n    // clear the queue\n    speechSynthesis.cancel();\n    // reset pause state\n    speechSynthesis.resume();\n    // Speak\n    speechSynthesis.speak(this.utterance);\n\n    const isLocalVoice = this.utterance.voice && this.utterance.voice.localService;\n    if (isChrome() && !isLocalVoice) this._chromePausingBugFix();\n\n    return this._finishPromise;\n  }\n\n  /** @return {Promise} */\n  stop() {\n    // 'end' won't fire if already stopped\n    let endPromise = Promise.resolve();\n    if (!this.stopped) {\n      endPromise = Promise.race([\n        promisifyEvent(this.utterance, 'end'),\n        // Safari triggers an error when you call cancel mid-sound\n        promisifyEvent(this.utterance, 'error'),\n      ]);\n    }\n    this.stopped = true;\n    speechSynthesis.cancel();\n    return endPromise;\n  }\n\n  finish() {\n    this.stop().then(() => this.utterance.dispatchEvent(new Event('finish')));\n  }\n\n  /**\n   * @override\n   * Will fire a pause event unless already paused\n   **/\n  pause() {\n    if (this.paused) return;\n\n    const pausePromise = promisifyEvent(this.utterance, 'pause');\n    speechSynthesis.pause();\n\n    // There are a few awful browser cases:\n    // 1. Pause works and fires\n    // 2. Pause doesn't work and doesn't fire\n    // 3. Pause works but doesn't fire\n    const pauseMightNotWork = (isFirefox() && isAndroid());\n    const pauseMightNotFire = isChrome() || pauseMightNotWork;\n\n    if (pauseMightNotFire) {\n      // wait for it just it incase\n      const timeoutPromise = sleep(100).then(() => 'timeout');\n      Promise.race([pausePromise, timeoutPromise])\n        .then(result => {\n          // We got our pause event; nothing to do!\n          if (result != 'timeout') return;\n\n          this.utterance.dispatchEvent(new CustomEvent('pause', this._lastEvents.start));\n          // if pause might not work, then we'll stop entirely and restart later\n          if (pauseMightNotWork) this.stop();\n        });\n    }\n  }\n\n  resume() {\n    if (!this.started) {\n      this.play();\n      return;\n    }\n\n    if (!this.paused) return;\n\n    // Browser cases:\n    // 1. Resume works + fires\n    // 2. Resume works + doesn't fire (Chrome Desktop)\n    // 3. Resume doesn't work + doesn't fire (Chrome/FF Android)\n    const resumeMightNotWork = (isChrome() && isAndroid()) || (isFirefox() && isAndroid());\n    const resumeMightNotFire = isChrome() || resumeMightNotWork;\n\n    // Try resume\n    const resumePromise = promisifyEvent(this.utterance, 'resume');\n    speechSynthesis.resume();\n\n    if (resumeMightNotFire) {\n      Promise.race([resumePromise, sleep(100).then(() => 'timeout')])\n        .then(result => {\n          if (result != 'timeout') return;\n\n          this.utterance.dispatchEvent(new CustomEvent('resume', {}));\n          if (resumeMightNotWork) {\n            const reloadPromise = this.reload();\n            reloadPromise.then(() => this.play());\n          }\n        });\n    }\n  }\n\n  setPlaybackRate(rate) {\n    this.rate = rate;\n    this.reload();\n  }\n\n  /**\n   * @private\n   * Chrome has a bug where it only plays 15 seconds of TTS and then\n   * suddenly stops (see https://bugs.chromium.org/p/chromium/issues/detail?id=679437 )\n   * We avoid this (as described here: https://bugs.chromium.org/p/chromium/issues/detail?id=679437#c15 )\n   * by pausing after 14 seconds and ~instantly resuming.\n   */\n  _chromePausingBugFix() {\n    const timeoutPromise = sleep(14000).then(() => 'timeout');\n    const pausePromise = promisifyEvent(this.utterance, 'pause').then(() => 'paused');\n    const endPromise = promisifyEvent(this.utterance, 'end').then(() => 'ended');\n    return Promise.race([timeoutPromise, pausePromise, endPromise])\n      .then(result => {\n        if (location.toString().indexOf('_debugReadAloud=true') != -1) {\n          console.log(`CHROME-PAUSE-HACK: ${result}`);\n        }\n        switch(result) {\n        case 'ended':\n          // audio was stopped/finished; nothing to do\n          break;\n        case 'paused':\n          // audio was paused; wait for resume\n          // Chrome won't let you resume the audio if 14s have passed \n          // We could do the same as before (but resume+pause instead of pause+resume),\n          // but that means we'd _constantly_ be running in the background. So in that\n          // case, let's just restart the chunk\n          Promise.race([\n            promisifyEvent(this.utterance, 'resume'),\n            sleep(14000).then(() => 'timeout'),\n          ])\n            .then(result => {\n              result == 'timeout' ? this.reload() : this._chromePausingBugFix();\n            });\n          break;\n        case 'timeout':\n          // We hit Chrome's secret cut off time. Pause/resume\n          // to be able to keep TTS-ing\n          speechSynthesis.pause();\n          sleep(25)\n            .then(() => {\n              speechSynthesis.resume();\n              this._chromePausingBugFix();\n            });\n          break;\n        }\n      });\n  }\n}\n\n/**\n * According to https://developers.google.com/web/updates/2017/02/media-session#implementation_notes , it needs to be at least 5 seconds\n * long to allow usage of the media sessions api\n */\nconst SILENCE_6S_MP3 = 'data:audio/mp3;base64,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';\n","export const en = {\n  advance: 'Advance 10 seconds',\n  play: 'Play',\n  playbackSpeed: 'Playback speed',\n  readAloud: 'Read this book aloud',\n  review: 'Review 10 seconds',\n};\n\nexport const es = {\n  advance: 'Avance 10 segundos',\n  play: 'Jugar',\n  playbackSpeed: 'Velocidad de reproduccin',\n  readAloud: 'Lee este libro en voz alta',\n  review: 'Revisar 10 segundos',\n};\n","\n/**\n * Checks whether the current browser is a Chrome/Chromium browser\n * Code from https://stackoverflow.com/a/4565120/2317712\n * @param {string} [userAgent]\n * @param {string} [vendor]\n * @return {boolean}\n */\nexport function isChrome(userAgent = navigator.userAgent, vendor = navigator.vendor) {\n  return /chrome/i.test(userAgent) && /google inc/i.test(vendor);\n}\n\n/**\n * Checks whether the current browser is firefox\n * @param {string} [userAgent]\n * @return {boolean}\n */\nexport function isFirefox(userAgent = navigator.userAgent) {\n  return /firefox/i.test(userAgent);\n}\n\n/**\n * Checks whether the current browser is safari\n * https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent#Browser_Name\n * @param {string} [userAgent]\n * @return {boolean}\n */\nexport function isSafari(userAgent = navigator.userAgent) {\n  return /safari/i.test(userAgent) && !/chrome|chromium/i.test(userAgent);\n}\n","var userAgent = require('../internals/engine-user-agent');\n\nmodule.exports = /(iphone|ipod|ipad).*applewebkit/i.test(userAgent);\n","'use strict';\nvar aFunction = require('../internals/a-function');\nvar isObject = require('../internals/is-object');\n\nvar slice = [].slice;\nvar factories = {};\n\nvar construct = function (C, argsLength, args) {\n  if (!(argsLength in factories)) {\n    for (var list = [], i = 0; i < argsLength; i++) list[i] = 'a[' + i + ']';\n    // eslint-disable-next-line no-new-func\n    factories[argsLength] = Function('C,a', 'return new C(' + list.join(',') + ')');\n  } return factories[argsLength](C, args);\n};\n\n// `Function.prototype.bind` method implementation\n// https://tc39.github.io/ecma262/#sec-function.prototype.bind\nmodule.exports = Function.bind || function bind(that /* , ...args */) {\n  var fn = aFunction(this);\n  var partArgs = slice.call(arguments, 1);\n  var boundFunction = function bound(/* args... */) {\n    var args = partArgs.concat(slice.call(arguments));\n    return this instanceof boundFunction ? construct(fn, args.length, args) : fn.apply(that, args);\n  };\n  if (isObject(fn.prototype)) boundFunction.prototype = fn.prototype;\n  return boundFunction;\n};\n","var global = require('../internals/global');\n\nmodule.exports = function (a, b) {\n  var console = global.console;\n  if (console && console.error) {\n    arguments.length === 1 ? console.error(a) : console.error(a, b);\n  }\n};\n","var anObject = require('../internals/an-object');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar toLength = require('../internals/to-length');\nvar bind = require('../internals/function-bind-context');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\n\nvar Result = function (stopped, result) {\n  this.stopped = stopped;\n  this.result = result;\n};\n\nvar iterate = module.exports = function (iterable, fn, that, AS_ENTRIES, IS_ITERATOR) {\n  var boundFunction = bind(fn, that, AS_ENTRIES ? 2 : 1);\n  var iterator, iterFn, index, length, result, next, step;\n\n  if (IS_ITERATOR) {\n    iterator = iterable;\n  } else {\n    iterFn = getIteratorMethod(iterable);\n    if (typeof iterFn != 'function') throw TypeError('Target is not iterable');\n    // optimisation for array iterators\n    if (isArrayIteratorMethod(iterFn)) {\n      for (index = 0, length = toLength(iterable.length); length > index; index++) {\n        result = AS_ENTRIES\n          ? boundFunction(anObject(step = iterable[index])[0], step[1])\n          : boundFunction(iterable[index]);\n        if (result && result instanceof Result) return result;\n      } return new Result(false);\n    }\n    iterator = iterFn.call(iterable);\n  }\n\n  next = iterator.next;\n  while (!(step = next.call(iterator)).done) {\n    result = callWithSafeIterationClosing(iterator, boundFunction, step.value, AS_ENTRIES);\n    if (typeof result == 'object' && result && result instanceof Result) return result;\n  } return new Result(false);\n};\n\niterate.stop = function (result) {\n  return new Result(true, result);\n};\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar classof = require('../internals/classof-raw');\nvar macrotask = require('../internals/task').set;\nvar IS_IOS = require('../internals/engine-is-ios');\n\nvar MutationObserver = global.MutationObserver || global.WebKitMutationObserver;\nvar process = global.process;\nvar Promise = global.Promise;\nvar IS_NODE = classof(process) == 'process';\n// Node.js 11 shows ExperimentalWarning on getting `queueMicrotask`\nvar queueMicrotaskDescriptor = getOwnPropertyDescriptor(global, 'queueMicrotask');\nvar queueMicrotask = queueMicrotaskDescriptor && queueMicrotaskDescriptor.value;\n\nvar flush, head, last, notify, toggle, node, promise, then;\n\n// modern engines have queueMicrotask method\nif (!queueMicrotask) {\n  flush = function () {\n    var parent, fn;\n    if (IS_NODE && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (error) {\n        if (head) notify();\n        else last = undefined;\n        throw error;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // Node.js\n  if (IS_NODE) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // browsers with MutationObserver, except iOS - https://github.com/zloirock/core-js/issues/339\n  } else if (MutationObserver && !IS_IOS) {\n    toggle = true;\n    node = document.createTextNode('');\n    new MutationObserver(flush).observe(node, { characterData: true });\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    promise = Promise.resolve(undefined);\n    then = promise.then;\n    notify = function () {\n      then.call(promise, flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function () {\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n}\n\nmodule.exports = queueMicrotask || function (fn) {\n  var task = { fn: fn, next: undefined };\n  if (last) last.next = task;\n  if (!head) {\n    head = task;\n    notify();\n  } last = task;\n};\n","var global = require('../internals/global');\n\nmodule.exports = global.Promise;\n","'use strict';\nvar aFunction = require('../internals/a-function');\n\nvar PromiseCapability = function (C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n};\n\n// 25.4.1.5 NewPromiseCapability(C)\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","module.exports = function (exec) {\n  try {\n    return { error: false, value: exec() };\n  } catch (error) {\n    return { error: true, value: error };\n  }\n};\n","var anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar newPromiseCapability = require('../internals/new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar definePropertyModule = require('../internals/object-define-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (CONSTRUCTOR_NAME) {\n  var Constructor = getBuiltIn(CONSTRUCTOR_NAME);\n  var defineProperty = definePropertyModule.f;\n\n  if (DESCRIPTORS && Constructor && !Constructor[SPECIES]) {\n    defineProperty(Constructor, SPECIES, {\n      configurable: true,\n      get: function () { return this; }\n    });\n  }\n};\n","var global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\nvar bind = require('../internals/function-bind-context');\nvar html = require('../internals/html');\nvar createElement = require('../internals/document-create-element');\nvar IS_IOS = require('../internals/engine-is-ios');\n\nvar location = global.location;\nvar set = global.setImmediate;\nvar clear = global.clearImmediate;\nvar process = global.process;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\n\nvar run = function (id) {\n  // eslint-disable-next-line no-prototype-builtins\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\n\nvar runner = function (id) {\n  return function () {\n    run(id);\n  };\n};\n\nvar listener = function (event) {\n  run(event.data);\n};\n\nvar post = function (id) {\n  // old engines have not location.origin\n  global.postMessage(id + '', location.protocol + '//' + location.host);\n};\n\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!set || !clear) {\n  set = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func\n      (typeof fn == 'function' ? fn : Function(fn)).apply(undefined, args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clear = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (classof(process) == 'process') {\n    defer = function (id) {\n      process.nextTick(runner(id));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(runner(id));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  // except iOS - https://github.com/zloirock/core-js/issues/624\n  } else if (MessageChannel && !IS_IOS) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = bind(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (\n    global.addEventListener &&\n    typeof postMessage == 'function' &&\n    !global.importScripts &&\n    !fails(post) &&\n    location.protocol !== 'file:'\n  ) {\n    defer = post;\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in createElement('script')) {\n    defer = function (id) {\n      html.appendChild(createElement('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(runner(id), 0);\n    };\n  }\n}\n\nmodule.exports = {\n  set: set,\n  clear: clear\n};\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar nativeGetOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetOwnPropertyDescriptor(1); });\nvar FORCED = !DESCRIPTORS || FAILS_ON_PRIMITIVES;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptor\n$({ target: 'Object', stat: true, forced: FORCED, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(it, key) {\n    return nativeGetOwnPropertyDescriptor(toIndexedObject(it), key);\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toObject = require('../internals/to-object');\nvar nativeGetPrototypeOf = require('../internals/object-get-prototype-of');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetPrototypeOf(1); });\n\n// `Object.getPrototypeOf` method\n// https://tc39.github.io/ecma262/#sec-object.getprototypeof\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !CORRECT_PROTOTYPE_GETTER }, {\n  getPrototypeOf: function getPrototypeOf(it) {\n    return nativeGetPrototypeOf(toObject(it));\n  }\n});\n\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar setSpecies = require('../internals/set-species');\nvar isObject = require('../internals/is-object');\nvar aFunction = require('../internals/a-function');\nvar anInstance = require('../internals/an-instance');\nvar classof = require('../internals/classof-raw');\nvar inspectSource = require('../internals/inspect-source');\nvar iterate = require('../internals/iterate');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar speciesConstructor = require('../internals/species-constructor');\nvar task = require('../internals/task').set;\nvar microtask = require('../internals/microtask');\nvar promiseResolve = require('../internals/promise-resolve');\nvar hostReportErrors = require('../internals/host-report-errors');\nvar newPromiseCapabilityModule = require('../internals/new-promise-capability');\nvar perform = require('../internals/perform');\nvar InternalStateModule = require('../internals/internal-state');\nvar isForced = require('../internals/is-forced');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\nvar PROMISE = 'Promise';\nvar getInternalState = InternalStateModule.get;\nvar setInternalState = InternalStateModule.set;\nvar getInternalPromiseState = InternalStateModule.getterFor(PROMISE);\nvar PromiseConstructor = NativePromise;\nvar TypeError = global.TypeError;\nvar document = global.document;\nvar process = global.process;\nvar $fetch = getBuiltIn('fetch');\nvar newPromiseCapability = newPromiseCapabilityModule.f;\nvar newGenericPromiseCapability = newPromiseCapability;\nvar IS_NODE = classof(process) == 'process';\nvar DISPATCH_EVENT = !!(document && document.createEvent && global.dispatchEvent);\nvar UNHANDLED_REJECTION = 'unhandledrejection';\nvar REJECTION_HANDLED = 'rejectionhandled';\nvar PENDING = 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\nvar HANDLED = 1;\nvar UNHANDLED = 2;\nvar Internal, OwnPromiseCapability, PromiseWrapper, nativeThen;\n\nvar FORCED = isForced(PROMISE, function () {\n  var GLOBAL_CORE_JS_PROMISE = inspectSource(PromiseConstructor) !== String(PromiseConstructor);\n  if (!GLOBAL_CORE_JS_PROMISE) {\n    // V8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n    // We can't detect it synchronously, so just check versions\n    if (V8_VERSION === 66) return true;\n    // Unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    if (!IS_NODE && typeof PromiseRejectionEvent != 'function') return true;\n  }\n  // We need Promise#finally in the pure version for preventing prototype pollution\n  if (IS_PURE && !PromiseConstructor.prototype['finally']) return true;\n  // We can't use @@species feature detection in V8 since it causes\n  // deoptimization and performance degradation\n  // https://github.com/zloirock/core-js/issues/679\n  if (V8_VERSION >= 51 && /native code/.test(PromiseConstructor)) return false;\n  // Detect correctness of subclassing with @@species support\n  var promise = PromiseConstructor.resolve(1);\n  var FakePromise = function (exec) {\n    exec(function () { /* empty */ }, function () { /* empty */ });\n  };\n  var constructor = promise.constructor = {};\n  constructor[SPECIES] = FakePromise;\n  return !(promise.then(function () { /* empty */ }) instanceof FakePromise);\n});\n\nvar INCORRECT_ITERATION = FORCED || !checkCorrectnessOfIteration(function (iterable) {\n  PromiseConstructor.all(iterable)['catch'](function () { /* empty */ });\n});\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\n\nvar notify = function (promise, state, isReject) {\n  if (state.notified) return;\n  state.notified = true;\n  var chain = state.reactions;\n  microtask(function () {\n    var value = state.value;\n    var ok = state.state == FULFILLED;\n    var index = 0;\n    // variable length - can't use forEach\n    while (chain.length > index) {\n      var reaction = chain[index++];\n      var handler = ok ? reaction.ok : reaction.fail;\n      var resolve = reaction.resolve;\n      var reject = reaction.reject;\n      var domain = reaction.domain;\n      var result, then, exited;\n      try {\n        if (handler) {\n          if (!ok) {\n            if (state.rejection === UNHANDLED) onHandleUnhandled(promise, state);\n            state.rejection = HANDLED;\n          }\n          if (handler === true) result = value;\n          else {\n            if (domain) domain.enter();\n            result = handler(value); // can throw\n            if (domain) {\n              domain.exit();\n              exited = true;\n            }\n          }\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (error) {\n        if (domain && !exited) domain.exit();\n        reject(error);\n      }\n    }\n    state.reactions = [];\n    state.notified = false;\n    if (isReject && !state.rejection) onUnhandled(promise, state);\n  });\n};\n\nvar dispatchEvent = function (name, promise, reason) {\n  var event, handler;\n  if (DISPATCH_EVENT) {\n    event = document.createEvent('Event');\n    event.promise = promise;\n    event.reason = reason;\n    event.initEvent(name, false, true);\n    global.dispatchEvent(event);\n  } else event = { promise: promise, reason: reason };\n  if (handler = global['on' + name]) handler(event);\n  else if (name === UNHANDLED_REJECTION) hostReportErrors('Unhandled promise rejection', reason);\n};\n\nvar onUnhandled = function (promise, state) {\n  task.call(global, function () {\n    var value = state.value;\n    var IS_UNHANDLED = isUnhandled(state);\n    var result;\n    if (IS_UNHANDLED) {\n      result = perform(function () {\n        if (IS_NODE) {\n          process.emit('unhandledRejection', value, promise);\n        } else dispatchEvent(UNHANDLED_REJECTION, promise, value);\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      state.rejection = IS_NODE || isUnhandled(state) ? UNHANDLED : HANDLED;\n      if (result.error) throw result.value;\n    }\n  });\n};\n\nvar isUnhandled = function (state) {\n  return state.rejection !== HANDLED && !state.parent;\n};\n\nvar onHandleUnhandled = function (promise, state) {\n  task.call(global, function () {\n    if (IS_NODE) {\n      process.emit('rejectionHandled', promise);\n    } else dispatchEvent(REJECTION_HANDLED, promise, state.value);\n  });\n};\n\nvar bind = function (fn, promise, state, unwrap) {\n  return function (value) {\n    fn(promise, state, value, unwrap);\n  };\n};\n\nvar internalReject = function (promise, state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  state.value = value;\n  state.state = REJECTED;\n  notify(promise, state, true);\n};\n\nvar internalResolve = function (promise, state, value, unwrap) {\n  if (state.done) return;\n  state.done = true;\n  if (unwrap) state = unwrap;\n  try {\n    if (promise === value) throw TypeError(\"Promise can't be resolved itself\");\n    var then = isThenable(value);\n    if (then) {\n      microtask(function () {\n        var wrapper = { done: false };\n        try {\n          then.call(value,\n            bind(internalResolve, promise, wrapper, state),\n            bind(internalReject, promise, wrapper, state)\n          );\n        } catch (error) {\n          internalReject(promise, wrapper, error, state);\n        }\n      });\n    } else {\n      state.value = value;\n      state.state = FULFILLED;\n      notify(promise, state, false);\n    }\n  } catch (error) {\n    internalReject(promise, { done: false }, error, state);\n  }\n};\n\n// constructor polyfill\nif (FORCED) {\n  // 25.4.3.1 Promise(executor)\n  PromiseConstructor = function Promise(executor) {\n    anInstance(this, PromiseConstructor, PROMISE);\n    aFunction(executor);\n    Internal.call(this);\n    var state = getInternalState(this);\n    try {\n      executor(bind(internalResolve, this, state), bind(internalReject, this, state));\n    } catch (error) {\n      internalReject(this, state, error);\n    }\n  };\n  // eslint-disable-next-line no-unused-vars\n  Internal = function Promise(executor) {\n    setInternalState(this, {\n      type: PROMISE,\n      done: false,\n      notified: false,\n      parent: false,\n      reactions: [],\n      rejection: false,\n      state: PENDING,\n      value: undefined\n    });\n  };\n  Internal.prototype = redefineAll(PromiseConstructor.prototype, {\n    // `Promise.prototype.then` method\n    // https://tc39.github.io/ecma262/#sec-promise.prototype.then\n    then: function then(onFulfilled, onRejected) {\n      var state = getInternalPromiseState(this);\n      var reaction = newPromiseCapability(speciesConstructor(this, PromiseConstructor));\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      reaction.domain = IS_NODE ? process.domain : undefined;\n      state.parent = true;\n      state.reactions.push(reaction);\n      if (state.state != PENDING) notify(this, state, false);\n      return reaction.promise;\n    },\n    // `Promise.prototype.catch` method\n    // https://tc39.github.io/ecma262/#sec-promise.prototype.catch\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    var state = getInternalState(promise);\n    this.promise = promise;\n    this.resolve = bind(internalResolve, promise, state);\n    this.reject = bind(internalReject, promise, state);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === PromiseConstructor || C === PromiseWrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n\n  if (!IS_PURE && typeof NativePromise == 'function') {\n    nativeThen = NativePromise.prototype.then;\n\n    // wrap native Promise#then for native async functions\n    redefine(NativePromise.prototype, 'then', function then(onFulfilled, onRejected) {\n      var that = this;\n      return new PromiseConstructor(function (resolve, reject) {\n        nativeThen.call(that, resolve, reject);\n      }).then(onFulfilled, onRejected);\n    // https://github.com/zloirock/core-js/issues/640\n    }, { unsafe: true });\n\n    // wrap fetch result\n    if (typeof $fetch == 'function') $({ global: true, enumerable: true, forced: true }, {\n      // eslint-disable-next-line no-unused-vars\n      fetch: function fetch(input /* , init */) {\n        return promiseResolve(PromiseConstructor, $fetch.apply(global, arguments));\n      }\n    });\n  }\n}\n\n$({ global: true, wrap: true, forced: FORCED }, {\n  Promise: PromiseConstructor\n});\n\nsetToStringTag(PromiseConstructor, PROMISE, false, true);\nsetSpecies(PROMISE);\n\nPromiseWrapper = getBuiltIn(PROMISE);\n\n// statics\n$({ target: PROMISE, stat: true, forced: FORCED }, {\n  // `Promise.reject` method\n  // https://tc39.github.io/ecma262/#sec-promise.reject\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    capability.reject.call(undefined, r);\n    return capability.promise;\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: IS_PURE || FORCED }, {\n  // `Promise.resolve` method\n  // https://tc39.github.io/ecma262/#sec-promise.resolve\n  resolve: function resolve(x) {\n    return promiseResolve(IS_PURE && this === PromiseWrapper ? PromiseConstructor : this, x);\n  }\n});\n\n$({ target: PROMISE, stat: true, forced: INCORRECT_ITERATION }, {\n  // `Promise.all` method\n  // https://tc39.github.io/ecma262/#sec-promise.all\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aFunction(C.resolve);\n      var values = [];\n      var counter = 0;\n      var remaining = 1;\n      iterate(iterable, function (promise) {\n        var index = counter++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        $promiseResolve.call(C, promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  },\n  // `Promise.race` method\n  // https://tc39.github.io/ecma262/#sec-promise.race\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      var $promiseResolve = aFunction(C.resolve);\n      iterate(iterable, function (promise) {\n        $promiseResolve.call(C, promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.error) reject(result.value);\n    return capability.promise;\n  }\n});\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar aFunction = require('../internals/a-function');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar create = require('../internals/object-create');\nvar bind = require('../internals/function-bind');\nvar fails = require('../internals/fails');\n\nvar nativeConstruct = getBuiltIn('Reflect', 'construct');\n\n// `Reflect.construct` method\n// https://tc39.github.io/ecma262/#sec-reflect.construct\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(nativeConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\nvar ARGS_BUG = !fails(function () {\n  nativeConstruct(function () { /* empty */ });\n});\nvar FORCED = NEW_TARGET_BUG || ARGS_BUG;\n\n$({ target: 'Reflect', stat: true, forced: FORCED, sham: FORCED }, {\n  construct: function construct(Target, args /* , newTarget */) {\n    aFunction(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aFunction(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return nativeConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      $args.push.apply($args, args);\n      return new (bind.apply(Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : Object.prototype);\n    var result = Function.apply.call(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n","var $ = require('../internals/export');\nvar isObject = require('../internals/is-object');\nvar anObject = require('../internals/an-object');\nvar has = require('../internals/has');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\n\n// `Reflect.get` method\n// https://tc39.github.io/ecma262/#sec-reflect.get\nfunction get(target, propertyKey /* , receiver */) {\n  var receiver = arguments.length < 3 ? target : arguments[2];\n  var descriptor, prototype;\n  if (anObject(target) === receiver) return target[propertyKey];\n  if (descriptor = getOwnPropertyDescriptorModule.f(target, propertyKey)) return has(descriptor, 'value')\n    ? descriptor.value\n    : descriptor.get === undefined\n      ? undefined\n      : descriptor.get.call(receiver);\n  if (isObject(prototype = getPrototypeOf(target))) return get(prototype, propertyKey, receiver);\n}\n\n$({ target: 'Reflect', stat: true }, {\n  get: get\n});\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toLength = require('../internals/to-length');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@match logic\nfixRegExpWellKnownSymbolLogic('match', 1, function (MATCH, nativeMatch, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = requireObjectCoercible(this);\n      var matcher = regexp == undefined ? undefined : regexp[MATCH];\n      return matcher !== undefined ? matcher.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match\n    function (regexp) {\n      var res = maybeCallNative(nativeMatch, regexp, this);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      if (!rx.global) return regExpExec(rx, S);\n\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = String(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\nvar nativeStartsWith = ''.startsWith;\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('startsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'startsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.startsWith` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.startswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = String(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var index = toLength(min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return nativeStartsWith\n      ? nativeStartsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _default = [['Serbian', ' ', 'sr', 'srp', 'srp'], ['Romanian, Moldavian, Moldovan', 'Romn', 'ro', 'ron', 'rum'], ['Sichuan Yi, Nuosu', ' Nuosuhxop', 'ii', 'iii', 'iii'], ['Tahitian', 'Reo Tahiti', 'ty', 'tah', 'tah'], ['Tagalog', 'Wikang Tagalog', 'tl', 'tgl', 'tgl'], ['Yiddish', '', 'yi', 'yid', 'yid'], ['Akan', 'Akan', 'ak', 'aka', 'aka'], ['Malay', 'Bahasa Melayu,  ', 'ms', 'msa', 'may'], ['Arabic', '', 'ar', 'ara', 'ara'], ['Norwegian', 'Norsk', 'no', 'nor', 'nor'], ['Ojibwa', '', 'oj', 'oji', 'oji'], ['Fulah', 'Fulfulde, Pulaar, Pular', 'ff', 'ful', 'ful'], ['Persian', '', 'fa', 'fas', 'per'], ['Albanian', 'Shqip', 'sq', 'sqi', 'alb'], ['Aymara', 'aymar aru', 'ay', 'aym', 'aym'], ['Azerbaijani', 'azrbaycan dili', 'az', 'aze', 'aze'], ['Chinese', ' (Zhngwn), , ', 'zh', 'zho', 'chi'], ['Cree', '', 'cr', 'cre', 'cre'], ['Estonian', 'eesti, eesti keel', 'et', 'est', 'est'], ['Guaran', 'Avae\\'', 'gn', 'grn', 'grn'], ['Inupiaq', 'Iupiaq, Iupiatun', 'ik', 'ipk', 'ipk'], ['Inuktitut', '', 'iu', 'iku', 'iku'], ['Kanuri', 'Kanuri', 'kr', 'kau', 'kau'], ['Komi', ' ', 'kv', 'kom', 'kom'], ['Kongo', 'Kikongo', 'kg', 'kon', 'kon'], ['Kurdish', 'Kurd, ', 'ku', 'kur', 'kur'], ['Latvian', 'latvieu valoda', 'lv', 'lav', 'lav'], ['Malagasy', 'fiteny malagasy', 'mg', 'mlg', 'mlg'], ['Mongolian', ' ', 'mn', 'mon', 'mon'], ['Oromo', 'Afaan Oromoo', 'om', 'orm', 'orm'], ['Pashto, Pushto', '', 'ps', 'pus', 'pus'], ['Quechua', 'Runa Simi, Kichwa', 'qu', 'que', 'que'], ['Sardinian', 'sardu', 'sc', 'srd', 'srd'], ['Swahili', 'Kiswahili', 'sw', 'swa', 'swa'], ['Uzbek', 'Ozbek, , ', 'uz', 'uzb', 'uzb'], ['Zhuang, Chuang', 'Sa cue, Saw cuengh', 'za', 'zha', 'zha'], ['Bislama', 'Bislama', 'bi', 'bis', 'bis'], ['Norwegian Bokml', 'Norsk Bokml', 'nb', 'nob', 'nob'], ['Norwegian Nynorsk', 'Norsk Nynorsk', 'nn', 'nno', 'nno'], ['Indonesian', 'Bahasa Indonesia', 'id', 'ind', 'ind'], ['Twi', 'Twi', 'tw', 'twi', 'twi'], ['Esperanto', 'Esperanto', 'eo', 'epo', 'epo'], ['Interlingua', 'Interlingua', 'ia', 'ina', 'ina'], ['Interlingue', 'Originally called Occidental; then Interlingue after WWII', 'ie', 'ile', 'ile'], ['Ido', 'Ido', 'io', 'ido', 'ido'], ['Volapk', 'Volapk', 'vo', 'vol', 'vol'], ['Bihari languages', '', 'bh', 'bih', 'bih'], ['Hebrew (modern)', '', 'he', 'heb', 'heb'], ['Sanskrit', '', 'sa', 'san', 'san'], ['Church Slavic, Church Slavonic, Old Church Slavonic, Old Slavonic, Old Bulgarian', ' ', 'cu', 'chu', 'chu'], ['Pali', '', 'pi', 'pli', 'pli'], ['Avestan', 'avesta', 'ae', 'ave', 'ave'], ['Latin', 'latine, lingua latina', 'la', 'lat', 'lat'], ['Armenian', '', 'hy', 'hye', 'arm'], ['Swati', 'SiSwati', 'ss', 'ssw', 'ssw'], ['Tibetan', '', 'bo', 'bod', 'tib'], ['South Ndebele', 'isiNdebele', 'nr', 'nbl', 'nbl'], ['Slovene', 'Slovenski Jezik, Slovenina', 'sl', 'slv', 'slv'], ['Oriya', '', 'or', 'ori', 'ori'], ['North Ndebele', 'isiNdebele', 'nd', 'nde', 'nde'], ['Nauru', 'Dorerin Naoero', 'na', 'nau', 'nau'], ['Maori', 'te reo Mori', 'mi', 'mri', 'mao'], ['Marathi', '', 'mr', 'mar', 'mar'], ['Luba-Katanga', 'Kiluba', 'lu', 'lub', 'lub'], ['Rundi', 'Ikirundi', 'rn', 'run', 'run'], ['Central Khmer', ', , ', 'km', 'khm', 'khm'], ['Western Frisian', 'Frysk', 'fy', 'fry', 'fry'], ['Bengali', '', 'bn', 'ben', 'ben'], ['Avaric', ' ,  ', 'av', 'ava', 'ava'], ['Abkhazian', ' , ', 'ab', 'abk', 'abk'], ['Afar', 'Afaraf', 'aa', 'aar', 'aar'], ['Afrikaans', 'Afrikaans', 'af', 'afr', 'afr'], ['Amharic', '', 'am', 'amh', 'amh'], ['Aragonese', 'aragons', 'an', 'arg', 'arg'], ['Assamese', '', 'as', 'asm', 'asm'], ['Bambara', 'bamanankan', 'bm', 'bam', 'bam'], ['Bashkir', ' ', 'ba', 'bak', 'bak'], ['Basque', 'euskara, euskera', 'eu', 'eus', 'baq'], ['Belarusian', ' ', 'be', 'bel', 'bel'], ['Bosnian', 'bosanski jezik', 'bs', 'bos', 'bos'], ['Breton', 'brezhoneg', 'br', 'bre', 'bre'], ['Bulgarian', ' ', 'bg', 'bul', 'bul'], ['Burmese', '', 'my', 'mya', 'bur'], ['Catalan, Valencian', 'catal, valenci', 'ca', 'cat', 'cat'], ['Chamorro', 'Chamoru', 'ch', 'cha', 'cha'], ['Chechen', ' ', 'ce', 'che', 'che'], ['Chichewa, Chewa, Nyanja', 'chiChea, chinyanja', 'ny', 'nya', 'nya'], ['Chuvash', ' ', 'cv', 'chv', 'chv'], ['Cornish', 'Kernewek', 'kw', 'cor', 'cor'], ['Corsican', 'corsu, lingua corsa', 'co', 'cos', 'cos'], ['Croatian', 'hrvatski jezik', 'hr', 'hrv', 'hrv'], ['Czech', 'etina, esk jazyk', 'cs', 'ces', 'cze'], ['Danish', 'dansk', 'da', 'dan', 'dan'], ['Divehi, Dhivehi, Maldivian', '', 'dv', 'div', 'div'], ['Dutch, Flemish', 'Nederlands, Vlaams', 'nl', 'nld', 'dut'], ['Dzongkha', '', 'dz', 'dzo', 'dzo'], ['English', 'English', 'en', 'eng', 'eng'], ['Ewe', 'Eegbe', 'ee', 'ewe', 'ewe'], ['Faroese', 'froyskt', 'fo', 'fao', 'fao'], ['Fijian', 'vosa Vakaviti', 'fj', 'fij', 'fij'], ['Finnish', 'suomi, suomen kieli', 'fi', 'fin', 'fin'], ['French', 'franais, langue franaise', 'fr', 'fra', 'fre'], ['Galician', 'Galego', 'gl', 'glg', 'glg'], ['Georgian', '', 'ka', 'kat', 'geo'], ['German', 'Deutsch', 'de', 'deu', 'ger'], ['Greek (modern)', '', 'el', 'ell', 'gre'], ['Gujarati', '', 'gu', 'guj', 'guj'], ['Haitian, Haitian Creole', 'Kreyl ayisyen', 'ht', 'hat', 'hat'], ['Hausa', '(Hausa) ', 'ha', 'hau', 'hau'], ['Herero', 'Otjiherero', 'hz', 'her', 'her'], ['Hindi', ', ', 'hi', 'hin', 'hin'], ['Hiri Motu', 'Hiri Motu', 'ho', 'hmo', 'hmo'], ['Hungarian', 'magyar', 'hu', 'hun', 'hun'], ['Irish', 'Gaeilge', 'ga', 'gle', 'gle'], ['Igbo', 'Ass Igbo', 'ig', 'ibo', 'ibo'], ['Icelandic', 'slenska', 'is', 'isl', 'ice'], ['Italian', 'Italiano', 'it', 'ita', 'ita'], ['Japanese', ' ()', 'ja', 'jpn', 'jpn'], ['Javanese', ', Basa Jawa', 'jv', 'jav', 'jav'], ['Kalaallisut, Greenlandic', 'kalaallisut, kalaallit oqaasii', 'kl', 'kal', 'kal'], ['Kannada', '', 'kn', 'kan', 'kan'], ['Kashmiri', ', ', 'ks', 'kas', 'kas'], ['Kazakh', ' ', 'kk', 'kaz', 'kaz'], ['Kikuyu, Gikuyu', 'Gky', 'ki', 'kik', 'kik'], ['Kinyarwanda', 'Ikinyarwanda', 'rw', 'kin', 'kin'], ['Kirghiz, Kyrgyz', ',  ', 'ky', 'kir', 'kir'], ['Korean', '', 'ko', 'kor', 'kor'], ['Kuanyama, Kwanyama', 'Kuanyama', 'kj', 'kua', 'kua'], ['Luxembourgish, Letzeburgesch', 'Ltzebuergesch', 'lb', 'ltz', 'ltz'], ['Ganda', 'Luganda', 'lg', 'lug', 'lug'], ['Limburgan, Limburger, Limburgish', 'Limburgs', 'li', 'lim', 'lim'], ['Lingala', 'Lingla', 'ln', 'lin', 'lin'], ['Lao', '', 'lo', 'lao', 'lao'], ['Lithuanian', 'lietuvi kalba', 'lt', 'lit', 'lit'], ['Manx', 'Gaelg, Gailck', 'gv', 'glv', 'glv'], ['Macedonian', ' ', 'mk', 'mkd', 'mac'], ['Malayalam', '', 'ml', 'mal', 'mal'], ['Maltese', 'Malti', 'mt', 'mlt', 'mlt'], ['Marshallese', 'Kajin Maje', 'mh', 'mah', 'mah'], ['Navajo, Navaho', 'Din bizaad', 'nv', 'nav', 'nav'], ['Nepali', '', 'ne', 'nep', 'nep'], ['Ndonga', 'Owambo', 'ng', 'ndo', 'ndo'], ['Occitan', 'occitan, lenga d\\'c', 'oc', 'oci', 'oci'], ['Ossetian, Ossetic', ' ', 'os', 'oss', 'oss'], ['Panjabi, Punjabi', '', 'pa', 'pan', 'pan'], ['Polish', 'jzyk polski, polszczyzna', 'pl', 'pol', 'pol'], ['Portuguese', 'Portugus', 'pt', 'por', 'por'], ['Romansh', 'Rumantsch Grischun', 'rm', 'roh', 'roh'], ['Russian', '', 'ru', 'rus', 'rus'], ['Sindhi', ',  ', 'sd', 'snd', 'snd'], ['Northern Sami', 'Davvismegiella', 'se', 'sme', 'sme'], ['Samoan', 'gagana fa\\'a Samoa', 'sm', 'smo', 'smo'], ['Sango', 'yng t sng', 'sg', 'sag', 'sag'], ['Gaelic, Scottish Gaelic', 'Gidhlig', 'gd', 'gla', 'gla'], ['Shona', 'chiShona', 'sn', 'sna', 'sna'], ['Sinhala, Sinhalese', '', 'si', 'sin', 'sin'], ['Slovak', 'Slovenina, Slovensk Jazyk', 'sk', 'slk', 'slo'], ['Somali', 'Soomaaliga, af Soomaali', 'so', 'som', 'som'], ['Southern Sotho', 'Sesotho', 'st', 'sot', 'sot'], ['Spanish, Castilian', 'Espaol', 'es', 'spa', 'spa'], ['Sundanese', 'Basa Sunda', 'su', 'sun', 'sun'], ['Swedish', 'Svenska', 'sv', 'swe', 'swe'], ['Tamil', '', 'ta', 'tam', 'tam'], ['Telugu', '', 'te', 'tel', 'tel'], ['Tajik', ', toik, ', 'tg', 'tgk', 'tgk'], ['Thai', '', 'th', 'tha', 'tha'], ['Tigrinya', '', 'ti', 'tir', 'tir'], ['Turkmen', 'Trkmen, ', 'tk', 'tuk', 'tuk'], ['Tswana', 'Setswana', 'tn', 'tsn', 'tsn'], ['Tongan (Tonga Islands)', 'Faka Tonga', 'to', 'ton', 'ton'], ['Turkish', 'Trke', 'tr', 'tur', 'tur'], ['Tsonga', 'Xitsonga', 'ts', 'tso', 'tso'], ['Tatar', ' , tatar tele', 'tt', 'tat', 'tat'], ['Uighur, Uyghur', ', Uyghurche', 'ug', 'uig', 'uig'], ['Ukrainian', '', 'uk', 'ukr', 'ukr'], ['Urdu', '', 'ur', 'urd', 'urd'], ['Venda', 'Tshivena', 've', 'ven', 'ven'], ['Vietnamese', 'Ting Vit', 'vi', 'vie', 'vie'], ['Walloon', 'Walon', 'wa', 'wln', 'wln'], ['Welsh', 'Cymraeg', 'cy', 'cym', 'wel'], ['Wolof', 'Wollof', 'wo', 'wol', 'wol'], ['Xhosa', 'isiXhosa', 'xh', 'xho', 'xho'], ['Yoruba', 'Yorb', 'yo', 'yor', 'yor'], ['Zulu', 'isiZulu', 'zu', 'zul', 'zul']];\nexports[\"default\"] = _default;"],"sourceRoot":""}