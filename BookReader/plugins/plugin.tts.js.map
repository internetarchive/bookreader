{"version":3,"sources":["webpack://@internetarchive/bookreader/./src/js/plugins/tts/PageChunk.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/PageChunkIterator.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/AbstractTTSEngine.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/utils.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/FestivalTTSEngine.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/plugin.tts.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/WebTTSEngine.js","webpack://@internetarchive/bookreader/./src/js/plugins/tts/tooltip_dict.js","webpack://@internetarchive/bookreader/./src/util/browserSniffing.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/function-bind.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.object.assign.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.object.get-prototype-of.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.reflect.construct.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.match.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.starts-with.js","webpack://@internetarchive/bookreader/./node_modules/iso-language-codes/js/data.js"],"names":["PageChunk","leafIndex","chunkIndex","text","lineRects","this","server","bookPath","Promise","res","rej","$","ajax","type","url","dataType","cache","data","path","page","error","then","chunks","_fromTextWrapperResponse","chunksResponse","map","c","i","correctedLineRects","_fixChunkRects","slice","correctedText","_removeDanglingHyphens","rects","length","firstRect","secondRect","left","bottom","width","secondHeight","secondWidth","secondRight","replace","PageChunkIterator","pageCount","start","opts","Object","assign","DEFAULT_OPTS","_cursor","chunk","_bufferedPages","_bufferingPages","_cursorLock","resolve","_nextUncontrolled","_decrementUncontrolled","AT_END","_recenterBuffer","_fetchPageChunks","cursorChangePromise","prevPageChunks","index","Math","max","pageBufferSize","end","min","_removePageFromBuffer","_fetchPageChunksDirect","fetch","AbstractTTSEngine","options","playing","paused","_chunkIterator","activeSound","playbackRate","events","voice","on","getBestBookVoice","getVoices","bookLanguage","trigger","Error","voices","userLanguages","navigator","languages","bookLangVoices","filter","v","lang","startsWith","matchingUserLangs","language","getMatchingVoice","find","default","matchingVoices","numLeafs","onLoadingStart","step","stop","fireEvent","pause","resume","finish","all","decrement","newRate","setPlaybackRate","next","onDone","sound","createSound","rate","load","onLoadingComplete","beforeChunkPlay","playPromise","playSound","afterChunkPlay","loaded","play","promisifyEvent","target","eventType","addEventListener","resolver","ev","removeEventListener","sleep","ms","setTimeout","isAndroid","userAgent","test","COLUMN_TO_LANG_INDEX","searchForISO6391","columnsToSearch","langs","colI","column","split","x","toLowerCase","indexOf","FestivalTTSEngine","audioFormat","browser","mozilla","soundManager","supported","localService","name","voiceURI","setup","debugMode","preferFlash","useHTML5Audio","flashVersion","promise","match","iOSCaptureUserIntentHack","FestivalTTSSound","getSoundUrl","dataString","encodeURIComponent","SILENCE_1MS","onfinish","destruct","soundUrl","_finishResolver","onload","onresume","mp3","ogg","super_","WebTTSEngine","speechSynthesis","window","audio","Audio","SILENCE_6S_MP3","loop","src","mediaSession","metadata","MediaMetadata","title","br","bookTitle","artist","m","label","value","artwork","thumbnail","setActionHandler","jumpBackward","jumpForward","WebTTSSound","started","stopped","utterance","_lastEvents","boundary","_charIndex","_finishPromise","SpeechSynthesisUtterance","location","toString","console","log","dispatchEvent","CustomEvent","wasPaused","recentEvent","charIndex","cancel","speak","isLocalVoice","isChrome","_chromePausingBugFix","endPromise","race","Event","pausePromise","pauseMightNotWork","isFirefox","timeoutPromise","result","resumeMightNotWork","resumeMightNotFire","resumePromise","reload","en","jQuery","extend","BookReader","defaultOptions","enableTtsPlugin","prototype","call","ttsHilites","TTSEngine","isSupported","engineName","festival","web","ttsEngine","showProgressPopup","bind","removeProgressPopup","ttsStop","ttsBeforeChunkPlay","ttsSendChunkFinishedAnalyticsEvent","init","eventNames","fragmentChange","mode","constMode2up","visibleSelector","twoPage","currentIndexL","currentIndexR","join","show","not","hide","PostInit","click","ttsToggle","ttsStart","buildMobileDrawerElement","$el","after","imagesBaseURL","initNavbar","refs","$BRReadAloudToolbar","prepend","ttsUpdateState","ttsPlayPause","ttsJumpForward","ttsJumpBackward","$rateSelector","change","parseFloat","val","tooltips","insertBefore","closest","autoStop","startTTSEngine","constModeThumb","switchMode","constMode1up","addClass","ttsSendAnalyticsEvent","currentIndex","getNumLeafs","isPlaying","toggleClass","togglePlayPause","removeClass","ttsRemoveHilites","ttsMaybeFlipToIndex","ttsHighlightChunk","ttsScrollToChunk","in2PageMode","animationFinishedCallback","prev","jumpToIndex","ttsHilite2UP","ttsHilite1UP","leafTop","parseInt","_getPageHeight","reduce","padding","chunkTop","chunkBot","topOfFirstChunk","botOfLastChunk","containerTop","$brContainer","prop","containerBot","height","animate","scrollTop","l","b","r","t","div","document","createElement","push","appendTo","css","top","$brTwoPageView","setHilightCss2UP","remove","action","archiveAnalyticsSendEvent","extraValues","mediaLanguage","vendor","isSafari","aFunction","isObject","factories","construct","C","argsLength","args","list","Function","module","exports","that","fn","partArgs","arguments","boundFunction","concat","apply","stat","forced","fails","toObject","nativeGetPrototypeOf","CORRECT_PROTOTYPE_GETTER","sham","getPrototypeOf","it","getBuiltIn","anObject","create","nativeConstruct","NEW_TARGET_BUG","F","ARGS_BUG","FORCED","Target","newTarget","$args","proto","instance","fixRegExpWellKnownSymbolLogic","toLength","requireObjectCoercible","advanceStringIndex","regExpExec","MATCH","nativeMatch","maybeCallNative","regexp","O","matcher","undefined","RegExp","String","done","rx","S","global","fullUnicode","unicode","lastIndex","A","n","matchStr","descriptor","getOwnPropertyDescriptor","notARegExp","correctIsRegExpLogic","IS_PURE","nativeStartsWith","CORRECT_IS_REGEXP_LOGIC","writable","searchString","search"],"mappings":"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","file":"plugins/plugin.tts.js","sourcesContent":["/**\n * Class to manage a 'chunk' (approximately a paragraph) of text on a page.\n */\nexport default class PageChunk {\n  /**\n   * @param {number} leafIndex\n   * @param {number} chunkIndex\n   * @param {string} text\n   * @param {DJVURect[]} lineRects\n   */\n  constructor(leafIndex, chunkIndex, text, lineRects) {\n    this.leafIndex = leafIndex;\n    this.chunkIndex = chunkIndex;\n    this.text = text;\n    this.lineRects = lineRects;\n  }\n\n  /**\n   * @param {string} server\n   * @param {string} bookPath\n   * @param {number} leafIndex\n   * @return {Promise<PageChunk[]>}\n   */\n  static fetch(server, bookPath, leafIndex) {\n    // jquery's ajax \"PromiseLike\" implementation is inconsistent with\n    // modern Promises, so convert it to a full promise (it doesn't forward\n    // a returned promise to the next handler in the chain, which kind of\n    // defeats the entire point of using promises to avoid \"callback hell\")\n    return new Promise((res, rej) => {\n      $.ajax({\n        type: 'GET',\n        url: `https://${server}/BookReader/BookReaderGetTextWrapper.php`,\n        dataType:'jsonp',\n        cache: true,\n        data: {\n          path: `${bookPath}_djvu.xml`,\n          page: leafIndex\n        },\n        error: rej,\n      })\n        .then(chunks => {\n          res(PageChunk._fromTextWrapperResponse(leafIndex, chunks));\n        });\n    });\n  }\n\n  /**\n   * Convert the response from BookReaderGetTextWrapper.php into a {@link PageChunk} instance\n   * @param {number} leafIndex\n   * @param {Array<[String, ...DJVURect[]]>} chunksResponse\n   * @return {PageChunk[]}\n   */\n  static _fromTextWrapperResponse(leafIndex, chunksResponse) {\n    return chunksResponse.map((c, i) => {\n      const correctedLineRects = PageChunk._fixChunkRects(c.slice(1));\n      const correctedText = PageChunk._removeDanglingHyphens(c[0]);\n      return new PageChunk(leafIndex, i, correctedText, correctedLineRects);\n    });\n  }\n\n  /**\n   * @private\n   * Sometimes the first rectangle will be ridiculously wide/tall. Find those and fix them\n   * *NOTE*: Modifies the original array and returns it.\n   * *NOTE*: This should probably be fixed on the petabox side, and then removed here\n   * Has 2 problems:\n   *  - If the rect is the last rect on the page (and hence the only rect in the array),\n   *    the rect's size isn't fixed\n   * - Because this relies on the second rect, there's a chance it won't be the right\n   *   width\n   * @param {DJVURect[]} rects\n   * @return {DJVURect[]}\n   */\n  static _fixChunkRects(rects) {\n    if (rects.length < 2) return rects;\n\n    const [firstRect, secondRect] = rects;\n    const [left, bottom, right] = firstRect;\n    const width = right - left;\n    const secondHeight = secondRect[1] - secondRect[3];\n    const secondWidth = secondRect[2] - secondRect[0];\n    const secondRight = secondRect[2];\n\n    if (width > secondWidth * 30) {\n      // Set the end to be the same\n      firstRect[2] = secondRight;\n      // And the top to be the same height\n      firstRect[3] = bottom - secondHeight;\n    }\n\n    return rects;\n  }\n\n  /**\n   * Remove \"dangling\" hyphens from read aloud text to avoid TTS stuttering\n   * @param {string} text\n   * @return {string}\n   */\n  static _removeDanglingHyphens(text) {\n    return text.replace(/-\\s+/g, '');\n  }\n}\n\n/**\n * @typedef {[number, number, number, number]} DJVURect\n * coords are in l,b,r,t order\n */\n","import PageChunk from './PageChunk.js';\n\n/**\n * Class that iterates over the page chunks of a book; caching/buffering\n * as much as possible to try to ensure a smooth experience.\n */\nexport default class PageChunkIterator {\n  /**\n   * @param {number} pageCount total number of pages\n   * @param {number} start page to start on\n   * @param {PageChunkIteratorOptions} opts\n   */\n  constructor(pageCount, start, opts) {\n    this.pageCount = pageCount;\n    this.opts = Object.assign({}, DEFAULT_OPTS, opts);\n    /** Position in the chunk sequence */\n    this._cursor = { page: start, chunk: 0 };\n    /** @type {Object<number, PageChunk[]>} leaf index -> chunks*/\n    this._bufferedPages = {};\n    /** @type {Object<number, PromiseLike<PageChunk[]>} leaf index -> chunks*/\n    this._bufferingPages = {};\n    /**\n     * @type {Promise} promise that manages cursor modifications so that they\n     * happen in order triggered as opposed to order the server responds\n     **/\n    this._cursorLock = Promise.resolve();\n  }\n\n  /**\n   * Get the next chunk\n   * @return {PromiseLike<\"__PageChunkIterator.AT_END__\" | PageChunk>}\n   */\n  next() {\n    return this._cursorLock = this._cursorLock\n      .then(() => this._nextUncontrolled());\n  }\n\n  /**\n   * Sends the cursor back 1\n   * @return {Promise}\n   **/\n  decrement() {\n    return this._cursorLock = this._cursorLock\n      .then(() => this._decrementUncontrolled());\n  }\n\n  /**\n   * Gets without ensuring synchronization. Since this iterator has a lot of async\n   * code, calling e.g. \"next\" twice (before the first call to next has finished)\n   * would cause the system to be in a weird state. To avoid that, we make sure calls\n   * to next and decrement (functions that modify the cursor) are synchronized,\n   * so that regardless how long it takes for one to respond, they'll always be executed\n   * in the correct order.\n   * @return {PromiseLike<\"__PageChunkIterator.AT_END__\" | PageChunk>}\n   */\n  _nextUncontrolled() {\n    if (this._cursor.page == this.pageCount) {\n      return Promise.resolve(PageChunkIterator.AT_END);\n    }\n\n    this._recenterBuffer(this._cursor.page);\n\n    return this._fetchPageChunks(this._cursor.page)\n      .then(chunks => {\n        if (this._cursor.chunk == chunks.length) {\n          this._cursor.page++;\n          this._cursor.chunk = 0;\n          return this._nextUncontrolled();\n        }\n        return chunks[this._cursor.chunk++];\n      });\n  }\n\n  /**\n   * Decrements without ensuring synchronization. (See {@link PageChunkIterator._nextUncontrolled});\n   * @return {Promise}\n   */\n  _decrementUncontrolled() {\n    let cursorChangePromise = Promise.resolve();\n\n    if (this._cursor.chunk > 0) {\n      this._cursor.chunk--;\n    } else if (this._cursor.page > 0) {\n      this._cursor.page--;\n      // Go back possibly multiple pages, because pages can be blank\n      cursorChangePromise = this._fetchPageChunks(this._cursor.page)\n        .then(prevPageChunks => {\n          if (prevPageChunks.length == 0) return this._decrementUncontrolled();\n          else this._cursor.chunk = prevPageChunks.length - 1;\n        });\n    }\n\n    return cursorChangePromise\n      .then(() => this._fetchPageChunks(this._cursor.page));\n  }\n\n  /**\n   * Recenter the buffer around the provided page index\n   * @param {number} index\n   */\n  _recenterBuffer(index) {\n    const start = Math.max(0, index - this.opts.pageBufferSize);\n    const end = Math.min(this.pageCount, index + this.opts.pageBufferSize + 1);\n    for (let i = start; i < end; i++) {\n      this._fetchPageChunks(i);\n    }\n\n    this._removePageFromBuffer(start - 1);\n    this._removePageFromBuffer(end + 1);\n  }\n\n  /**\n   * @param {number} index\n   */\n  _removePageFromBuffer(index) {\n    delete this._bufferingPages[index];\n    delete this._bufferedPages[index];\n  }\n\n  /**\n   * Fetches the chunks on a page; checks the buffer, so it won't make unnecessary\n   * requests if it's called multiple times for the same index.\n   * @param {number} index\n   * @return {Promise<PageChunk[]>}\n   */\n  _fetchPageChunks(index) {\n    if (index in this._bufferingPages) return this._bufferingPages[index];\n    if (index in this._bufferedPages) return Promise.resolve(this._bufferedPages[index]);\n\n    this._bufferingPages[index] = this._fetchPageChunksDirect(index)\n      .then(chunks => {\n        delete this._bufferingPages[index];\n        this._bufferedPages[index] = chunks;\n        return chunks;\n      });\n\n    return this._bufferingPages[index];\n  }\n\n  /**\n   * Fetches a page without checking buffer\n   * @param {number} index\n   */\n  _fetchPageChunksDirect(index) {\n    return PageChunk.fetch(this.opts.server, this.opts.bookPath, index);\n  }\n}\n\nPageChunkIterator.AT_END = \"__PageChunkIterator.AT_END__\";\n\n/** @type {PageChunkIteratorOptions} */\nconst DEFAULT_OPTS = {\n  server: null,\n  bookPath: null,\n  pageBufferSize: 2,\n};\n\n/**\n * @typedef {Object} PageChunkIteratorOptions\n * @property {string} server\n * @property {string} bookPath\n * @property {number} [pageBufferSize] number of pages to buffer before/after the current page\n */\n","import PageChunkIterator from './PageChunkIterator.js';\n/** @typedef {import('./utils.js').ISO6391} ISO6391 */\n/** @typedef {import('./PageChunk.js')} PageChunk */\n\n/**\n * @export\n * @typedef {Object} TTSEngineOptions\n * @property {String} server\n * @property {String} bookPath\n * @property {ISO6391} bookLanguage\n * @property {Function} onLoadingStart\n * @property {Function} onLoadingComplete\n * @property {Function} onDone called when the entire book is done\n * @property {function(PageChunk): PromiseLike} beforeChunkPlay will delay the playing of the chunk\n * @property {function(PageChunk): void} afterChunkPlay fires once a chunk has fully finished\n */\n\n/**\n * @typedef {Object} AbstractTTSSound\n * @property {PageChunk} chunk\n * @property {boolean} loaded\n * @property {number} rate\n * @property {SpeechSynthesisVoice} voice\n * @property {(callback: Function) => void} load\n * @property {() => PromiseLike} play\n * @property {() => Promise} stop\n * @property {() => void} pause\n * @property {() => void} resume\n * @property {() => void} finish force the sound to 'finish'\n * @property {number => void} setPlaybackRate\n **/\n\n/** Handling bookreader's text-to-speech */\nexport default class AbstractTTSEngine {\n  /**\n   * @protected\n   * @param {TTSEngineOptions} options\n   */\n  constructor(options) {\n    this.playing = false;\n    this.paused = false;\n    this.opts = options;\n    /** @type {PageChunkIterator} */\n    this._chunkIterator = null;\n    /** @type {AbstractTTSSound} */\n    this.activeSound = null;\n    this.playbackRate = 1;\n    /** Events we can bind to */\n    this.events = $({});\n    /** @type {SpeechSynthesisVoice} */\n    this.voice = null;\n    // Listen for voice changes (fired by subclasses)\n    this.events.on('voiceschanged', () => {\n      this.voice = AbstractTTSEngine.getBestBookVoice(this.getVoices(), this.opts.bookLanguage);\n    });\n    this.events.trigger('voiceschanged');\n  }\n\n  /**\n   * @abstract\n   * @return {boolean}\n   */\n  static isSupported() { throw new Error(\"Unimplemented abstract class\"); }\n\n  /**\n   * @abstract\n   * @return {SpeechSynthesisVoice[]}\n   */\n  getVoices() { throw new Error(\"Unimplemented abstract class\"); }\n\n  /** @abstract */\n  init() { return null; }\n\n  /**\n   * @param {number} leafIndex\n   * @param {number} numLeafs total number of leafs in the current book\n   */\n  start(leafIndex, numLeafs) {\n    this.playing = true;\n    this.opts.onLoadingStart();\n\n    this._chunkIterator = new PageChunkIterator(numLeafs, leafIndex, {\n      server: this.opts.server,\n      bookPath: this.opts.bookPath,\n      pageBufferSize: 5,\n    });\n\n    this.step();\n    this.events.trigger('start');\n  }\n\n  stop() {\n    if (this.activeSound) this.activeSound.stop();\n    this.playing = false;\n    this._chunkIterator = null;\n    this.activeSound = null;\n    this.events.trigger('stop');\n  }\n\n  /** @public */\n  pause() {\n    const fireEvent = !this.paused && this.activeSound;\n    this.paused = true;\n    if (this.activeSound) this.activeSound.pause();\n    if (fireEvent) this.events.trigger('pause');\n  }\n\n  /** @public */\n  resume() {\n    const fireEvent = this.paused && this.activeSound;\n    this.paused = false;\n    if (this.activeSound) this.activeSound.resume();\n    if (fireEvent) this.events.trigger('resume');\n  }\n\n  togglePlayPause() {\n    if (this.paused) this.resume();\n    else this.pause();\n  }\n\n  /** @public */\n  jumpForward() {\n    if (this.activeSound) this.activeSound.finish();\n  }\n\n  /** @public */\n  jumpBackward() {\n    Promise.all([\n      this.activeSound.stop(),\n      this._chunkIterator.decrement()\n        .then(() => this._chunkIterator.decrement())\n    ])\n      .then(() => this.step());\n  }\n\n  /** @param {number} newRate */\n  setPlaybackRate(newRate) {\n    this.playbackRate = newRate;\n    if (this.activeSound) this.activeSound.setPlaybackRate(newRate);\n  }\n\n  /** @private */\n  step() {\n    this._chunkIterator.next()\n      .then(chunk => {\n        if (chunk == PageChunkIterator.AT_END) {\n          this.stop();\n          this.opts.onDone();\n          return;\n        }\n\n        this.opts.onLoadingStart();\n        const sound = this.createSound(chunk);\n        sound.chunk = chunk;\n        sound.rate = this.playbackRate;\n        sound.voice = this.voice;\n        sound.load(() => this.opts.onLoadingComplete());\n\n        this.opts.onLoadingComplete();\n        return this.opts.beforeChunkPlay(chunk).then(() => sound);\n      })\n      .then(sound => {\n        if (!this.playing) return;\n\n        const playPromise = this.playSound(sound)\n          .then(() => this.opts.afterChunkPlay(sound.chunk));\n        if (this.paused) this.pause();\n        return playPromise;\n      })\n      .then(() => {\n        if (this.playing) return this.step();\n      });\n  }\n\n  /**\n   * @abstract\n   * @param {PageChunk} chunk\n   * @return {AbstractTTSSound}\n   */\n  createSound(chunk) { throw new Error(\"Unimplemented abstract class\"); }\n\n  /**\n   * @param {AbstractTTSSound} sound\n   * @return {PromiseLike} promise called once playing finished\n   */\n  playSound(sound) {\n    this.activeSound = sound;\n    if (!this.activeSound.loaded) this.opts.onLoadingStart();\n    return this.activeSound.play();\n  }\n\n  /** Convenience wrapper for {@see AbstractTTSEngine.getBestVoice} */\n  getBestVoice() {\n    return AbstractTTSEngine.getBestBookVoice(this.getVoices(), this.opts.bookLanguage);\n  }\n\n  /**\n   * @private\n   * Find the best voice to use given the available voices, the book language, and the user's\n   * languages.\n   * @param {SpeechSynthesisVoice[]} voices\n   * @param {ISO6391} bookLanguage\n   * @param {string[]} userLanguages languages in BCP47 format (e.g. en-US). Ordered by preference.\n   * @return {SpeechSynthesisVoice | undefined}\n   */\n  static getBestBookVoice(voices, bookLanguage, userLanguages = navigator.languages) {\n    const bookLangVoices = voices.filter(v => v.lang.startsWith(bookLanguage));\n    // navigator.languages browser support isn't great yet, so get just 1 language otherwise\n    // Sample navigator.languages: [\"en-CA\", \"fr-CA\", \"fr\", \"en-US\", \"en\", \"de-DE\", \"de\"]\n    userLanguages = userLanguages || (navigator.language ? [navigator.language] : []);\n\n    // user languages that match the book language\n    const matchingUserLangs = userLanguages.filter(lang => lang.startsWith(bookLanguage));\n\n    // Try to find voices that intersect these two sets\n    return AbstractTTSEngine.getMatchingVoice(matchingUserLangs, bookLangVoices) ||\n        // no user languages match the books; let's return the best voice for the book language\n        (bookLangVoices.find(v => v.default) || bookLangVoices[0])\n        // No voices match the book language? let's find a voice in the user's language\n        // and ignore book lang\n        || AbstractTTSEngine.getMatchingVoice(userLanguages, voices)\n        // C'mon! Ok, just read with whatever we got!\n        || (voices.find(v => v.default) || voices[0]);\n  }\n\n  /**\n     * @private\n     * Get the best voice that matches one of the BCP47 languages (order by preference)\n     * @param {string[]} languages in BCP 47 format (e.g. 'en-US', or 'en'); ordered by preference\n     * @param {SpeechSynthesisVoice[]} voices voices to choose from\n     * @return {SpeechSynthesisVoice | undefined}\n     */\n  static getMatchingVoice(languages, voices) {\n    for (const lang of languages) {\n      // Chrome Android was returning voice languages like `en_US` instead of `en-US`\n      const matchingVoices = voices.filter(v => v.lang.replace('_', '-').startsWith(lang));\n      if (matchingVoices.length) {\n        return matchingVoices.find(v => v.default) || matchingVoices[0];\n      }\n    }\n  }\n}\n","import langs from 'iso-language-codes/js/data.js';\n\n/**\n * Convert a EventTarget style event into a promise\n * @param {EventTarget} target\n * @param {string} eventType\n * @return {Promise<Event>}\n */\nexport function promisifyEvent(target, eventType) {\n  return new Promise(res => {\n    const resolver = ev => {\n      target.removeEventListener(eventType, resolver);\n      res(ev);\n    };\n    target.addEventListener(eventType, resolver);\n  });\n}\n\n/**\n * Use regex to approximate word count in a string\n * @param {string} text\n * @return {number}\n */\nexport function approximateWordCount(text) {\n  const m = text.match(/\\S+/g);\n  return m ? m.length : 0;\n}\n\n/**\n * Waits the provided number of ms and then resolves with a promise\n * @param {number} ms\n * @return {Promise}\n */\nexport function sleep(ms) {\n  return new Promise(res => setTimeout(res, ms));\n}\n\n/**\n * Checks whether the current browser is on android\n * @param {string} [userAgent]\n * @return {boolean}\n */\nexport function isAndroid(userAgent = navigator.userAgent) {\n  return /android/i.test(userAgent);\n}\n\n/**\n * @typedef {string} ISO6391\n * Language code in ISO 639-1 format. e.g. en, fr, zh\n **/\n\n/** Each lang is an array, with each index mapping to a different property */\nconst COLUMN_TO_LANG_INDEX = {\n  'Name': 0,\n  'Endonym': 1,\n  'ISO 639-1': 2,\n  'ISO 639-2/T': 3,\n  'ISO 639-2/B': 4\n};\n\n/**\n * @param {string} language in some format\n * @return {ISO6391?}\n */\nexport function toISO6391(language) {\n  if (!language) return null;\n  language = language.toLowerCase();\n\n  return searchForISO6391(language, ['ISO 639-1']) ||\n    searchForISO6391(language, ['ISO 639-2/B']) ||\n    searchForISO6391(language, ['ISO 639-2/T', 'Endonym', 'Name']);\n}\n\n/**\n * Searches for the given long in the given columns.\n * @param {string} language\n * @param {Array<keyof COLUMN_TO_LANG_INDEX>} columnsToSearch\n * @return {ISO6391?}\n */\nfunction searchForISO6391(language, columnsToSearch) {\n  for (let i = 0; i < langs.length; i++) {\n    for (let colI = 0; colI < columnsToSearch.length; colI++) {\n      const column = columnsToSearch[colI];\n      const columnValue = langs[i][COLUMN_TO_LANG_INDEX[column]];\n      if (columnValue.split(', ').map(x => x.toLowerCase()).indexOf(language) != -1) {\n        return langs[i][COLUMN_TO_LANG_INDEX['ISO 639-1']];\n      }\n    }\n  }\n  return null;\n}\n","/* global soundManager */\nimport AbstractTTSEngine from './AbstractTTSEngine.js';\nimport { sleep } from './utils.js';\n\n/** @typedef {import(\"./AbstractTTSEngine.js\").TTSEngineOptions} TTSEngineOptions */\n/** @typedef {import(\"./AbstractTTSEngine.js\").AbstractTTSSound} AbstractTTSSound */\n\n/**\n * @extends AbstractTTSEngine\n * TTS using Festival endpoint\n **/\nexport default class FestivalTTSEngine extends AbstractTTSEngine {\n  /** @override */\n  static isSupported() {\n    return typeof(soundManager) !== 'undefined' && soundManager.supported();\n  }\n\n  /** @param {TTSEngineOptions} options */\n  constructor(options) {\n    super(options);\n    // $.browsers is sometimes undefined on some Android browsers :/\n    // Likely related to when $.browser was moved to npm\n    /** @type {'mp3' | 'ogg'} format of audio to get */\n    this.audioFormat = $.browser?.mozilla ? 'ogg' : 'mp3';\n  }\n\n  /** @override */\n  getVoices() {\n    return [\n      { default: true, lang: \"en-US\", localService: false, name: \"Festival - English (US)\", voiceURI: null }\n    ];\n  }\n\n  /** @override */\n  init() {\n    // setup sound manager\n    soundManager.setup({\n      debugMode: false,\n      // Note, there's a bug in Chrome regarding range requests.\n      // Flash is used as a workaround.\n      // See https://bugs.chromium.org/p/chromium/issues/detail?id=505707\n      preferFlash: true,\n      url: '/bookreader/BookReader/soundmanager/swf',\n      useHTML5Audio: true,\n      //flash 8 version of swf is buggy when calling play() on a sound that is still loading\n      flashVersion: 9\n    });\n  }\n\n  /**\n   * @override\n   * @param {number} leafIndex\n   * @param {number} numLeafs total number of leafs in the current book\n   */\n  start(leafIndex, numLeafs) {\n    let promise = null;\n\n    // Hack for iOS\n    if (navigator.userAgent.match(/mobile/i)) {\n      promise = this.iOSCaptureUserIntentHack();\n    }\n\n    promise = promise || Promise.resolve();\n    promise.then(() => super.start(leafIndex, numLeafs));\n  }\n\n  /** @override */\n  createSound(chunk) {\n    return new FestivalTTSSound(this.getSoundUrl(chunk.text));\n  }\n\n  /**\n   * @private\n   * Get URL for audio that says this text\n   * @param {String} dataString the thing to say\n   * @return {String} url\n   */\n  getSoundUrl(dataString) {\n    return 'https://' + this.opts.server + '/BookReader/BookReaderGetTTS.php?string='\n                  + encodeURIComponent(dataString)\n                  + '&format=.' + this.audioFormat;\n  }\n\n  /**\n   * @private\n   * Security restrictions require playback to be triggered\n   * by a user click/touch. This intention gets lost in the async calls\n   * on iOS, but, for some reason, if we start the audio here, it works.\n   * See https://stackoverflow.com/questions/12206631/html5-audio-cant-play-through-javascript-unless-triggered-manually-once\n   * @return {PromiseLike}\n   */\n  iOSCaptureUserIntentHack() {\n    const sound = soundManager.createSound({ url: SILENCE_1MS[this.audioFormat] });\n    return new Promise(res => sound.play({onfinish: res}))\n      .then(() => sound.destruct());\n  }\n}\n\n/** @extends AbstractTTSSound */\nclass FestivalTTSSound {\n  /** @param {string} soundUrl **/\n  constructor(soundUrl) {\n    this.soundUrl = soundUrl;\n    /** @type {SMSound} */\n    this.sound = null;\n    this.rate = 1;\n    /** @type {function} calling this resolves the \"play\" promise */\n    this._finishResolver = null\n  }\n\n  get loaded() {\n    return this.sound && this.sound.loaded;\n  }\n\n  load(onload) {\n    this.sound = soundManager.createSound({\n      url: this.soundUrl,\n      // API recommended, but only fires once play started on safari\n      onload: () => {\n        if (this.rate != 1) this.sound.setPlaybackRate(this.rate);\n        onload();\n      },\n      onresume: () => {\n        sleep(25).then(() => {\n          if (this.rate != 1) this.sound.setPlaybackRate(this.rate);\n        });\n      }\n    });\n    return this.sound.load();\n  }\n\n  play() {\n    return new Promise(res => {\n      this._finishResolver = res;\n      this.sound.play({ onfinish: res });\n    })\n      .then(() => this.sound.destruct());\n  }\n\n  /** @override */\n  stop() {\n    this.sound.stop();\n    return Promise.resolve();\n  }\n\n  /** @override */\n  pause() { this.sound.pause(); }\n  /** @override */\n  resume() { this.sound.resume(); }\n  /** @override */\n  setPlaybackRate(rate) {\n    this.rate = rate;\n    this.sound.setPlaybackRate(rate);\n  }\n\n  /** @override */\n  finish() {\n    this.sound.stop();\n    this._finishResolver();\n  }\n}\n\n/** Needed to capture the audio context for iOS hack. Generated using Audacity. */\nconst SILENCE_1MS = {\n  mp3: 'data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA//////////////////////////////////////////////////////////////////8AAAAeTEFNRTMuOTlyBJwAAAAAAAAAADUgJAaUQQABrgAAAnHIf8sZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//sQxAADwlwBKGAAACAAAD/AAAAEAAAAH///////////////+UBAMExBTUUzLjk5LjOqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+xDEIAPAAAGkAAAAIAAANIAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==',\n  ogg: 'data:audio/ogg;base64,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',\n};\n","/* global BookReader, soundManager */\n/**\n * Plugin for Text to Speech in BookReader\n */\nimport FestivalTTSEngine from './FestivalTTSEngine.js';\nimport WebTTSEngine from './WebTTSEngine.js';\nimport { toISO6391, approximateWordCount } from './utils.js';\nimport { en as tooltips } from './tooltip_dict.js';\n/** @typedef {import('./PageChunk.js')} PageChunk */\n/** @typedef {import(\"./AbstractTTSEngine.js\")} AbstractTTSEngine */\n\n// Default options for TTS\njQuery.extend(BookReader.defaultOptions, {\n  server: 'ia600609.us.archive.org',\n  bookPath: '',\n  enableTtsPlugin: true,\n});\n\n// Extend the constructor to add TTS properties\nBookReader.prototype.setup = (function (super_) {\n  return function (options) {\n    super_.call(this, options);\n\n    if (this.options.enableTtsPlugin) {\n      this.ttsHilites = [];\n      let TTSEngine = WebTTSEngine.isSupported() ? WebTTSEngine :\n        FestivalTTSEngine.isSupported() ? FestivalTTSEngine :\n          null;\n\n      if (/_forceTTSEngine=(festival|web)/.test(location.toString())) {\n        const engineName = location.toString().match(/_forceTTSEngine=(festival|web)/)[1];\n        TTSEngine = { festival: FestivalTTSEngine, web: WebTTSEngine }[engineName];\n      }\n\n      if (TTSEngine) {\n        /** @type {AbstractTTSEngine} */\n        this.ttsEngine = new TTSEngine({\n          server: options.server,\n          bookPath: options.bookPath,\n          bookLanguage: toISO6391(options.bookLanguage),\n          onLoadingStart: this.showProgressPopup.bind(this, 'Loading audio...'),\n          onLoadingComplete: this.removeProgressPopup.bind(this),\n          onDone: this.ttsStop.bind(this),\n          beforeChunkPlay: this.ttsBeforeChunkPlay.bind(this),\n          afterChunkPlay: this.ttsSendChunkFinishedAnalyticsEvent.bind(this),\n        });\n      }\n    }\n  };\n})(BookReader.prototype.setup);\n\nBookReader.prototype.init = (function(super_) {\n  return function() {\n    if (this.options.enableTtsPlugin) {\n      // Bind to events\n\n      // TODO move this to BookReader.js or something\n      this.bind(BookReader.eventNames.fragmentChange, () => {\n        if (this.mode == this.constMode2up) {\n          // clear highlights if they're no longer valid for this page\n          const visibleIndices = [this.twoPage.currentIndexL, this.twoPage.currentIndexR];\n          const visibleSelector = visibleIndices.map(i => `.BRReadAloudHilite.Leaf-${i}`).join(', ');\n          $(this.ttsHilites).filter(visibleSelector).show();\n          $(this.ttsHilites).not(visibleSelector).hide();\n        }\n      });\n\n      this.bind(BookReader.eventNames.PostInit, () => {\n        this.$('.BRicon.read').click(() => {\n          this.ttsToggle();\n          return false;\n        });\n        if (this.ttsEngine) {\n          this.ttsEngine.init();\n          if (/[?&]_autoReadAloud=show/.test(location.toString())) {\n            this.ttsStart(false); // false flag is to initiate read aloud controls\n          }\n        }\n      });\n\n      // This is fired when the hash changes by one of the other plugins!\n      // i.e. it will fire every time the page changes -_-\n      // this.bind(BookReader.eventNames.stop, function(e, br) {\n      //     this.ttsStop();\n      // }.bind(this));\n    }\n    super_.call(this);\n  };\n})(BookReader.prototype.init);\n\n\n// Extend buildMobileDrawerElement\nBookReader.prototype.buildMobileDrawerElement = (function (super_) {\n  return function () {\n    const $el = super_.call(this);\n    if (this.options.enableTtsPlugin && this.ttsEngine) {\n      $el.find('.BRmobileMenu__moreInfoRow').after($(`\n        <li>\n            <span>\n                <span class=\"DrawerIconWrapper\"><img class=\"DrawerIcon\" src=\"${this.imagesBaseURL}icon_speaker_open.svg\" alt=\"info-speaker\"/></span>\n                Read Aloud\n            </span>\n            <div>\n                <span class=\"larger\">Press to toggle read aloud</span>\n                <br/>\n                <button class=\"BRicon read\"></button>\n            </div>\n        </li>`));\n    }\n    return $el;\n  };\n})(BookReader.prototype.buildMobileDrawerElement);\n\n// Extend initNavbar\nBookReader.prototype.initNavbar = (function (super_) {\n  return function () {\n    const $el = super_.call(this);\n    if (this.options.enableTtsPlugin && this.ttsEngine) {\n      this.refs.$BRReadAloudToolbar = $(`\n        <ul class=\"read-aloud\">\n          <li>\n            <select class=\"playback-speed\" name=\"playback-speed\" title=\"${tooltips.playbackSpeed}\">\n              <option value=\"0.25\">0.25x</option>\n              <option value=\"0.5\">0.5x</option>\n              <option value=\"0.75\">0.75x</option>\n              <option value=\"1.0\" selected>1.0x</option>\n              <option value=\"1.25\">1.25x</option>\n              <option value=\"1.5\">1.5x</option>\n              <option value=\"1.75\">1.75x</option>\n              <option value=\"2\">2x</option>\n            </select>\n          </li>\n          <li>\n            <button type=\"button\" name=\"review\" title=\"${tooltips.review}\">\n              <div class=\"icon icon-review\"></div>\n            </button>\n          </li>\n          <li>\n            <button type=\"button\" name=\"play\" title=\"${tooltips.play}\">\n              <div class=\"icon icon-play\"></div>\n              <div class=\"icon icon-pause\"></div>\n            </button>\n          </li>\n          <li>\n            <button type=\"button\" name=\"advance\" title=\"${tooltips.advance}\">\n              <div class=\"icon icon-advance\"></div>\n            </button>\n          </li>\n        </ul>\n      `);\n      $el.find('.BRcontrols').prepend(this.refs.$BRReadAloudToolbar);\n      this.ttsEngine.events.on('pause resume start', () => this.ttsUpdateState());\n      this.refs.$BRReadAloudToolbar.find('[name=play]').click(this.ttsPlayPause.bind(this));\n      this.refs.$BRReadAloudToolbar.find('[name=advance]').click(this.ttsJumpForward.bind(this));\n      this.refs.$BRReadAloudToolbar.find('[name=review]').click(this.ttsJumpBackward.bind(this));\n      const $rateSelector = this.refs.$BRReadAloudToolbar.find('select[name=\"playback-speed\"]');\n      $rateSelector.change(ev => this.ttsEngine.setPlaybackRate(parseFloat($rateSelector.val())));\n      $(`<li>\n          <button class=\"BRicon read js-tooltip\" title=\"${tooltips.readAloud}\">\n            <div class=\"icon icon-read-aloud\"></div>\n            <span class=\"tooltip\">${tooltips.readAloud}</span>\n          </button>\n        </li>`).insertBefore($el.find('.BRcontrols .BRicon.zoom_out').closest('li'));\n    }\n    return $el;\n  };\n})(BookReader.prototype.initNavbar);\n\n// ttsToggle()\n//______________________________________________________________________________\nBookReader.prototype.ttsToggle = function () {\n  if (this.autoStop) this.autoStop();\n  if (this.ttsEngine.playing) {\n    this.ttsStop();\n  } else {\n    this.ttsStart();\n  }\n};\n\n// ttsStart(\n//______________________________________________________________________________\nBookReader.prototype.ttsStart = function (startTTSEngine = true) {\n  if (this.constModeThumb == this.mode)\n    this.switchMode(this.constMode1up);\n\n  this.refs.$BRReadAloudToolbar.addClass('visible');\n  this.$('.BRicon.read').addClass('unread active');\n  this.ttsSendAnalyticsEvent('Start');\n  if (startTTSEngine)\n    this.ttsEngine.start(this.currentIndex(), this.getNumLeafs());\n};\n\nBookReader.prototype.ttsJumpForward = function () {\n  if (this.ttsEngine.paused) {\n    this.ttsEngine.resume();\n  }\n  this.ttsEngine.jumpForward();\n};\n\nBookReader.prototype.ttsJumpBackward = function () {\n  if (this.ttsEngine.paused) {\n    this.ttsEngine.resume();\n  }\n  this.ttsEngine.jumpBackward();\n};\n\nBookReader.prototype.ttsUpdateState = function() {\n  const isPlaying = !(this.ttsEngine.paused || !this.ttsEngine.playing);\n  this.$('.read-aloud [name=play]').toggleClass('playing', isPlaying);\n};\n\nBookReader.prototype.ttsPlayPause = function() {\n  if (!this.ttsEngine.playing) {\n    this.ttsToggle();\n  } else {\n    this.ttsEngine.togglePlayPause();\n    this.ttsUpdateState(this.ttsEngine.paused);\n  }\n};\n\n// ttsStop()\n//______________________________________________________________________________\nBookReader.prototype.ttsStop = function () {\n  this.refs.$BRReadAloudToolbar.removeClass('visible');\n  this.$('.BRicon.read').removeClass('unread active');\n  this.ttsSendAnalyticsEvent('Stop');\n  this.ttsEngine.stop();\n  this.ttsRemoveHilites();\n  this.removeProgressPopup();\n};\n\n/**\n * @param {PageChunk} chunk\n * @return {PromiseLike<void>} returns once the flip is done\n */\nBookReader.prototype.ttsBeforeChunkPlay = function(chunk) {\n  return this.ttsMaybeFlipToIndex(chunk.leafIndex)\n    .then(() => {\n      this.ttsHighlightChunk(chunk);\n      this.ttsScrollToChunk(chunk);\n    });\n};\n\n/**\n * @param {PageChunk} chunk\n */\nBookReader.prototype.ttsSendChunkFinishedAnalyticsEvent = function(chunk) {\n  this.ttsSendAnalyticsEvent('ChunkFinished-Words', approximateWordCount(chunk.text));\n};\n\n/**\n * Flip the page if the provided leaf index is not visible\n * @param {Number} leafIndex\n * @return {PromiseLike<void>} resolves once the flip animation has completed\n */\nBookReader.prototype.ttsMaybeFlipToIndex = function (leafIndex) {\n  const in2PageMode = this.constMode2up == this.mode;\n  let resolve = null;\n  const promise = new Promise(res => resolve = res);\n\n  if (!in2PageMode) {\n    this.jumpToIndex(leafIndex);\n    resolve();\n  } else {\n    const leafVisible = leafIndex == this.twoPage.currentIndexR || leafIndex == this.twoPage.currentIndexL;\n    if (leafVisible) {\n      resolve();\n    } else {\n      this.animationFinishedCallback = resolve;\n      const mustGoNext = leafIndex > Math.max(this.twoPage.currentIndexR, this.twoPage.currentIndexL);\n      if (mustGoNext) this.next();\n      else this.prev();\n      promise.then(this.ttsMaybeFlipToIndex.bind(this, leafIndex));\n    }\n  }\n\n  return promise;\n}\n\n/**\n * @param {PageChunk} chunk\n */\nBookReader.prototype.ttsHighlightChunk = function(chunk) {\n  this.ttsRemoveHilites();\n\n  if (this.constMode2up == this.mode) {\n    this.ttsHilite2UP(chunk);\n  } else {\n    this.ttsHilite1UP(chunk);\n  }\n};\n\n/**\n * @param {PageChunk} chunk\n */\nBookReader.prototype.ttsScrollToChunk = function(chunk) {\n  if (this.constMode1up != this.mode) return;\n\n  let leafTop = 0;\n  let h;\n  let i;\n  for (i = 0; i < chunk.leafIndex; i++) {\n    h = parseInt(this._getPageHeight(i) / this.reduce);\n    leafTop += h + this.padding;\n  }\n\n  const chunkTop = chunk.lineRects[0][3]; //coords are in l,b,r,t order\n  const chunkBot = chunk.lineRects[chunk.lineRects.length - 1][1];\n\n  const topOfFirstChunk = leafTop + chunkTop / this.reduce;\n  const botOfLastChunk  = leafTop + chunkBot / this.reduce;\n\n  if (soundManager.debugMode) console.log('leafTop = ' + leafTop + ' topOfFirstChunk = ' + topOfFirstChunk + ' botOfLastChunk = ' + botOfLastChunk);\n\n  const containerTop = this.refs.$brContainer.prop('scrollTop');\n  const containerBot = containerTop + this.refs.$brContainer.height();\n  if (soundManager.debugMode) console.log('containerTop = ' + containerTop + ' containerBot = ' + containerBot);\n\n  if ((topOfFirstChunk < containerTop) || (botOfLastChunk > containerBot)) {\n    this.refs.$brContainer.stop(true).animate({scrollTop: topOfFirstChunk},'fast');\n  }\n};\n\n/**\n * @param {PageChunk} chunk\n */\nBookReader.prototype.ttsHilite1UP = function(chunk) {\n  for (let i = 0; i < chunk.lineRects.length; i++) {\n    //each rect is an array of l,b,r,t coords (djvu.xml ordering...)\n    const l = chunk.lineRects[i][0];\n    const b = chunk.lineRects[i][1];\n    const r = chunk.lineRects[i][2];\n    const t = chunk.lineRects[i][3];\n\n    const div = document.createElement('div');\n    this.ttsHilites.push(div);\n    $(div).prop('className', 'BookReaderSearchHilite').appendTo(\n      this.$('.pagediv' + chunk.leafIndex)\n    );\n\n    $(div).css({\n      width:  (r - l) / this.reduce + 'px',\n      height: (b - t) / this.reduce + 'px',\n      left:   l / this.reduce + 'px',\n      top:    t / this.reduce + 'px'\n    });\n  }\n\n};\n\n/**\n * @param {PageChunk} chunk\n */\nBookReader.prototype.ttsHilite2UP = function (chunk) {\n  for (let i = 0; i < chunk.lineRects.length; i++) {\n    //each rect is an array of l,b,r,t coords (djvu.xml ordering...)\n    const l = chunk.lineRects[i][0];\n    const b = chunk.lineRects[i][1];\n    const r = chunk.lineRects[i][2];\n    const t = chunk.lineRects[i][3];\n\n    const div = document.createElement('div');\n    this.ttsHilites.push(div);\n    $(div)\n      .prop('className', 'BookReaderSearchHilite BRReadAloudHilite Leaf-' + chunk.leafIndex)\n      .css('zIndex', 3)\n      .appendTo(this.refs.$brTwoPageView);\n    this.setHilightCss2UP(div, chunk.leafIndex, l, r, t, b);\n  }\n};\n\n// ttsRemoveHilites()\n//______________________________________________________________________________\nBookReader.prototype.ttsRemoveHilites = function () {\n  $(this.ttsHilites).remove();\n  this.ttsHilites = [];\n};\n\n/**\n * @private\n * Send an analytics event with an optional value. Also attaches the book's language.\n * @param {string} action\n * @param {number} [value]\n */\nBookReader.prototype.ttsSendAnalyticsEvent = function(action, value) {\n  if (this.archiveAnalyticsSendEvent) {\n    const extraValues = {};\n    const mediaLanguage = this.ttsEngine.opts.bookLanguage;\n    if (mediaLanguage) extraValues.mediaLanguage = mediaLanguage;\n    this.archiveAnalyticsSendEvent('BRReadAloud', action, value, extraValues);\n  }\n};\n","/* global br */\nimport { isChrome, isFirefox } from '../../../util/browserSniffing.js';\nimport { sleep, promisifyEvent, isAndroid } from './utils.js';\nimport AbstractTTSEngine from './AbstractTTSEngine.js';\n/** @typedef {import(\"./AbstractTTSEngine.js\").PageChunk} PageChunk */\n/** @typedef {import(\"./AbstractTTSEngine.js\").AbstractTTSSound} AbstractTTSSound */\n/** @typedef {import(\"./AbstractTTSEngine.js\").TTSEngineOptions} TTSEngineOptions */\n\n/**\n * @extends AbstractTTSEngine\n * TTS using Web Speech APIs\n **/\nexport default class WebTTSEngine extends AbstractTTSEngine {\n  static isSupported() {\n    return typeof(window.speechSynthesis) !== 'undefined' && !/samsungbrowser/i.test(navigator.userAgent);\n  }\n\n  /** @param {TTSEngineOptions} options */\n  constructor(options) {\n    super(options);\n\n    // SAFARI doesn't have addEventListener on speechSynthesis\n    if (speechSynthesis.addEventListener) {\n      speechSynthesis.addEventListener('voiceschanged', () => this.events.trigger('voiceschanged'));\n    }\n  }\n\n  /** @override */\n  start(leafIndex, numLeafs) {\n    // Need to run in this function to capture user intent to start playing audio\n    if ('mediaSession' in navigator) {\n      const audio = new Audio(SILENCE_6S_MP3);\n      audio.loop = true;\n\n      this.events.on('pause', () => audio.pause());\n      this.events.on('resume', () => audio.play());\n      // apparently this is what you need to do to make the media session notification go away\n      // See https://developers.google.com/web/updates/2017/02/media-session#implementation_notes\n      this.events.on('stop', () => audio.src = '');\n      audio.play().then(() => {\n        navigator.mediaSession.metadata = new MediaMetadata({\n          title: br.bookTitle,\n          artist: br.options.metadata.filter(m => m.label == 'Author').map(m => m.value)[0],\n          // album: 'The Ultimate Collection (Remastered)',\n          artwork: [\n            { src: br.options.thumbnail, type: 'image/jpg' },\n          ]\n        });\n\n        navigator.mediaSession.setActionHandler('play', () => {\n          audio.play();\n          this.resume();\n        });\n        navigator.mediaSession.setActionHandler('pause', () => {\n          audio.pause();\n          this.pause();\n        });\n\n        // navigator.mediaSession.setActionHandler('seekbackward', () => this.jumpBackward());\n        // navigator.mediaSession.setActionHandler('seekforward', () => this.jumpForward());\n        // Some devices only support the previoustrack/nexttrack (e.g. Win10), so show those.\n        // Android devices do support the seek actions, but we don't want to show both buttons\n        // and have them do the same thing.\n        navigator.mediaSession.setActionHandler('previoustrack', () => this.jumpBackward());\n        navigator.mediaSession.setActionHandler('nexttrack', () => this.jumpForward());\n      });\n    }\n\n    return super.start(leafIndex, numLeafs);\n  }\n\n  /** @override */\n  getVoices() { return speechSynthesis.getVoices(); }\n\n  /** @override */\n  createSound(chunk) {\n    return new WebTTSSound(chunk.text);\n  }\n}\n\n/** @extends AbstractTTSSound */\nexport class WebTTSSound {\n  /** @param {string} text **/\n  constructor(text) {\n    this.text = text;\n    this.loaded = false;\n    this.paused = false;\n    this.started = false;\n    /** Whether the audio was stopped with a .stop() call */\n    this.stopped = false;\n    this.rate = 1;\n\n    /** @type {SpeechSynthesisUtterance} */\n    this.utterance = null;\n\n    /** @type {SpeechSynthesisVoice} */\n    this.voice = null;\n\n    this._lastEvents = {\n      /** @type {SpeechSynthesisEvent} */\n      pause: null,\n      /** @type {SpeechSynthesisEvent} */\n      boundary: null,\n      /** @type {SpeechSynthesisEvent} */\n      start: null,\n    };\n\n    /** Store where we are in the text. Only works on some browsers. */\n    this._charIndex = 0;\n\n    /** @type {Function} resolve function called when playback finished */\n    this._finishResolver = null;\n\n    /** @type {Promise} promise resolved by _finishResolver */\n    this._finishPromise = null;\n  }\n\n  /** @override **/\n  load(onload) {\n    this.loaded = false;\n    this.started = false;\n\n    this.utterance = new SpeechSynthesisUtterance(this.text.slice(this._charIndex));\n    this.utterance.voice = this.voice;\n    // Need to also set lang (for some reason); won't set voice on Chrome@Android otherwise\n    if (this.voice) this.utterance.lang = this.voice.lang;\n    this.utterance.rate = this.rate;\n\n    // Useful for debugging things\n    if (location.toString().indexOf('_debugReadAloud=true') != -1) {\n      this.utterance.addEventListener('pause', () => console.log('pause'));\n      this.utterance.addEventListener('resume', () => console.log('resume'));\n      this.utterance.addEventListener('start', () => console.log('start'));\n      this.utterance.addEventListener('end', () => console.log('end'));\n      this.utterance.addEventListener('error', () => console.log('error'));\n      this.utterance.addEventListener('boundary', () => console.log('boundary'));\n      this.utterance.addEventListener('mark', () => console.log('mark'));\n      this.utterance.addEventListener('finish', () => console.log('finish'));\n    }\n\n    // Keep track of the speech synthesis events that come in; they have useful info\n    // about progress (like charIndex)\n    this.utterance.addEventListener('start', ev => this._lastEvents.start = ev);\n    this.utterance.addEventListener('boundary', ev => this._lastEvents.boundary = ev);\n    this.utterance.addEventListener('pause', ev => this._lastEvents.pause = ev);\n\n    // Update our state\n    this.utterance.addEventListener('start', () => {\n      this.started = true;\n      this.stopped = false;\n      this.paused = false;\n    });\n    this.utterance.addEventListener('pause', () => this.paused = true);\n    this.utterance.addEventListener('resume', () => this.paused = false);\n    this.utterance.addEventListener('end', ev => {\n      if (!this.paused && !this.stopped) {\n        // Trigger a new event, finish, which only fires when audio fully completed\n        this.utterance.dispatchEvent(new CustomEvent('finish', ev));\n      }\n    });\n    this.loaded = true;\n    onload && onload();\n  }\n\n  /**\n   * Run whenever properties have changed. Tries to restart in the same spot it\n   * left off.\n   * @return {Promise<void>}\n   */\n  reload() {\n    // We'll restore the pause state, so copy it here\n    const wasPaused = this.paused;\n    // Use recent event to determine where we'll restart from\n    // Browser support for this is mixed, but it degrades to restarting the chunk\n    // and that's ok\n    const recentEvent = this._lastEvents.boundary || this._lastEvents.pause;\n    if (recentEvent) {\n      this._charIndex = this.text.indexOf(recentEvent.target.text) + recentEvent.charIndex;\n    }\n\n    // We can't modify the utterance object, so we have to make a new one\n    return this.stop()\n      .then(() => {\n        this.load();\n        // Instead of playing and immediately pausing, we don't start playing. Note\n        // this is a requirement because pause doesn't work consistently across\n        // browsers.\n        if (!wasPaused) this.play();\n      });\n  }\n\n  play() {\n    this._finishPromise = this._finishPromise || new Promise(res => this._finishResolver = res);\n    this.utterance.addEventListener('finish', this._finishResolver);\n\n    // clear the queue\n    speechSynthesis.cancel();\n    // reset pause state\n    speechSynthesis.resume();\n    // Speak\n    speechSynthesis.speak(this.utterance);\n\n    const isLocalVoice = this.utterance.voice && this.utterance.voice.localService;\n    if (isChrome() && !isLocalVoice) this._chromePausingBugFix();\n\n    return this._finishPromise;\n  }\n\n  /** @return {Promise} */\n  stop() {\n    // 'end' won't fire if already stopped\n    let endPromise = Promise.resolve();\n    if (!this.stopped) {\n      endPromise = Promise.race([\n        promisifyEvent(this.utterance, 'end'),\n        // Safari triggers an error when you call cancel mid-sound\n        promisifyEvent(this.utterance, 'error'),\n      ]);\n    }\n    this.stopped = true;\n    speechSynthesis.cancel();\n    return endPromise;\n  }\n\n  finish() {\n    this.stop().then(() => this.utterance.dispatchEvent(new Event('finish')));\n  }\n\n  /**\n   * @override\n   * Will fire a pause event unless already paused\n   **/\n  pause() {\n    if (this.paused) return;\n\n    const pausePromise = promisifyEvent(this.utterance, 'pause');\n    speechSynthesis.pause();\n\n    // There are a few awful browser cases:\n    // 1. Pause works and fires\n    // 2. Pause doesn't work and doesn't fire\n    // 3. Pause works but doesn't fire\n    const pauseMightNotWork = (isFirefox() && isAndroid());\n    const pauseMightNotFire = isChrome() || pauseMightNotWork;\n\n    if (pauseMightNotFire) {\n      // wait for it just in case\n      const timeoutPromise = sleep(100).then(() => 'timeout');\n      Promise.race([pausePromise, timeoutPromise])\n        .then(result => {\n          // We got our pause event; nothing to do!\n          if (result != 'timeout') return;\n\n          this.utterance.dispatchEvent(new CustomEvent('pause', this._lastEvents.start));\n          // if pause might not work, then we'll stop entirely and restart later\n          if (pauseMightNotWork) this.stop();\n        });\n    }\n  }\n\n  resume() {\n    if (!this.started) {\n      this.play();\n      return;\n    }\n\n    if (!this.paused) return;\n\n    // Browser cases:\n    // 1. Resume works + fires\n    // 2. Resume works + doesn't fire (Chrome Desktop)\n    // 3. Resume doesn't work + doesn't fire (Chrome/FF Android)\n    const resumeMightNotWork = (isChrome() && isAndroid()) || (isFirefox() && isAndroid());\n    const resumeMightNotFire = isChrome() || resumeMightNotWork;\n\n    // Try resume\n    const resumePromise = promisifyEvent(this.utterance, 'resume');\n    speechSynthesis.resume();\n\n    if (resumeMightNotFire) {\n      Promise.race([resumePromise, sleep(100).then(() => 'timeout')])\n        .then(result => {\n          if (result != 'timeout') return;\n\n          this.utterance.dispatchEvent(new CustomEvent('resume', {}));\n          if (resumeMightNotWork) {\n            const reloadPromise = this.reload();\n            reloadPromise.then(() => this.play());\n          }\n        });\n    }\n  }\n\n  setPlaybackRate(rate) {\n    this.rate = rate;\n    this.reload();\n  }\n\n  /**\n   * @private\n   * Chrome has a bug where it only plays 15 seconds of TTS and then\n   * suddenly stops (see https://bugs.chromium.org/p/chromium/issues/detail?id=679437 )\n   * We avoid this (as described here: https://bugs.chromium.org/p/chromium/issues/detail?id=679437#c15 )\n   * by pausing after 14 seconds and ~instantly resuming.\n   */\n  _chromePausingBugFix() {\n    const timeoutPromise = sleep(14000).then(() => 'timeout');\n    const pausePromise = promisifyEvent(this.utterance, 'pause').then(() => 'paused');\n    const endPromise = promisifyEvent(this.utterance, 'end').then(() => 'ended');\n    return Promise.race([timeoutPromise, pausePromise, endPromise])\n      .then(result => {\n        if (location.toString().indexOf('_debugReadAloud=true') != -1) {\n          console.log(`CHROME-PAUSE-HACK: ${result}`);\n        }\n        switch (result) {\n        case 'ended':\n          // audio was stopped/finished; nothing to do\n          break;\n        case 'paused':\n          // audio was paused; wait for resume\n          // Chrome won't let you resume the audio if 14s have passed \n          // We could do the same as before (but resume+pause instead of pause+resume),\n          // but that means we'd _constantly_ be running in the background. So in that\n          // case, let's just restart the chunk\n          Promise.race([\n            promisifyEvent(this.utterance, 'resume'),\n            sleep(14000).then(() => 'timeout'),\n          ])\n            .then(result => {\n              result == 'timeout' ? this.reload() : this._chromePausingBugFix();\n            });\n          break;\n        case 'timeout':\n          // We hit Chrome's secret cut off time. Pause/resume\n          // to be able to keep TTS-ing\n          speechSynthesis.pause();\n          sleep(25)\n            .then(() => {\n              speechSynthesis.resume();\n              this._chromePausingBugFix();\n            });\n          break;\n        }\n      });\n  }\n}\n\n/**\n * According to https://developers.google.com/web/updates/2017/02/media-session#implementation_notes , it needs to be at least 5 seconds\n * long to allow usage of the media sessions api\n */\nconst SILENCE_6S_MP3 = 'data:audio/mp3;base64,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';\n","export const en = {\n  advance: 'Advance 10 seconds',\n  play: 'Play',\n  playbackSpeed: 'Playback speed',\n  readAloud: 'Read this book aloud',\n  review: 'Review 10 seconds',\n};\n\nexport const es = {\n  advance: 'Avance 10 segundos',\n  play: 'Jugar',\n  playbackSpeed: 'Velocidad de reproduccin',\n  readAloud: 'Lee este libro en voz alta',\n  review: 'Revisar 10 segundos',\n};\n","\n/**\n * Checks whether the current browser is a Chrome/Chromium browser\n * Code from https://stackoverflow.com/a/4565120/2317712\n * @param {string} [userAgent]\n * @param {string} [vendor]\n * @return {boolean}\n */\nexport function isChrome(userAgent = navigator.userAgent, vendor = navigator.vendor) {\n  return /chrome/i.test(userAgent) && /google inc/i.test(vendor);\n}\n\n/**\n * Checks whether the current browser is firefox\n * @param {string} [userAgent]\n * @return {boolean}\n */\nexport function isFirefox(userAgent = navigator.userAgent) {\n  return /firefox/i.test(userAgent);\n}\n\n/**\n * Checks whether the current browser is safari\n * https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent#Browser_Name\n * @param {string} [userAgent]\n * @return {boolean}\n */\nexport function isSafari(userAgent = navigator.userAgent) {\n  return /safari/i.test(userAgent) && !/chrome|chromium/i.test(userAgent);\n}\n","'use strict';\nvar aFunction = require('../internals/a-function');\nvar isObject = require('../internals/is-object');\n\nvar slice = [].slice;\nvar factories = {};\n\nvar construct = function (C, argsLength, args) {\n  if (!(argsLength in factories)) {\n    for (var list = [], i = 0; i < argsLength; i++) list[i] = 'a[' + i + ']';\n    // eslint-disable-next-line no-new-func\n    factories[argsLength] = Function('C,a', 'return new C(' + list.join(',') + ')');\n  } return factories[argsLength](C, args);\n};\n\n// `Function.prototype.bind` method implementation\n// https://tc39.github.io/ecma262/#sec-function.prototype.bind\nmodule.exports = Function.bind || function bind(that /* , ...args */) {\n  var fn = aFunction(this);\n  var partArgs = slice.call(arguments, 1);\n  var boundFunction = function bound(/* args... */) {\n    var args = partArgs.concat(slice.call(arguments));\n    return this instanceof boundFunction ? construct(fn, args.length, args) : fn.apply(that, args);\n  };\n  if (isObject(fn.prototype)) boundFunction.prototype = fn.prototype;\n  return boundFunction;\n};\n","var $ = require('../internals/export');\nvar assign = require('../internals/object-assign');\n\n// `Object.assign` method\n// https://tc39.github.io/ecma262/#sec-object.assign\n$({ target: 'Object', stat: true, forced: Object.assign !== assign }, {\n  assign: assign\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toObject = require('../internals/to-object');\nvar nativeGetPrototypeOf = require('../internals/object-get-prototype-of');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetPrototypeOf(1); });\n\n// `Object.getPrototypeOf` method\n// https://tc39.github.io/ecma262/#sec-object.getprototypeof\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !CORRECT_PROTOTYPE_GETTER }, {\n  getPrototypeOf: function getPrototypeOf(it) {\n    return nativeGetPrototypeOf(toObject(it));\n  }\n});\n\n","var $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar aFunction = require('../internals/a-function');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar create = require('../internals/object-create');\nvar bind = require('../internals/function-bind');\nvar fails = require('../internals/fails');\n\nvar nativeConstruct = getBuiltIn('Reflect', 'construct');\n\n// `Reflect.construct` method\n// https://tc39.github.io/ecma262/#sec-reflect.construct\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(nativeConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\nvar ARGS_BUG = !fails(function () {\n  nativeConstruct(function () { /* empty */ });\n});\nvar FORCED = NEW_TARGET_BUG || ARGS_BUG;\n\n$({ target: 'Reflect', stat: true, forced: FORCED, sham: FORCED }, {\n  construct: function construct(Target, args /* , newTarget */) {\n    aFunction(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aFunction(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return nativeConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      $args.push.apply($args, args);\n      return new (bind.apply(Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : Object.prototype);\n    var result = Function.apply.call(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toLength = require('../internals/to-length');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@match logic\nfixRegExpWellKnownSymbolLogic('match', 1, function (MATCH, nativeMatch, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = requireObjectCoercible(this);\n      var matcher = regexp == undefined ? undefined : regexp[MATCH];\n      return matcher !== undefined ? matcher.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match\n    function (regexp) {\n      var res = maybeCallNative(nativeMatch, regexp, this);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      if (!rx.global) return regExpExec(rx, S);\n\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = String(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\nvar nativeStartsWith = ''.startsWith;\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('startsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'startsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.startsWith` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.startswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = String(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var index = toLength(min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return nativeStartsWith\n      ? nativeStartsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _default = [['Serbian', ' ', 'sr', 'srp', 'srp'], ['Romanian, Moldavian, Moldovan', 'Romn', 'ro', 'ron', 'rum'], ['Sichuan Yi, Nuosu', ' Nuosuhxop', 'ii', 'iii', 'iii'], ['Tahitian', 'Reo Tahiti', 'ty', 'tah', 'tah'], ['Tagalog', 'Wikang Tagalog', 'tl', 'tgl', 'tgl'], ['Yiddish', '', 'yi', 'yid', 'yid'], ['Akan', 'Akan', 'ak', 'aka', 'aka'], ['Malay', 'Bahasa Melayu,  ', 'ms', 'msa', 'may'], ['Arabic', '', 'ar', 'ara', 'ara'], ['Norwegian', 'Norsk', 'no', 'nor', 'nor'], ['Ojibwa', '', 'oj', 'oji', 'oji'], ['Fulah', 'Fulfulde, Pulaar, Pular', 'ff', 'ful', 'ful'], ['Persian', '', 'fa', 'fas', 'per'], ['Albanian', 'Shqip', 'sq', 'sqi', 'alb'], ['Aymara', 'aymar aru', 'ay', 'aym', 'aym'], ['Azerbaijani', 'azrbaycan dili', 'az', 'aze', 'aze'], ['Chinese', ' (Zhngwn), , ', 'zh', 'zho', 'chi'], ['Cree', '', 'cr', 'cre', 'cre'], ['Estonian', 'eesti, eesti keel', 'et', 'est', 'est'], ['Guaran', 'Avae\\'', 'gn', 'grn', 'grn'], ['Inupiaq', 'Iupiaq, Iupiatun', 'ik', 'ipk', 'ipk'], ['Inuktitut', '', 'iu', 'iku', 'iku'], ['Kanuri', 'Kanuri', 'kr', 'kau', 'kau'], ['Komi', ' ', 'kv', 'kom', 'kom'], ['Kongo', 'Kikongo', 'kg', 'kon', 'kon'], ['Kurdish', 'Kurd, ', 'ku', 'kur', 'kur'], ['Latvian', 'latvieu valoda', 'lv', 'lav', 'lav'], ['Malagasy', 'fiteny malagasy', 'mg', 'mlg', 'mlg'], ['Mongolian', ' ', 'mn', 'mon', 'mon'], ['Oromo', 'Afaan Oromoo', 'om', 'orm', 'orm'], ['Pashto, Pushto', '', 'ps', 'pus', 'pus'], ['Quechua', 'Runa Simi, Kichwa', 'qu', 'que', 'que'], ['Sardinian', 'sardu', 'sc', 'srd', 'srd'], ['Swahili', 'Kiswahili', 'sw', 'swa', 'swa'], ['Uzbek', 'Ozbek, , ', 'uz', 'uzb', 'uzb'], ['Zhuang, Chuang', 'Sa cue, Saw cuengh', 'za', 'zha', 'zha'], ['Bislama', 'Bislama', 'bi', 'bis', 'bis'], ['Norwegian Bokml', 'Norsk Bokml', 'nb', 'nob', 'nob'], ['Norwegian Nynorsk', 'Norsk Nynorsk', 'nn', 'nno', 'nno'], ['Indonesian', 'Bahasa Indonesia', 'id', 'ind', 'ind'], ['Twi', 'Twi', 'tw', 'twi', 'twi'], ['Esperanto', 'Esperanto', 'eo', 'epo', 'epo'], ['Interlingua', 'Interlingua', 'ia', 'ina', 'ina'], ['Interlingue', 'Originally called Occidental; then Interlingue after WWII', 'ie', 'ile', 'ile'], ['Ido', 'Ido', 'io', 'ido', 'ido'], ['Volapk', 'Volapk', 'vo', 'vol', 'vol'], ['Bihari languages', '', 'bh', 'bih', 'bih'], ['Hebrew (modern)', '', 'he', 'heb', 'heb'], ['Sanskrit', '', 'sa', 'san', 'san'], ['Church Slavic, Church Slavonic, Old Church Slavonic, Old Slavonic, Old Bulgarian', ' ', 'cu', 'chu', 'chu'], ['Pali', '', 'pi', 'pli', 'pli'], ['Avestan', 'avesta', 'ae', 'ave', 'ave'], ['Latin', 'latine, lingua latina', 'la', 'lat', 'lat'], ['Armenian', '', 'hy', 'hye', 'arm'], ['Swati', 'SiSwati', 'ss', 'ssw', 'ssw'], ['Tibetan', '', 'bo', 'bod', 'tib'], ['South Ndebele', 'isiNdebele', 'nr', 'nbl', 'nbl'], ['Slovene', 'Slovenski Jezik, Slovenina', 'sl', 'slv', 'slv'], ['Oriya', '', 'or', 'ori', 'ori'], ['North Ndebele', 'isiNdebele', 'nd', 'nde', 'nde'], ['Nauru', 'Dorerin Naoero', 'na', 'nau', 'nau'], ['Maori', 'te reo Mori', 'mi', 'mri', 'mao'], ['Marathi', '', 'mr', 'mar', 'mar'], ['Luba-Katanga', 'Kiluba', 'lu', 'lub', 'lub'], ['Rundi', 'Ikirundi', 'rn', 'run', 'run'], ['Central Khmer', ', , ', 'km', 'khm', 'khm'], ['Western Frisian', 'Frysk', 'fy', 'fry', 'fry'], ['Bengali', '', 'bn', 'ben', 'ben'], ['Avaric', ' ,  ', 'av', 'ava', 'ava'], ['Abkhazian', ' , ', 'ab', 'abk', 'abk'], ['Afar', 'Afaraf', 'aa', 'aar', 'aar'], ['Afrikaans', 'Afrikaans', 'af', 'afr', 'afr'], ['Amharic', '', 'am', 'amh', 'amh'], ['Aragonese', 'aragons', 'an', 'arg', 'arg'], ['Assamese', '', 'as', 'asm', 'asm'], ['Bambara', 'bamanankan', 'bm', 'bam', 'bam'], ['Bashkir', ' ', 'ba', 'bak', 'bak'], ['Basque', 'euskara, euskera', 'eu', 'eus', 'baq'], ['Belarusian', ' ', 'be', 'bel', 'bel'], ['Bosnian', 'bosanski jezik', 'bs', 'bos', 'bos'], ['Breton', 'brezhoneg', 'br', 'bre', 'bre'], ['Bulgarian', ' ', 'bg', 'bul', 'bul'], ['Burmese', '', 'my', 'mya', 'bur'], ['Catalan, Valencian', 'catal, valenci', 'ca', 'cat', 'cat'], ['Chamorro', 'Chamoru', 'ch', 'cha', 'cha'], ['Chechen', ' ', 'ce', 'che', 'che'], ['Chichewa, Chewa, Nyanja', 'chiChea, chinyanja', 'ny', 'nya', 'nya'], ['Chuvash', ' ', 'cv', 'chv', 'chv'], ['Cornish', 'Kernewek', 'kw', 'cor', 'cor'], ['Corsican', 'corsu, lingua corsa', 'co', 'cos', 'cos'], ['Croatian', 'hrvatski jezik', 'hr', 'hrv', 'hrv'], ['Czech', 'etina, esk jazyk', 'cs', 'ces', 'cze'], ['Danish', 'dansk', 'da', 'dan', 'dan'], ['Divehi, Dhivehi, Maldivian', '', 'dv', 'div', 'div'], ['Dutch, Flemish', 'Nederlands, Vlaams', 'nl', 'nld', 'dut'], ['Dzongkha', '', 'dz', 'dzo', 'dzo'], ['English', 'English', 'en', 'eng', 'eng'], ['Ewe', 'Eegbe', 'ee', 'ewe', 'ewe'], ['Faroese', 'froyskt', 'fo', 'fao', 'fao'], ['Fijian', 'vosa Vakaviti', 'fj', 'fij', 'fij'], ['Finnish', 'suomi, suomen kieli', 'fi', 'fin', 'fin'], ['French', 'franais, langue franaise', 'fr', 'fra', 'fre'], ['Galician', 'Galego', 'gl', 'glg', 'glg'], ['Georgian', '', 'ka', 'kat', 'geo'], ['German', 'Deutsch', 'de', 'deu', 'ger'], ['Greek (modern)', '', 'el', 'ell', 'gre'], ['Gujarati', '', 'gu', 'guj', 'guj'], ['Haitian, Haitian Creole', 'Kreyl ayisyen', 'ht', 'hat', 'hat'], ['Hausa', '(Hausa) ', 'ha', 'hau', 'hau'], ['Herero', 'Otjiherero', 'hz', 'her', 'her'], ['Hindi', ', ', 'hi', 'hin', 'hin'], ['Hiri Motu', 'Hiri Motu', 'ho', 'hmo', 'hmo'], ['Hungarian', 'magyar', 'hu', 'hun', 'hun'], ['Irish', 'Gaeilge', 'ga', 'gle', 'gle'], ['Igbo', 'Ass Igbo', 'ig', 'ibo', 'ibo'], ['Icelandic', 'slenska', 'is', 'isl', 'ice'], ['Italian', 'Italiano', 'it', 'ita', 'ita'], ['Japanese', ' ()', 'ja', 'jpn', 'jpn'], ['Javanese', ', Basa Jawa', 'jv', 'jav', 'jav'], ['Kalaallisut, Greenlandic', 'kalaallisut, kalaallit oqaasii', 'kl', 'kal', 'kal'], ['Kannada', '', 'kn', 'kan', 'kan'], ['Kashmiri', ', ', 'ks', 'kas', 'kas'], ['Kazakh', ' ', 'kk', 'kaz', 'kaz'], ['Kikuyu, Gikuyu', 'Gky', 'ki', 'kik', 'kik'], ['Kinyarwanda', 'Ikinyarwanda', 'rw', 'kin', 'kin'], ['Kirghiz, Kyrgyz', ',  ', 'ky', 'kir', 'kir'], ['Korean', '', 'ko', 'kor', 'kor'], ['Kuanyama, Kwanyama', 'Kuanyama', 'kj', 'kua', 'kua'], ['Luxembourgish, Letzeburgesch', 'Ltzebuergesch', 'lb', 'ltz', 'ltz'], ['Ganda', 'Luganda', 'lg', 'lug', 'lug'], ['Limburgan, Limburger, Limburgish', 'Limburgs', 'li', 'lim', 'lim'], ['Lingala', 'Lingla', 'ln', 'lin', 'lin'], ['Lao', '', 'lo', 'lao', 'lao'], ['Lithuanian', 'lietuvi kalba', 'lt', 'lit', 'lit'], ['Manx', 'Gaelg, Gailck', 'gv', 'glv', 'glv'], ['Macedonian', ' ', 'mk', 'mkd', 'mac'], ['Malayalam', '', 'ml', 'mal', 'mal'], ['Maltese', 'Malti', 'mt', 'mlt', 'mlt'], ['Marshallese', 'Kajin Maje', 'mh', 'mah', 'mah'], ['Navajo, Navaho', 'Din bizaad', 'nv', 'nav', 'nav'], ['Nepali', '', 'ne', 'nep', 'nep'], ['Ndonga', 'Owambo', 'ng', 'ndo', 'ndo'], ['Occitan', 'occitan, lenga d\\'c', 'oc', 'oci', 'oci'], ['Ossetian, Ossetic', ' ', 'os', 'oss', 'oss'], ['Panjabi, Punjabi', '', 'pa', 'pan', 'pan'], ['Polish', 'jzyk polski, polszczyzna', 'pl', 'pol', 'pol'], ['Portuguese', 'Portugus', 'pt', 'por', 'por'], ['Romansh', 'Rumantsch Grischun', 'rm', 'roh', 'roh'], ['Russian', '', 'ru', 'rus', 'rus'], ['Sindhi', ',  ', 'sd', 'snd', 'snd'], ['Northern Sami', 'Davvismegiella', 'se', 'sme', 'sme'], ['Samoan', 'gagana fa\\'a Samoa', 'sm', 'smo', 'smo'], ['Sango', 'yng t sng', 'sg', 'sag', 'sag'], ['Gaelic, Scottish Gaelic', 'Gidhlig', 'gd', 'gla', 'gla'], ['Shona', 'chiShona', 'sn', 'sna', 'sna'], ['Sinhala, Sinhalese', '', 'si', 'sin', 'sin'], ['Slovak', 'Slovenina, Slovensk Jazyk', 'sk', 'slk', 'slo'], ['Somali', 'Soomaaliga, af Soomaali', 'so', 'som', 'som'], ['Southern Sotho', 'Sesotho', 'st', 'sot', 'sot'], ['Spanish, Castilian', 'Espaol', 'es', 'spa', 'spa'], ['Sundanese', 'Basa Sunda', 'su', 'sun', 'sun'], ['Swedish', 'Svenska', 'sv', 'swe', 'swe'], ['Tamil', '', 'ta', 'tam', 'tam'], ['Telugu', '', 'te', 'tel', 'tel'], ['Tajik', ', toik, ', 'tg', 'tgk', 'tgk'], ['Thai', '', 'th', 'tha', 'tha'], ['Tigrinya', '', 'ti', 'tir', 'tir'], ['Turkmen', 'Trkmen, ', 'tk', 'tuk', 'tuk'], ['Tswana', 'Setswana', 'tn', 'tsn', 'tsn'], ['Tongan (Tonga Islands)', 'Faka Tonga', 'to', 'ton', 'ton'], ['Turkish', 'Trke', 'tr', 'tur', 'tur'], ['Tsonga', 'Xitsonga', 'ts', 'tso', 'tso'], ['Tatar', ' , tatar tele', 'tt', 'tat', 'tat'], ['Uighur, Uyghur', ', Uyghurche', 'ug', 'uig', 'uig'], ['Ukrainian', '', 'uk', 'ukr', 'ukr'], ['Urdu', '', 'ur', 'urd', 'urd'], ['Venda', 'Tshivena', 've', 'ven', 'ven'], ['Vietnamese', 'Ting Vit', 'vi', 'vie', 'vie'], ['Walloon', 'Walon', 'wa', 'wln', 'wln'], ['Welsh', 'Cymraeg', 'cy', 'cym', 'wel'], ['Wolof', 'Wollof', 'wo', 'wol', 'wol'], ['Xhosa', 'isiXhosa', 'xh', 'xho', 'xho'], ['Yoruba', 'Yorb', 'yo', 'yor', 'yor'], ['Zulu', 'isiZulu', 'zu', 'zul', 'zul']];\nexports[\"default\"] = _default;"],"sourceRoot":""}