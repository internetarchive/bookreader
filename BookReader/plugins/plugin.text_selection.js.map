{"version":3,"file":"plugins/plugin.text_selection.js","mappings":";06BAMO,IAAMA,EAAgB,WAW3B,SAPA,SAAAA,EAAYC,gGAAIC,CAAA,KAAAF,GAEdG,KAAKF,GAAKA,EAEVE,KAAKC,OACP,KAEA,EAAAC,IAAA,QAAAC,MAIA,SAAMF,GACJD,KAAKC,QAAUG,OAAOC,OAAO,CAAC,EAAGL,KAAKC,QAASA,EACjD,GAEA,CAAAC,IAAA,OAAAC,MACA,WAAQ,GAER,CAAAD,IAAA,0BAAAC,MAKA,SAAwBG,GACxB,GAEA,CAAAJ,IAAA,0BAAAC,MACA,WAA2B,GAE3B,CAAAD,IAAA,eAAAC,MAGA,SAAaI,GAAU,mFAAC,CApCG,6lCCLtB,IAAMC,EAAiB,WAa3B,SAHD,SAAAA,EAAYC,EAAUC,GAAS,IAAAC,EAAA,kGAAAZ,CAAA,KAAAS,GAAAI,EAAA,kBATnB,GAAKA,EAAA,0BACG,GACpBA,EAAA,cACS,MAAIA,EAAA,2BAuBQ,WACnB,IAAMC,EAAMC,OAAOC,eAEnB,IAAKJ,EAAKK,WAAaH,EAAII,WAAY,CACrC,IAAMC,EAASC,EAAEN,EAAIO,YAAYC,QAAQV,EAAKF,UAAU,GACxD,IAAKS,EAAQ,OACbP,EAAKO,OAASA,EACdP,EAAKK,WAAY,EACjBL,EAAKD,QAAQ,UAAWC,EAAKO,OAC/B,EAEIP,EAAKK,YAAcH,EAAIS,aAAgBT,EAAII,YAAeE,EAAEN,EAAIO,YAAYC,QAAQV,EAAKF,UAAU,KACrGE,EAAKK,WAAY,EACjBL,EAAKD,QAAQ,UAAWC,EAAKO,QAEjC,IA/BElB,KAAKS,SAAWA,EAChBT,KAAKU,QAAUA,CACjB,KAAC,EAAAR,IAAA,SAAAC,MAED,WAKEoB,SAASC,iBAAiB,kBAAmBxB,KAAKyB,mBACpD,GAAC,CAAAvB,IAAA,SAAAC,MAED,WACEoB,SAASG,oBAAoB,kBAAmB1B,KAAKyB,mBACvD,mFAAC,CAzB2B,qRCqfbE,GAAMC,EAAAC,IAAAC,KAWNC,GAAgBC,EAAAH,IAAAC,KA2BhBG,GAAG,SAAAC,EAAAC,EAAAC,GAAA,gBAAAD,GAAA,GAAAE,MAAAC,QAAAH,GAAA,OAAAA,CAAA,CAAAI,CAAAJ,IAAA,SAAAA,EAAAK,GAAA,IAAAC,EAAA,MAAAN,EAAA,yBAAAO,QAAAP,EAAAO,OAAAC,WAAAR,EAAA,uBAAAM,EAAA,KAAAL,EAAAQ,EAAAC,EAAAC,EAAAC,EAAA,GAAAC,GAAA,EAAAC,GAAA,SAAAJ,GAAAJ,EAAAA,EAAAS,KAAAf,IAAAgB,KAAA,IAAAX,EAAA,IAAApC,OAAAqC,KAAAA,EAAA,OAAAO,GAAA,cAAAA,GAAAZ,EAAAS,EAAAK,KAAAT,IAAAW,QAAAL,EAAAM,KAAAjB,EAAAjC,OAAA4C,EAAAO,SAAAd,GAAAQ,GAAA,UAAAb,GAAAc,GAAA,EAAAL,EAAAT,CAAA,iBAAAa,GAAA,MAAAP,EAAAc,SAAAT,EAAAL,EAAAc,SAAAnD,OAAA0C,KAAAA,GAAA,kBAAAG,EAAA,MAAAL,CAAA,SAAAG,CAAA,EAAAS,CAAArB,EAAAC,IAAAqB,EAAAtB,EAAAC,IAAA,qBAAAsB,UAAC,4IAAD,CAAAC,EAAA,UAAAC,EAAAzB,EAAAC,GAAA,IAAAK,EAAA,oBAAAC,QAAAP,EAAAO,OAAAC,WAAAR,EAAA,kBAAAM,EAAA,IAAAJ,MAAAC,QAAAH,KAAAM,EAAAgB,EAAAtB,KAAAC,GAAAD,GAAA,iBAAAA,EAAAmB,OAAA,CAAAb,IAAAN,EAAAM,GAAA,IAAAoB,EAAA,EAAAC,EAAA,oBAAAC,EAAAD,EAAAlB,EAAA,kBAAAiB,GAAA1B,EAAAmB,OAAA,CAAAF,MAAA,IAAAA,MAAA,EAAAjD,MAAAgC,EAAA0B,KAAA,EAAAzB,EAAA,SAAAD,GAAA,MAAAA,CAAA,EAAAa,EAAAc,EAAA,WAAAJ,UAAC,wIAAD,KAAAT,EAAAF,GAAA,EAAAD,GAAA,SAAAiB,EAAA,WAAAtB,EAAAA,EAAAS,KAAAf,EAAA,EAAAS,EAAA,eAAAT,EAAAM,EAAAU,OAAA,OAAAJ,EAAAZ,EAAAiB,KAAAjB,CAAA,EAAAC,EAAA,SAAAD,GAAAW,GAAA,EAAAG,EAAAd,CAAA,EAAAa,EAAA,eAAAD,GAAA,MAAAN,EAAAc,QAAAd,EAAAc,QAAA,YAAAT,EAAA,MAAAG,CAAA,aAAAQ,EAAAtB,EAAAY,GAAA,GAAAZ,EAAA,qBAAAA,EAAA,OAAA6B,EAAA7B,EAAAY,GAAA,IAAAN,EAAA,GAAAxB,SAAAiC,KAAAf,GAAA8B,MAAC,GAAD,oBAAAxB,GAAAN,EAAA+B,cAAAzB,EAAAN,EAAA+B,YAAAC,MAAA,QAAA1B,GAAA,QAAAA,EAAAJ,MAAA+B,KAAAjC,GAAA,cAAAM,GAAA,2CAAA4B,KAAA5B,GAAAuB,EAAA7B,EAAAY,QAAA,YAAAiB,EAAA7B,EAAAY,IAAA,MAAAA,GAAAA,EAAAZ,EAAAmB,UAAAP,EAAAZ,EAAAmB,QAAA,QAAAlB,EAAA,EAAAQ,EAAAP,MAAAU,GAAAX,EAAAW,EAAAX,IAAAQ,EAAAR,GAAAD,EAAAC,GAAA,OAAAQ,CAAA,UAAAf,IA3hBpBA,EAAA,kBAAAO,CAAA,MAAAK,EAAAL,EAAA,GAAAD,EAAA/B,OAAAkE,UAAA1B,EAAAT,EAAAoC,eAAAtB,EAAA7C,OAAAoE,gBAAA,SAAA/B,EAAAL,EAAAD,GAAAM,EAAAL,GAAAD,EAAAhC,KAAA,EAAA0C,EAAA,mBAAAH,OAAAA,OAAA,GAAAK,EAAAF,EAAAF,UAAA,aAAA8B,EAAA5B,EAAA6B,eAAA,kBAAA5B,EAAAD,EAAA8B,aAAA,yBAAAC,EAAAnC,EAAAL,EAAAD,GAAA,OAAA/B,OAAAoE,eAAA/B,EAAAL,EAAA,CAAAjC,MAAAgC,EAAA0C,YAAA,EAAAC,cAAA,EAAAC,UAAA,IAAAtC,EAAAL,EAAA,KAAAwC,EAAA,aAAAnC,GAAAmC,EAAA,SAAAnC,EAAAL,EAAAD,GAAA,OAAAM,EAAAL,GAAAD,CAAA,WAAA6C,EAAAvC,EAAAL,EAAAD,EAAAS,GAAA,IAAAC,EAAAT,GAAAA,EAAAkC,qBAAAW,EAAA7C,EAAA6C,EAAAlC,EAAA3C,OAAA8E,OAAArC,EAAAyB,WAAAG,EAAA,IAAAU,EAAAvC,GAAA,WAAAK,EAAAF,EAAA,WAAA5C,MAAAiF,EAAA3C,EAAAN,EAAAsC,KAAA1B,CAAA,UAAAsC,EAAA5C,EAAAL,EAAAD,GAAA,WAAAmD,KAAA,SAAAC,IAAA9C,EAAAS,KAAAd,EAAAD,GAAA,OAAAM,GAAA,OAAA6C,KAAA,QAAAC,IAAA9C,EAAA,EAAAL,EAAA4C,KAAAA,EAAA,IAAAQ,EAAA,iBAAAhD,EAAA,iBAAAQ,EAAA,YAAAe,EAAA,YAAA0B,EAAA,YAAAR,IAAA,UAAAS,IAAA,UAAAC,IAAA,KAAAC,EAAA,GAAAhB,EAAAgB,EAAA7C,GAAA,8BAAA8C,EAAAzF,OAAA0F,eAAAC,EAAAF,GAAAA,EAAAA,EAAAG,EAAA,MAAAD,GAAAA,IAAA5D,GAAAS,EAAAM,KAAA6C,EAAAhD,KAAA6C,EAAAG,GAAA,IAAAE,EAAAN,EAAArB,UAAAW,EAAAX,UAAAlE,OAAA8E,OAAAU,GAAA,SAAAM,EAAAzD,GAAA,0BAAA0D,SAAA,SAAA/D,GAAAwC,EAAAnC,EAAAL,GAAA,SAAAK,GAAA,YAAA2D,QAAAhE,EAAAK,EAAA,gBAAA4D,EAAA5D,EAAAL,GAAA,SAAAkE,EAAAnE,EAAAc,EAAAJ,EAAAE,GAAA,IAAA0B,EAAAY,EAAA5C,EAAAN,GAAAM,EAAAQ,GAAA,aAAAwB,EAAAa,KAAA,KAAAxC,EAAA2B,EAAAc,IAAAC,EAAA1C,EAAA3C,MAAA,OAAAqF,GAAA,UAAAe,EAAAf,IAAA5C,EAAAM,KAAAsC,EAAA,WAAApD,EAAAoE,QAAAhB,EAAAiB,SAAAC,MAAA,SAAAjE,GAAA6D,EAAA,OAAA7D,EAAAI,EAAAE,EAAA,aAAAN,GAAA6D,EAAA,QAAA7D,EAAAI,EAAAE,EAAA,IAAAX,EAAAoE,QAAAhB,GAAAkB,MAAA,SAAAjE,GAAAK,EAAA3C,MAAAsC,EAAAI,EAAAC,EAAA,aAAAL,GAAA,OAAA6D,EAAA,QAAA7D,EAAAI,EAAAE,EAAA,IAAAA,EAAA0B,EAAAc,IAAA,KAAApD,EAAAc,EAAA,gBAAA9C,MAAA,SAAAsC,EAAAG,GAAA,SAAA+D,IAAA,WAAAvE,GAAA,SAAAA,EAAAD,GAAAmE,EAAA7D,EAAAG,EAAAR,EAAAD,EAAA,WAAAA,EAAAA,EAAAA,EAAAuE,KAAAC,EAAAA,GAAAA,GAAA,aAAAvB,EAAAhD,EAAAD,EAAAS,GAAA,IAAAK,EAAAuC,EAAA,gBAAA3C,EAAAE,GAAA,GAAAE,IAAAD,EAAA,MAAA4D,MAAA,mCAAA3D,IAAAc,EAAA,cAAAlB,EAAA,MAAAE,EAAA,OAAA5C,MAAAsC,EAAAW,MAAA,OAAAR,EAAAiE,OAAAhE,EAAAD,EAAA2C,IAAAxC,IAAA,KAAA0B,EAAA7B,EAAAkE,SAAA,GAAArC,EAAA,KAAA3B,EAAAiE,EAAAtC,EAAA7B,GAAA,GAAAE,EAAA,IAAAA,IAAA2C,EAAA,gBAAA3C,CAAA,cAAAF,EAAAiE,OAAAjE,EAAAoE,KAAApE,EAAAqE,MAAArE,EAAA2C,SAAA,aAAA3C,EAAAiE,OAAA,IAAA5D,IAAAuC,EAAA,MAAAvC,EAAAc,EAAAnB,EAAA2C,IAAA3C,EAAAsE,kBAAAtE,EAAA2C,IAAA,gBAAA3C,EAAAiE,QAAAjE,EAAAuE,OAAA,SAAAvE,EAAA2C,KAAAtC,EAAAD,EAAA,IAAA4C,EAAAP,EAAAjD,EAAAD,EAAAS,GAAA,cAAAgD,EAAAN,KAAA,IAAArC,EAAAL,EAAAQ,KAAAW,EAAAvB,EAAAoD,EAAAL,MAAAE,EAAA,gBAAAtF,MAAAyF,EAAAL,IAAAnC,KAAAR,EAAAQ,KAAA,WAAAwC,EAAAN,OAAArC,EAAAc,EAAAnB,EAAAiE,OAAA,QAAAjE,EAAA2C,IAAAK,EAAAL,IAAA,YAAAwB,EAAA3E,EAAAD,GAAA,IAAAS,EAAAT,EAAA0E,OAAA5D,EAAAb,EAAAO,SAAAC,GAAA,GAAAK,IAAAR,EAAA,OAAAN,EAAA2E,SAAA,eAAAlE,GAAAR,EAAAO,SAAAY,SAAApB,EAAA0E,OAAA,SAAA1E,EAAAoD,IAAA9C,EAAAsE,EAAA3E,EAAAD,GAAA,UAAAA,EAAA0E,SAAA,WAAAjE,IAAAT,EAAA0E,OAAA,QAAA1E,EAAAoD,IAAA,IAAA7B,UAAA,oCAAAd,EAAA,aAAA6C,EAAA,IAAA5C,EAAAwC,EAAApC,EAAAb,EAAAO,SAAAR,EAAAoD,KAAA,aAAA1C,EAAAyC,KAAA,OAAAnD,EAAA0E,OAAA,QAAA1E,EAAAoD,IAAA1C,EAAA0C,IAAApD,EAAA2E,SAAA,KAAArB,EAAA,IAAA1C,EAAAF,EAAA0C,IAAA,OAAAxC,EAAAA,EAAAK,MAAAjB,EAAAC,EAAAgF,YAAArE,EAAA5C,MAAAgC,EAAAgB,KAAAf,EAAAiF,QAAA,WAAAlF,EAAA0E,SAAA1E,EAAA0E,OAAA,OAAA1E,EAAAoD,IAAA9C,GAAAN,EAAA2E,SAAA,KAAArB,GAAA1C,GAAAZ,EAAA0E,OAAA,QAAA1E,EAAAoD,IAAA,IAAA7B,UAAA,oCAAAvB,EAAA2E,SAAA,KAAArB,EAAA,UAAA6B,EAAA7E,GAAA,IAAAL,EAAA,CAAAmF,OAAA9E,EAAA,SAAAA,IAAAL,EAAAoF,SAAA/E,EAAA,SAAAA,IAAAL,EAAAqF,WAAAhF,EAAA,GAAAL,EAAAsF,SAAAjF,EAAA,SAAAkF,WAAAtE,KAAAjB,EAAA,UAAAwF,EAAAnF,GAAA,IAAAL,EAAAK,EAAAoF,YAAA,GAAAzF,EAAAkD,KAAA,gBAAAlD,EAAAmD,IAAA9C,EAAAoF,WAAAzF,CAAA,UAAA+C,EAAA1C,GAAA,KAAAkF,WAAA,EAAAJ,OAAA,SAAA9E,EAAA0D,QAAAmB,EAAA,WAAAQ,OAAA,YAAA9B,EAAA5D,GAAA,GAAAA,GAAA,KAAAA,EAAA,KAAAD,EAAAC,EAAAW,GAAA,GAAAZ,EAAA,OAAAA,EAAAe,KAAAd,GAAA,sBAAAA,EAAAe,KAAA,OAAAf,EAAA,IAAA2F,MAAA3F,EAAAkB,QAAA,KAAAL,GAAA,EAAAJ,EAAA,SAAAM,IAAA,OAAAF,EAAAb,EAAAkB,QAAA,GAAAV,EAAAM,KAAAd,EAAAa,GAAA,OAAAE,EAAAhD,MAAAiC,EAAAa,GAAAE,EAAAC,MAAA,EAAAD,EAAA,OAAAA,EAAAhD,MAAAsC,EAAAU,EAAAC,MAAA,EAAAD,CAAA,SAAAN,EAAAM,KAAAN,CAAA,YAAAa,UAAA6C,EAAAnE,GAAA,2BAAAsD,EAAApB,UAAAqB,EAAA1C,EAAAgD,EAAA,eAAA9F,MAAAwF,EAAAb,cAAA,IAAA7B,EAAA0C,EAAA,eAAAxF,MAAAuF,EAAAZ,cAAA,IAAAY,EAAAsC,YAAApD,EAAAe,EAAA7C,EAAA,qBAAAV,EAAA6F,oBAAA,SAAAxF,GAAA,IAAAL,EAAA,mBAAAK,GAAAA,EAAAyB,YAAA,QAAA9B,IAAAA,IAAAsD,GAAA,uBAAAtD,EAAA4F,aAAA5F,EAAA+B,MAAA,EAAA/B,EAAAN,KAAA,SAAAW,GAAA,OAAArC,OAAA8H,eAAA9H,OAAA8H,eAAAzF,EAAAkD,IAAAlD,EAAA0F,UAAAxC,EAAAf,EAAAnC,EAAAK,EAAA,sBAAAL,EAAA6B,UAAAlE,OAAA8E,OAAAe,GAAAxD,CAAA,EAAAL,EAAAgG,MAAA,SAAA3F,GAAA,OAAAgE,QAAAhE,EAAA,EAAAyD,EAAAG,EAAA/B,WAAAM,EAAAyB,EAAA/B,UAAAG,GAAA,0BAAArC,EAAAiE,cAAAA,EAAAjE,EAAAiG,MAAA,SAAA5F,EAAAN,EAAAS,EAAAK,EAAAJ,QAAA,IAAAA,IAAAA,EAAAyF,SAAA,IAAAvF,EAAA,IAAAsD,EAAArB,EAAAvC,EAAAN,EAAAS,EAAAK,GAAAJ,GAAA,OAAAT,EAAA6F,oBAAA9F,GAAAY,EAAAA,EAAAI,OAAAuD,MAAA,SAAAjE,GAAA,OAAAA,EAAAW,KAAAX,EAAAtC,MAAA4C,EAAAI,MAAA,KAAA+C,EAAAD,GAAArB,EAAAqB,EAAAnD,EAAA,aAAA8B,EAAAqB,EAAAlD,GAAA,0BAAA6B,EAAAqB,EAAA,qDAAA7D,EAAAmG,KAAA,SAAA9F,GAAA,IAAAL,EAAAhC,OAAAqC,GAAAN,EAAA,WAAAS,KAAAR,EAAAD,EAAAkB,KAAAT,GAAA,OAAAT,EAAAqG,UAAA,SAAArF,IAAA,KAAAhB,EAAAmB,QAAA,KAAAb,EAAAN,EAAAsG,MAAA,GAAAhG,KAAAL,EAAA,OAAAe,EAAAhD,MAAAsC,EAAAU,EAAAC,MAAA,EAAAD,CAAA,QAAAA,EAAAC,MAAA,EAAAD,CAAA,GAAAf,EAAA4D,OAAAA,EAAAb,EAAAb,UAAA,CAAAJ,YAAAiB,EAAA2C,MAAA,SAAA1F,GAAA,QAAAsG,KAAA,OAAAvF,KAAA,OAAA6D,KAAA,KAAAC,MAAAxE,EAAA,KAAAW,MAAA,OAAA0D,SAAA,UAAAD,OAAA,YAAAtB,IAAA9C,EAAA,KAAAkF,WAAAxB,QAAAyB,IAAAxF,EAAA,QAAAD,KAAA,WAAAA,EAAAwG,OAAA,IAAA/F,EAAAM,KAAA,KAAAf,KAAA4F,OAAA5F,EAAA8B,MAAA,WAAA9B,GAAAM,EAAA,EAAAmG,KAAA,gBAAAxF,MAAA,MAAAX,EAAA,KAAAkF,WAAA,GAAAE,WAAA,aAAApF,EAAA6C,KAAA,MAAA7C,EAAA8C,IAAA,YAAAsD,IAAA,EAAA3B,kBAAA,SAAA9E,GAAA,QAAAgB,KAAA,MAAAhB,EAAA,IAAAD,EAAA,cAAA2G,EAAAlG,EAAAK,GAAA,OAAAF,EAAAuC,KAAA,QAAAvC,EAAAwC,IAAAnD,EAAAD,EAAAgB,KAAAP,EAAAK,IAAAd,EAAA0E,OAAA,OAAA1E,EAAAoD,IAAA9C,KAAAQ,CAAA,SAAAA,EAAA,KAAA0E,WAAArE,OAAA,EAAAL,GAAA,IAAAA,EAAA,KAAAJ,EAAA,KAAA8E,WAAA1E,GAAAF,EAAAF,EAAAgF,WAAA,YAAAhF,EAAA0E,OAAA,OAAAuB,EAAA,UAAAjG,EAAA0E,QAAA,KAAAmB,KAAA,KAAAjE,EAAA7B,EAAAM,KAAAL,EAAA,YAAAC,EAAAF,EAAAM,KAAAL,EAAA,iBAAA4B,GAAA3B,EAAA,SAAA4F,KAAA7F,EAAA2E,SAAA,OAAAsB,EAAAjG,EAAA2E,UAAA,WAAAkB,KAAA7F,EAAA4E,WAAA,OAAAqB,EAAAjG,EAAA4E,WAAA,SAAAhD,GAAA,QAAAiE,KAAA7F,EAAA2E,SAAA,OAAAsB,EAAAjG,EAAA2E,UAAA,YAAA1E,EAAA,MAAA8D,MAAA,kDAAA8B,KAAA7F,EAAA4E,WAAA,OAAAqB,EAAAjG,EAAA4E,WAAA,KAAAN,OAAA,SAAA1E,EAAAL,GAAA,QAAAD,EAAA,KAAAwF,WAAArE,OAAA,EAAAnB,GAAA,IAAAA,EAAA,KAAAc,EAAA,KAAA0E,WAAAxF,GAAA,GAAAc,EAAAsE,QAAA,KAAAmB,MAAA9F,EAAAM,KAAAD,EAAA,oBAAAyF,KAAAzF,EAAAwE,WAAA,KAAA5E,EAAAI,EAAA,OAAAJ,IAAA,UAAAJ,GAAA,aAAAA,IAAAI,EAAA0E,QAAAnF,GAAAA,GAAAS,EAAA4E,aAAA5E,EAAA,UAAAE,EAAAF,EAAAA,EAAAgF,WAAA,UAAA9E,EAAAuC,KAAA7C,EAAAM,EAAAwC,IAAAnD,EAAAS,GAAA,KAAAgE,OAAA,YAAA1D,KAAAN,EAAA4E,WAAAhC,GAAA,KAAAsD,SAAAhG,EAAA,EAAAgG,SAAA,SAAAtG,EAAAL,GAAA,aAAAK,EAAA6C,KAAA,MAAA7C,EAAA8C,IAAA,gBAAA9C,EAAA6C,MAAA,aAAA7C,EAAA6C,KAAA,KAAAnC,KAAAV,EAAA8C,IAAA,WAAA9C,EAAA6C,MAAA,KAAAuD,KAAA,KAAAtD,IAAA9C,EAAA8C,IAAA,KAAAsB,OAAA,cAAA1D,KAAA,kBAAAV,EAAA6C,MAAAlD,IAAA,KAAAe,KAAAf,GAAAqD,CAAA,EAAAuD,OAAA,SAAAvG,GAAA,QAAAL,EAAA,KAAAuF,WAAArE,OAAA,EAAAlB,GAAA,IAAAA,EAAA,KAAAD,EAAA,KAAAwF,WAAAvF,GAAA,GAAAD,EAAAsF,aAAAhF,EAAA,YAAAsG,SAAA5G,EAAA0F,WAAA1F,EAAAuF,UAAAE,EAAAzF,GAAAsD,CAAA,GAAAwD,MAAA,SAAAxG,GAAA,QAAAL,EAAA,KAAAuF,WAAArE,OAAA,EAAAlB,GAAA,IAAAA,EAAA,KAAAD,EAAA,KAAAwF,WAAAvF,GAAA,GAAAD,EAAAoF,SAAA9E,EAAA,KAAAG,EAAAT,EAAA0F,WAAA,aAAAjF,EAAA0C,KAAA,KAAArC,EAAAL,EAAA2C,IAAAqC,EAAAzF,EAAA,QAAAc,CAAA,QAAA2D,MAAA,0BAAAsC,cAAA,SAAA9G,EAAAD,EAAAS,GAAA,YAAAkE,SAAA,CAAAnE,SAAAqD,EAAA5D,GAAAgF,WAAAjF,EAAAkF,QAAAzE,GAAA,cAAAiE,SAAA,KAAAtB,IAAA9C,GAAAgD,CAAA,GAAArD,CAAA,UAAA+G,EAAAvG,EAAAH,EAAAL,EAAAD,EAAAc,EAAAF,EAAA0B,GAAA,QAAA5B,EAAAD,EAAAG,GAAA0B,GAAA3B,EAAAD,EAAA1C,KAAA,OAAAyC,GAAA,YAAAR,EAAAQ,EAAA,CAAAC,EAAAO,KAAAX,EAAAK,GAAAwF,QAAA9B,QAAA1D,GAAA4D,KAAAvE,EAAAc,EAAA,UAAAmG,EAAAxG,GAAA,sBAAAH,EAAA,KAAAL,EAAAiH,UAAA,WAAAf,SAAA,SAAAnG,EAAAc,GAAA,IAAAF,EAAAH,EAAA0G,MAAA7G,EAAAL,GAAA,SAAAmH,EAAA3G,GAAAuG,EAAApG,EAAAZ,EAAAc,EAAAsG,EAAAC,EAAA,OAAA5G,EAAA,UAAA4G,EAAA5G,GAAAuG,EAAApG,EAAAZ,EAAAc,EAAAsG,EAAAC,EAAA,QAAA5G,EAAA,CAAA2G,OAAA,gBAAAE,EAAAhH,EAAAQ,EAAAb,GAAA,OAAAa,EAAAyG,EAAAzG,GAAA,SAAAR,EAAAL,GAAA,GAAAA,IAAA,UAAAmE,EAAAnE,IAAA,mBAAAA,GAAA,OAAAA,EAAA,YAAAA,EAAA,UAAAsB,UAAA,4EAAAtB,GAAA,YAAAA,EAAA,UAAAuH,eAAA,oEAAAvH,CAAA,CAAAwH,CAAAnH,EAAA,CAAAoH,CAAApH,EAAAqH,IAAAC,QAAAC,UAAA/G,EAAAb,GAAA,GAAAsH,EAAAjH,GAAAyB,aAAAjB,EAAAqG,MAAA7G,EAAAL,GAAA,UAAA0H,IAAA,QAAArH,GAAAwH,QAAA3F,UAAA4F,QAAAhH,KAAA6G,QAAAC,UAAAC,QAAA,0BAAAxH,GAAA,QAAAqH,EAAA,mBAAArH,CAAA,cAAAiH,EAAAjH,GAAA,OAAAiH,EAAAtJ,OAAA8H,eAAA9H,OAAA0F,eAAAqE,OAAA,SAAA1H,GAAA,OAAAA,EAAA0F,WAAA/H,OAAA0F,eAAArD,EAAA,EAAAiH,EAAAjH,EAAA,UAAA2H,EAAA3H,EAAAL,GAAA,OAAAgI,EAAAhK,OAAA8H,eAAA9H,OAAA8H,eAAAiC,OAAA,SAAA1H,EAAAL,GAAA,OAAAK,EAAA0F,UAAA/F,EAAAK,CAAA,EAAA2H,EAAA3H,EAAAL,EAAA,UAAAxB,EAAAwB,EAAAD,EAAAM,GAAA,OAAAN,EAAAkI,EAAAlI,MAAAC,EAAAhC,OAAAoE,eAAApC,EAAAD,EAAA,CAAAhC,MAAAsC,EAAAoC,YAAA,EAAAC,cAAA,EAAAC,UAAA,IAAA3C,EAAAD,GAAAM,EAAAL,CAAA,UAAArC,EAAAgD,EAAAH,GAAA,KAAAG,aAAAH,GAAA,UAAAc,UAAA,8CAAA4G,EAAAlI,EAAAD,GAAA,QAAAM,EAAA,EAAAA,EAAAN,EAAAmB,OAAAb,IAAA,KAAAQ,EAAAd,EAAAM,GAAAQ,EAAA4B,WAAA5B,EAAA4B,aAAA,EAAA5B,EAAA6B,cAAA,YAAA7B,IAAAA,EAAA8B,UAAA,GAAA3E,OAAAoE,eAAApC,EAAAiI,EAAApH,EAAA/C,KAAA+C,EAAA,WAAAsH,EAAAnI,EAAAD,EAAAM,GAAA,OAAAN,GAAAmI,EAAAlI,EAAAkC,UAAAnC,GAAAM,GAAA6H,EAAAlI,EAAAK,GAAArC,OAAAoE,eAAApC,EAAA,aAAA2C,UAAA,IAAA3C,CAAA,UAAAiI,EAAA5H,GAAA,IAAAI,EAAA,SAAAJ,EAAAN,GAAA,aAAAoE,EAAA9D,KAAAA,EAAA,OAAAA,EAAA,IAAAL,EAAAK,EAAAC,OAAA8H,aAAA,YAAApI,EAAA,KAAAS,EAAAT,EAAAc,KAAAT,EAAAN,UAAA,aAAAoE,EAAA1D,GAAA,OAAAA,EAAA,UAAAa,UAAA,uDAAA+G,OAAAhI,EAAA,CAAAiI,CAAAjI,GAAA,gBAAA8D,EAAA1D,GAAAA,EAAAA,EAAA,GAOA,IAAM8H,EAAmE7J,OAAO6J,WAKnEC,EAAK,WAOhB,OAAAL,GANA,SAAAK,IAA0B,IAAdC,EAAOxB,UAAA/F,OAAA,QAAAwH,IAAAzB,UAAA,GAAAA,UAAA,GAAG,GAAEtJ,EAAA,KAAA6K,GACtB5K,KAAK6K,QAAUA,EAEf7K,KAAK+K,QAAU,EACjB,GAEA,EAAA7K,IAAA,MAAAC,MAGA,SAAI6K,GACEhL,KAAK+K,QAAQzH,QAAUtD,KAAK6K,SAC9B7K,KAAK+K,QAAQE,QAEfjL,KAAK+K,QAAQ1H,KAAK2H,EACpB,IAAC,CAfe,GAkBLE,EAAmB,SAAAC,GA0B9B,SAAAD,EAAYpL,GAAI,IAAAa,EAO0E,OAP1EZ,EAAA,KAAAmL,GAKdtK,EAJAD,EAAA8I,EAAA,KAAAyB,EAAA,CAAMpL,IAIN,UA9BQ,CACRsL,SAAS,EAETC,eAAgB,KAEhBC,qBAAsB,KAEtBC,OAAO,IAGT3K,EAAAD,EAAA,mBACmB,MAEnBC,EAAAD,EAAA,gBACgB,IAAIiK,GAEpBhK,EAAAD,EAAA,kBAIkB,MAgDlBC,EAAAD,EAAA,sBAIqB,SAAC2E,EAAMpE,GAC1B,GAAa,YAAToE,EACF3E,EAAK6K,kBAAkBtK,OAClB,IAAa,YAAToE,EAGT,MAAM,IAAIsB,MAAM,gBAAD6E,OAAiBnG,IAFhC3E,EAAK+K,YAAYxK,EAGnB,CACF,IAjDEP,EAAKgL,IAAkC,OAA5BhL,EAAKb,GAAG8L,gBACnBjL,EAAKkL,kBAAoB,IAAIrL,EAAkB,eAAgBG,EAAKc,oBAAoBd,CAC1F,CAEA,OAlEF,SAAA8B,EAAAL,GAAA,sBAAAA,GAAA,OAAAA,EAAA,UAAAsB,UAAA,sDAAAjB,EAAA6B,UAAAlE,OAAA8E,OAAA9C,GAAAA,EAAAkC,UAAA,CAAAJ,YAAA,CAAA/D,MAAAsC,EAAAsC,UAAA,EAAAD,cAAA,KAAA1E,OAAAoE,eAAA/B,EAAA,aAAAsC,UAAA,IAAA3C,GAAAgI,EAAA3H,EAAAL,EAAA,CAkEE0J,CAAAZ,EAAAC,GAAAZ,EAAAW,EAAA,EAAAhL,IAAA,OAAAC,MACA,WAAO,IAAA4L,EAAA,KACA/L,KAAKC,QAAQmL,UAElBpL,KAAKgM,WAELhM,KAAK6L,kBAAkBI,SACvB,IAAIzL,EAAkB,gBAAgB,SAAC0L,GAEP,IAAAC,EAAX,WAAfD,IAC+B,QAAjCC,EAAAJ,EAAKjM,GAAGsM,SAASC,wBAAgB,IAAAF,GAAjCA,EAAmCG,UAAU,aAAc,eAG3DP,EAAKjM,GAAGyM,KAAKC,IAAIC,KAAK,kCAAkCC,YAAY,iCACpEvL,EAAEL,OAAOC,eAAeK,YAAYC,QAAQ,oBAAoBsL,SAAS,iCAE7E,IAAGV,SACL,GAEA,CAAA/L,IAAA,0BAAAC,MAKA,SAAwBG,GAMtB,OAHIN,KAAKF,GAAG8M,OAAS5M,KAAKF,GAAG+M,gBAAkBvM,EAAcwM,MAC3D9M,KAAK+M,gBAAgBzM,GAEhBA,CACT,GAAC,CAAAJ,IAAA,WAAAC,MAgBD,WAEMH,KAAKC,QAAQqL,uBACjBtL,KAAKgN,iBAAmB7L,EAAE8L,KAAK,CAC7B3H,KAAM,MACN4H,KAAKC,EAAAA,EAAAA,GAAenN,KAAKC,QAAQoL,eAAgBrL,KAAKF,GAAGG,QAAQmN,MACjEC,SAAUrN,KAAKC,QAAQsL,MAAQ,QAAU,OACzC+B,OAAO,EACPC,UAAW,CACTC,gBAAiBxN,KAAKF,GAAG2N,WAE3BC,MAAO,SAACtL,GAAe,IACtBsE,MAAK,SAACiH,GACP,IACE,IAAMC,EAASzM,EAAE0M,SAASF,GAC1B,OAAOC,GAAUzM,EAAEyM,GAAQnB,KAAK,SAClC,CAAE,MAAOrK,GACP,MACF,CACF,IACF,GAEA,CAAAlC,IAAA,cAAAC,OAAA2N,EAAA1E,EAAAvH,IAAAC,MAIA,SAAAiM,EAAkBC,GAAK,IAAAC,EAAAN,EAAAO,EAAAC,EAAAC,EAAA,OAAAvM,IAAAmD,MAAA,SAAAqJ,GAAA,cAAAA,EAAA3F,KAAA2F,EAAAlL,MAAA,WACjBnD,KAAKC,QAAQqL,qBAAsB,CAAF+C,EAAAlL,KAAA,SACuC,KAApE8K,EAAcjO,KAAKsO,cAAcvD,QAAQ0B,MAAK,SAAA8B,GAAC,OAAIA,EAAEP,OAASA,CAAK,KACxD,CAAFK,EAAAlL,KAAA,eAAAkL,EAAAlH,OAAA,SACN8G,EAAYO,UAAQ,cAAAH,EAAAlL,KAAA,EAEXhC,EAAE8L,KAAK,CACvB3H,KAAM,MACN4H,KAAKC,EAAAA,EAAAA,GAAenN,KAAKC,QAAQqL,qBAAsBtL,KAAKF,GAAGG,QAAQmN,KAAM,CAAEqB,UAAWT,IAC1FX,SAAUrN,KAAKC,QAAQsL,MAAQ,QAAU,OACzC+B,OAAO,EACPC,UAAW,CACTC,gBAAiBxN,KAAKF,GAAG2N,WAE3BC,MAAO,SAACtL,GAAe,IACvB,OAIoD,OAbhDuL,EAAGU,EAAArH,KAAAqH,EAAA3F,KAAG,EAWJwF,EAAS/M,EAAE0M,SAASF,GACpBQ,EAASD,GAAU/M,EAAE+M,GAAQzB,KAAK,UAAU,GAClDzM,KAAKsO,cAAcI,IAAI,CAAEV,MAAAA,EAAOQ,SAAUL,IAAUE,EAAAlH,OAAA,SAC7CgH,GAAM,eAAAE,EAAA3F,KAAA,GAAA2F,EAAAM,GAAAN,EAAA,SAAAA,EAAAlH,OAAA,cAEN2D,GAAS,QAAAuD,EAAAlL,KAAA,wBAAAkL,EAAAlL,KAAA,GAGQnD,KAAKgN,iBAAgB,QAA9B,KAAXoB,EAAWC,EAAArH,MACA,CAAFqH,EAAAlL,KAAA,gBAAAkL,EAAAlH,OAAA,SAASiH,EAAYJ,IAAM,yBAAAK,EAAAzF,OAAA,GAAAmF,EAAA,mBAE7C,SA5BgBa,GAAA,OAAAd,EAAAxE,MAAC,KAADD,UAAA,IA8BjB,CAAAnJ,IAAA,gBAAAC,MAIA,SAAc0O,GACZA,EAAW,GAAGrN,iBAAiB,QAAQ,SAACsN,GACtC,IAAMC,EAAYxN,SAASR,eAC3B+N,EAAME,cAAcC,QAAQ,aAAcF,EAAU9N,YACpD6N,EAAMI,gBACR,GACF,GAEA,CAAAhP,IAAA,cAAAC,MAIA,SAAYgP,GAAW,IAAAC,EAAA,KACfC,EAAiBlO,EAAEgO,GAAW9N,QAAQ,oBAC5C8N,EAAUG,MAAMC,cAAgB,OAChCF,EAAe5C,KAAK,OAAO+C,IAAI,iBAAkB,QAEjDrO,EAAEgO,GAAWM,IAAI,4BACjB,IAAMC,EAAmB1P,KAAK2P,YAC1BC,EAAkB5P,KAAK2P,YACvBD,IACFP,EAAUG,MAAMC,cAAgB,QAKlCpO,EAAEgO,GAAWU,GAAG,qCAAqC,SAACf,GACpDM,EAAKO,aAAc,EACfxO,EAAE2N,EAAM5N,QAAQ4O,GAAG,6BACrBhB,EAAMiB,iBAEV,IAEA5O,EAAEgO,GAAWU,GAAG,mCAAmC,SAACf,GAClDM,EAAKO,aAAc,EACnBR,EAAUG,MAAMC,cAAgB,OAC5BK,IACFA,GAAkB,EAClBd,EAAMiB,kBAEV,GACF,GAEA,CAAA7P,IAAA,oBAAAC,MAIA,SAAkBgP,GAAW,IAAAa,EAAA,KACrBX,EAAiBlO,EAAEgO,GAAW9N,QAAQ,oBAE5C8N,EAAUG,MAAMC,cAAgB,MAEhCF,EAAe5C,KAAK,OAAO+C,IAAI,iBAAkB,QAEjDrO,EAAEgO,GAAWM,IAAI,4BAEjBtO,EAAEgO,GAAWU,GAAG,qCAAqC,SAACf,GACpDkB,EAAKL,aAAc,EACnBb,EAAMiB,iBACR,IAGA5O,EAAEgO,GAAWU,GAAG,mCAAmC,SAACf,GAClDkB,EAAKL,aAAc,EACnBb,EAAMiB,iBACR,GACF,GAEA,CAAA7P,IAAA,eAAAC,MAIA,SAAa0O,GAAY,IAAAoB,EAAA,KAEjBC,EAAarB,EAAWpC,KAAK,gBAC9ByD,EAAW5M,SAChB4M,EAAWC,MAAK,SAACtN,EAAGkB,GAAC,OAAKkM,EAAKvE,YAAY3H,EAAE,IAC7C/D,KAAKoQ,cAAcvB,GACrB,GAEA,CAAA3O,IAAA,kBAAAC,OAAAkQ,EAAAjH,EAAAvH,IAAAC,MAGA,SAAAwO,EAAsBhQ,GAAa,IAAAmO,EAAAI,EAAA0B,EAAAC,EAAArB,EAAAsB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,YAAA/P,IAAAmD,MAAA,SAAA6M,GAAA,cAAAA,EAAAnJ,KAAAmJ,EAAA1O,MAAA,OAGkB,GAF7CsL,EAAYnO,EAAcwM,KAAKkB,QAC/Ba,EAAavO,EAAcuO,YACFpC,KAAK,gBACpBnJ,OAAQ,CAAFuO,EAAA1O,KAAA,eAAA0O,EAAA1K,OAAA,wBAAA0K,EAAA1O,KAAA,EACAnD,KAAK8R,YAAYrD,GAAU,OAApC,GAAP8B,EAAOsB,EAAA7K,KACC,CAAF6K,EAAA1O,KAAA,gBAAA0O,EAAA1K,OAAA,kBAGqC,GAFjD4K,EAAqBxB,MAEfC,EAAarP,EAAEoP,GAAS9D,KAAK,QAAQnJ,QAC1BtD,KAAKgS,iBAAe,CAAAH,EAAA1O,KAAA,SACsF,OAAzH8O,QAAQC,IAAI,QAADzG,OAASgD,EAAS,yBAAAhD,OAAwB+E,EAAU,OAAA/E,OAAMzL,KAAKgS,gBAAe,iCAAgCH,EAAA1K,OAAA,kBAIrHgI,GAAYgD,EAAAA,EAAAA,IAAmB7R,EAAcwM,KAAM,eACnD2D,EAAS2B,WAAW9R,EAAcuO,WAAW,GAAGS,MAAM+C,OAAS/R,EAAcwM,KAAKuF,MAClF3B,EAAS0B,WAAW9R,EAAcuO,WAAW,GAAGS,MAAMgD,QAAUhS,EAAcwM,KAAKwF,OACzFnD,EAAUG,MAAMiD,UAAY,SAAH9G,OAAYgF,EAAM,MAAAhF,OAAKiF,EAAM,KACtDvB,EAAUqD,aAAa,MAAOxS,KAAK2L,IAAM,MAAQ,OAE3CgF,EAAgBxP,EAAEoP,GAAS9D,KAAK,qBAAqBgG,UACrD7B,EAAWD,EAAc+B,KAAI,SAAA9M,GACjC,IAAM+M,EAAKf,EAAKgB,gBAAgBhN,GAEhC,OADAuJ,EAAU0D,YAAYF,GACfA,CACT,IAGM9B,EAAiBiC,EAAmB3D,EAAW,uBACjD2B,EAAS,EAACC,EAAAnN,EACwB3B,EAAI0O,EAAeC,IAAS,IAAlE,IAAAG,EAAAhN,MAAAiN,EAAAD,EAAAnO,KAAAQ,MAAoE6N,EAAA/O,EAAA8O,EAAA7Q,MAAA,GAAxD+Q,EAAYD,EAAA,GAAEE,EAAOF,EAAA,GACzBG,EAAiBjQ,EAAE+P,GAAc6B,KAAK,UAAUC,MAAM,KAAKN,IAAIN,YAC/Df,EAAWR,EAAeoC,IAAI9B,GAAQG,EAAApP,EACNkP,EAAc,GAA7CG,EAAOD,EAAA,GAAIE,EAAQF,EAAA,GAAEG,EAAMH,EAAA,GAC5BI,EAAiB1R,KAAK2L,IAAO0F,EAAS6B,MAAQ1B,EAAaD,EAAUF,EAAS8B,KAC9ExB,EAASF,GAAUJ,EAAS+B,IAAMtC,GAExCK,EAAQ7B,MAAMtP,KAAK2L,IAAM,cAAgB,cAAgB,GAAHF,OAAMiG,EAAc,MAC1EP,EAAQ7B,MAAM+D,UAAY,GAAH5H,OAAMkG,EAAM,MACnCb,GAAUa,EACVxC,EAAU0D,YAAY1B,EACvB,OAAAmC,GAAAvC,EAAA3O,EAAAkR,EAAA,SAAAvC,EAAA/N,GAAA,CACD6L,EAAW0E,OAAOpE,GAClBnP,KAAKwT,aAAa3E,GAAY,yBAAAgD,EAAAjJ,OAAA,GAAA0H,EAAA,UAC/B,SA7CoBmD,GAAA,OAAApD,EAAA/G,MAAC,KAADD,UAAA,IA+CrB,CAAAnJ,IAAA,kBAAAC,MAIA,SAAgB+Q,GACd,IAAMC,EAAU5P,SAASmS,cAAc,KACvCvC,EAAQwC,UAAUjF,IAAI,sBACtB,IAAgHkF,EAAA1R,EAAzDf,EAAE+P,GAAc6B,KAAK,UAAUC,MAAM,KAAKN,IAAIN,YAAW,GAAzGyB,EAASD,EAAA,GAAEE,EAAWF,EAAA,GAAEG,EAAUH,EAAA,GAAEI,EAAQJ,EAAA,GAC7CK,EAAgB,GAChBC,EAAQ/S,EAAE+P,GAAczE,KAAK,gBAAgBgG,UACnD,IAAKyB,EAAM5Q,OAAQ,OAAO6N,EAAQ,IAGmDgD,EAHnDC,EAAAxQ,EAGO7B,EAAiBJ,EAAOuS,EAAOG,KAAa,IAArF,IAAAD,EAAArQ,MAAAoQ,EAAAC,EAAAxR,KAAAQ,MAAuF,KAAAkR,EAAApS,EAAAiS,EAAAhU,MAAA,GAA3EoU,EAAQD,EAAA,GAAEE,EAAIF,EAAA,GAAEG,EAAQH,EAAA,GAC5BI,EAAwBF,EAAKG,YAAcT,EAAMA,EAAM5Q,OAAS,GAChEsR,EAASrT,SAASmS,cAAc,QACtCkB,EAAOjB,UAAUjF,IAAI,iBAAiB,IAEkBmG,EAFlBC,EAAAlR,EAEF4Q,EAAKO,MAAMhK,WAAS,IAAxD,IAAA+J,EAAA/Q,MAAA8Q,EAAAC,EAAAlS,KAAAQ,MAA0D,KAAA4R,EAAA9S,EAAA2S,EAAA1U,MAAA,GAA9C8U,EAASD,EAAA,GAAEE,EAAQF,EAAA,GACuDG,EAAAjT,EAArDf,EAAE+T,GAAUnC,KAAK,UAAUC,MAAM,KAAKN,IAAIN,YAAW,GAA3EgD,EAAMD,EAAA,GAAEjC,EAAKiC,EAAA,GAAE/B,EAAG+B,EAAA,GACrBE,EAAaD,EAAShC,EAG5B,GAFAa,EAAc5Q,KAAKgS,GAEF,GAAbJ,SAAkBV,GAAAA,EAAUe,SAASC,YAAYC,OAAOC,SAAS,KAAM,CAKzE,IAAOC,EAA8FxT,EAA7Ef,GAAGsT,GAAYF,GAAUoB,WAAW5C,KAAK,UAAUC,MAAM,KAAKN,IAAIN,YAAW,GAAvF,GACdjR,EAAE+T,GAAUnC,KAAK,SAAU,GAAFtH,OAAKiK,EAAO,KAAAjK,OAAI2J,EAAM,KAAA3J,OAAIyH,EAAK,KAAAzH,OAAI2H,GAC9D,CAEA,IAAMwC,EAASrU,SAASmS,cAAc,QAItC,GAHAkC,EAAOpD,aAAa,QAAS,iBAC7BoD,EAAOL,YAAcL,EAASK,YAAYC,OAEtCP,EAAY,EAAG,CACjB,IAAMY,EAAQtU,SAASmS,cAAc,QACrCmC,EAAMlC,UAAUjF,IAAI,WACpBmH,EAAMN,YAAc,IACpBX,EAAOrB,OAAOsC,GAIdjB,EAAO/B,YAAYtR,SAASuU,eAAe,KAC7C,CAEAlB,EAAO/B,YAAY+C,EACrB,CAAC,OAAAtC,GAAAwB,EAAA1S,EAAAkR,EAAA,SAAAwB,EAAA9R,GAAA,CAED,IAAM+S,EAAYvB,EAAKc,SAASC,YAAYC,OAAOC,SAAS,KACtDO,EAAapB,EAAOqB,SAASrB,EAAOqB,SAAS3S,OAAS,GACxDyS,IAAcrB,IAChBsB,EAAWT,YAAcS,EAAWT,YAAYC,OAAOvR,MAAM,GAAI,GACjE+R,EAAWrC,UAAUjF,IAAI,0BAG3ByC,EAAQ0B,YAAY+B,GACfF,GAA0BqB,GAE7B5E,EAAQ0B,YAAYtR,SAASuU,eAAe,KAEhD,CAAC,OAAAxC,GAAAc,EAAAhS,EAAAkR,EAAA,SAAAc,EAAApR,GAAA,CAEDiR,EAAciC,MAAK,SAACnT,EAAGoT,GAAC,OAAKpT,EAAIoT,CAAC,IAClC,IAAMC,EAAkBnC,EAAcoC,KAAKC,MAA6B,IAAvBrC,EAAc3Q,SAAkB,EACjF6N,EAAQ7B,MAAM6D,KAAO,GAAH1H,OAAMoI,EAAS,MACjC1C,EAAQ7B,MAAM8D,IAAM,GAAH3H,OAAMuI,EAAQ,MAC/B7C,EAAQ7B,MAAM+C,MAAQ,GAAH5G,OAAMsI,EAAaF,EAAS,MAC/C1C,EAAQ7B,MAAMgD,OAAS,GAAH7G,OAAMqI,EAAcE,EAAQ,MAChD7C,EAAQ7B,MAAMiH,SAAW,GAAH9K,OAAM2K,EAAe,MAG3C,IAGsDI,EAHlDC,EAAY3D,EAAmB3B,EAAS,kBAEeuF,EAAA9S,EAC3B3B,EAFfd,EAAE+P,GAAczE,KAAK,QAAQgG,UAC9BtB,EAAQwF,iBAAiB,oBACa,IAAtD,IAAAD,EAAA3S,MAAAyS,EAAAE,EAAA9T,KAAAQ,MAAwD,KAAAwT,EAAA1U,EAAAsU,EAAArW,MAAA,GAA5C0W,EAAOD,EAAA,GAAEhB,EAAMgB,EAAA,GACnBvF,EAAWoF,EAAUxD,IAAI2C,GAC8CkB,EAAA5U,EAApDf,EAAE0V,GAAS9D,KAAK,UAAUC,MAAM,KAAKN,IAAIN,YAAW,GAAtEe,EAAI2D,EAAA,GACPC,EADgBD,EAAA,GACG3D,EAMnB0D,EAAQtB,YAAYE,SAAS,OAC/BsB,EAAWA,GAAYF,EAAQtB,YAAYjS,OAAS,GAAKuT,EAAQtB,YAAYjS,QAE/E,IAAM0T,EAAOD,EAAW1F,EAASgB,MACjCuD,EAAOtG,MAAM2H,cAAgB,GAAHxL,OAAMuL,GAAQH,EAAQtB,YAAYjS,OAAS,GAAE,KACzE,CAGA,OAAAgQ,GAAAoD,EAAAtU,EAAAkR,EAAA,SAAAoD,EAAA1T,GAAA,CACAyT,EAAY3D,EAAmB3B,EAAS,kBACxC,IAMsD+F,GAuItC/U,GA7IVgV,GAAarE,EAAmB3B,EAAS,YAEzCiG,GAAWjW,EAAE+P,GAAczE,KAAK,gBAAgBgG,UAChD4E,GAAUhV,MAAM+B,KAAK+M,EAAQwF,iBAAiB,mBAEhDW,GAAStD,EAASuD,GAAA3T,EACU3B,EAAImV,GAAUC,KAAQ,IAAtD,IAAAE,GAAAxT,MAAAmT,GAAAK,GAAA3U,KAAAQ,MAAwD,KAK+BoU,GAL/BC,GAAAvV,EAAAgV,GAAA/W,MAAA,GAA5CuX,GAAOD,GAAA,GAAE7C,GAAM6C,GAAA,GAEnB1C,GAAQ5T,EAAEuW,IAASjL,KAAK,QAAQgG,UAElCkF,GAAS3X,KAAK2L,IAAMoI,EAAaF,EAAU+D,GAAAhU,EACf3B,EAAI8S,GAAOH,GAAO+B,iBAAiB,oBAAkB,IAArF,IAAAiB,GAAA7T,MAAAyT,GAAAI,GAAAhV,KAAAQ,MAAuF,KAAAyU,GAAA3V,EAAAsV,GAAArX,MAAA,GAA3E0W,GAAOgB,GAAA,GAAEjC,GAAMiC,GAAA,GAEnBC,GAAWrB,EAAUxD,IAAI2C,IACoDmC,GAAA7V,EAApDf,EAAE0V,IAAS9D,KAAK,UAAUC,MAAM,KAAKN,IAAIN,YAAW,GAA5Eb,GAAOwG,GAAA,GAAIvG,GAAQuG,GAAA,GACpBf,GAAQhX,KAAK2L,MAAQ6F,GAAWmG,IAAUpG,GAAUoG,GAE1D,GAAI/B,GAAOoC,uBAAwB,CACjC,IAAMnC,GAAQD,GAAOoC,uBACrBnC,GAAMvG,MAAM2H,cAAgB,GAAHxL,OAAMuL,GAAOG,GAAWlE,IAAI4C,IAAOxD,MAAK,KACnE,MACEuD,GAAOtG,MAAMtP,KAAK2L,IAAM,eAAiB,eAAiB,GAAHF,OAAMuL,GAAI,MAE/DhX,KAAK2L,IAAKgM,IAAUX,GAAOc,GAASzF,MACnCsF,IAAUX,GAAOc,GAASzF,KACjC,CACA,OAAAiB,GAAAsE,GAAAxV,EAAAkR,EAAA,SAAAsE,GAAA5U,GAAA,CACA,IACMgU,GADaX,KAAK4B,IAAG3O,MAAR+M,KAkHL,SAAAlU,GAAA,GAAAE,MAAAC,QAAAH,GAAA,OAAA6B,EAAA7B,EAAA,CAAA+V,CAAA/V,GAlHiB4S,GAAMrC,KAAI,SAAAyF,GAAC,OAAI/F,WAAWjR,EAAEgX,GAAGpF,KAAK,UAAUC,MAAM,KAAK,GAAG,MAkH7E,SAAA7Q,GAAA,uBAAAO,QAAA,MAAAP,EAAAO,OAAAC,WAAA,MAAAR,EAAA,qBAAAE,MAAA+B,KAAAjC,EAAA,CAAAiW,CAAAjW,KAAAsB,EAAAtB,KAAA,qBAAAuB,UAAC,uIAAD,CAAA2U,IAjHYf,GACtB1C,GAAOoD,yBACTpD,GAAOoD,uBAAuB1I,MAAMgJ,WAAa,GAAH7M,OAAMuL,GAAI,MACxDM,IAAUN,GAEd,CAEA,OAAA1D,GAAAiE,GAAAnV,EAAAkR,EAAA,SAAAiE,GAAAvU,GAAA,CAKA,OAJAqU,GAAQA,GAAQ/T,OAAS,GAAGgM,MAAMgJ,WAAa,GAAH7M,OAAMqI,EAAcwD,GAAM,MAGtEnG,EAAQ0B,YAAYtR,SAASmS,cAAc,OACpCvC,CACT,KA1LA,IAAAd,EAtHAvC,CAgTC,CAzZ6B,CAASjO,EAAAA,GAoazC,SAASiT,EAAmByF,EAAU9X,GACpC,IAAM+X,EAAU,CACdC,SAAUF,EAASjJ,MAAMmJ,SACzBC,WAAYH,EAASjJ,MAAMoJ,WAC3BtF,IAAKmF,EAASjJ,MAAM8D,IACpBD,KAAMoF,EAASjJ,MAAM6D,KACrBZ,UAAWgG,EAASjJ,MAAMiD,WAE5BgG,EAASjJ,MAAMmJ,SAAW,WAC1BF,EAASjJ,MAAMoJ,WAAa,SAC5BH,EAASjJ,MAAM8D,IAAM,IACrBmF,EAASjJ,MAAM6D,KAAO,IACtBoF,EAASjJ,MAAMiD,UAAY,OAC3BhR,SAASoX,KAAK9F,YAAY0F,GAC1B,IAAMK,EAAQ,IAAIC,IAChBxW,MAAM+B,KAAKmU,EAAS5B,iBAAiBlW,IAClCiS,KAAI,SAAAkD,GACH,IAAMkD,EAAWlD,EAAOmD,wBACxB,MAAO,CAACnD,EAAQ,IAAIoD,EAClBF,EAAS3F,KAAOrS,OAAOmY,QACvBH,EAAS1F,IAAMtS,OAAOoY,QACtBJ,EAASzG,MACTyG,EAASxG,QAEb,KAIJ,OAFA/Q,SAASoX,KAAKQ,YAAYZ,GAC1BnY,OAAOC,OAAOkY,EAASjJ,MAAOkJ,GACvBI,CACT,CAKA,SAASvE,EAAYG,GACnB,IAAMO,EAAQ5T,EAAEqT,GAAM/H,KAAK,QAAQgG,UACnC,MAAO,CACLkC,WAAYH,EACZO,MAAAA,EACAY,UAAWZ,EAAM,GACjBO,SAAUP,EAAMA,EAAMzR,OAAS,GAEnC,CASO,SAAU3B,EAAOyX,EAAKC,GAAE,IAAAC,EAAAC,EAAAhL,EAAA,OAAA1M,IAAAmD,MAAA,SAAAwU,GAAA,cAAAA,EAAA9Q,KAAA8Q,EAAArW,MAAA,OAAAmW,EAAA1V,EACbwV,GAAGI,EAAA9Q,KAAA,EAAA4Q,EAAAvV,IAAA,WAAAwV,EAAAD,EAAA1W,KAAAQ,KAAE,CAAFoW,EAAArW,KAAA,QAAE,OAAVoL,EAACgL,EAAApZ,MAAAqZ,EAAArW,KAAA,EAAekW,EAAG9K,GAAE,OAAAiL,EAAArW,KAAA,eAAAqW,EAAArW,KAAA,iBAAAqW,EAAA9Q,KAAA,GAAA8Q,EAAA7K,GAAA6K,EAAA,SAAAF,EAAAlX,EAAAoX,EAAA7K,IAAA,eAAA6K,EAAA9Q,KAAA,GAAA4Q,EAAAtW,IAAAwW,EAAAxQ,OAAA,6BAAAwQ,EAAA5Q,OAAA,GAAA6Q,EAAA,qBAU3B,SAAU1X,EAAiBqX,GAAG,IAAA1Q,EAAAgR,EAAAvW,EAAAwW,EAAAC,EAAArL,EAAA,OAAA1M,IAAAmD,MAAA,SAAA6U,GAAA,cAAAA,EAAAnR,KAAAmR,EAAA1W,MAAA,OAC/BuF,OAAOoC,EACP4O,OAAM5O,EACN3H,OAAO2H,EAAS6O,EAAA/V,EACJwV,GAAGS,EAAAnR,KAAA,EAAAiR,EAAA5V,IAAA,WAAA6V,EAAAD,EAAA/W,KAAAQ,KAAE,CAAFyW,EAAA1W,KAAA,SAAP,GAADoL,EAACqL,EAAAzZ,WACS,IAARuZ,EAAmB,CAAAG,EAAA1W,KAAA,SAE5B,OADAA,EAAOoL,EAAEsL,EAAA1W,KAAA,GACH,CAACuF,EAAMgR,EAAKvW,GAAK,QAEzBuF,EAAOgR,EACPA,EAAMnL,EACNpL,OAAO2H,EAAU,QAAA+O,EAAA1W,KAAA,gBAAA0W,EAAA1W,KAAA,iBAAA0W,EAAAnR,KAAA,GAAAmR,EAAAlL,GAAAkL,EAAA,SAAAF,EAAAvX,EAAAyX,EAAAlL,IAAA,eAAAkL,EAAAnR,KAAA,GAAAiR,EAAA3W,IAAA6W,EAAA7Q,OAAA,oBAGA,IAAR0Q,EAAmB,CAAAG,EAAA1W,KAAA,SAC5B,OAD4B0W,EAAA1W,KAAA,GACtB,CAACuF,EAAMgR,EAAKvW,GAAK,yBAAA0W,EAAAjR,OAAA,GAAAhH,EAAA,qBAYpB,SAAUK,EAAI6X,EAAMC,GAAI,IAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAtY,IAAAmD,MAAA,SAAAoV,GAAA,cAAAA,EAAA1R,KAAA0R,EAAAjX,MAAA,OACvB6W,EAAMF,EAAKpX,OAAOC,YAClBsX,EAAMF,EAAKrX,OAAOC,YAAW,OAGZ,GADfuX,EAAKF,EAAI7W,OACTgX,EAAKF,EAAI9W,QACX+W,EAAG9W,OAAQ+W,EAAG/W,KAAI,CAAAgX,EAAAjX,KAAA,eAAAiX,EAAAjT,OAAA,qBAGlB+S,EAAG9W,OAAQ+W,EAAG/W,KAAI,CAAAgX,EAAAjX,KAAA,cACd,IAAIyD,MAAM,qCAAoC,OAEtD,OAFsDwT,EAAAjX,KAAA,GAEhD,CAAC+W,EAAG/Z,MAAOga,EAAGha,OAAM,QAAAia,EAAAjX,KAAA,iCAAAiX,EAAAxR,OAAA,GAAA5G,EAAA,CA8B9B,SAAS+P,EAAqBsI,GAC5B,IAAIlZ,EAAEkZ,GAAOtH,KAAK,WAAcsH,EAAMpE,SAAtC,CAIA,IAAMA,EAAW9U,EAAEkZ,GAAOpE,WAAWxD,UACrC,GAAwB,IAApBwD,EAAS3S,OAAb,CAEC,IAE2BgX,EAF3BC,EAAA3W,EAEmBqS,GAAQ,IAA5B,IAAAsE,EAAAxW,MAAAuW,EAAAC,EAAA3X,KAAAQ,MACE2O,EADcuI,EAAAna,MAEf,OAAAmT,GAAAiH,EAAAnY,EAAAkR,EAAA,SAAAiH,EAAAvX,GAAA,CAED,IAE4BwX,EAFtBC,EAAc,GAAGC,EAAA9W,EAEHqS,GAAQ,IAA5B,IAAAyE,EAAA3W,MAAAyW,EAAAE,EAAA9X,KAAAQ,MAA8B,KAAnBuX,EAAKH,EAAAra,MACTgB,EAAEwZ,GAAO5H,KAAK,WACnB0H,EAAYpX,KAAKlC,EAAEwZ,GAAO5H,KAAK,UAAUC,MAAM,KAAKN,IAAIN,YAC1D,CAAC,OAAAkB,GAAAoH,EAAAtY,EAAAkR,EAAA,SAAAoH,EAAA1X,GAAA,CAED,IAAM4X,EA1CR,SAAyBC,GACvB,IAK+CC,EAL3CC,EAAWC,IACXC,GAAa,IACbC,GAAY,IACZC,EAAUH,IAASI,EAAAxX,EAEkBiX,GAAM,IAA/C,IAAAO,EAAArX,MAAA+W,EAAAM,EAAAxY,KAAAQ,MAAiD,KAAAiY,EAAAnZ,EAAA4Y,EAAA3a,MAAA,GAArCgT,EAAIkI,EAAA,GAAEjG,EAAMiG,EAAA,GAAEnI,EAAKmI,EAAA,GAAEjI,EAAGiI,EAAA,GAClCN,EAAW1E,KAAK4B,IAAI8C,EAAU5H,GAC9B8H,EAAa5E,KAAKiF,IAAIL,EAAY7F,GAClC8F,EAAY7E,KAAKiF,IAAIJ,EAAWhI,GAChCiI,EAAU9E,KAAK4B,IAAIkD,EAAS/H,EAC9B,CAAC,OAAAE,GAAA8H,EAAAhZ,EAAAkR,EAAA,SAAA8H,EAAApY,GAAA,CAED,MAAO,CAAC+X,EAAUE,EAAYC,EAAWC,EAC3C,CA4ByBI,CAAgBd,GACnCpE,KAAKmF,IAAIZ,EAAe,KAAOI,KACjC7Z,EAAEkZ,GAAOtH,KAAK,SAAU6H,EAAea,KAAK,KAf9C,CALA,CAsBF,CApKA9Q,SAAAA,EAAY+Q,eAAe,gBAAiBxQ,GAsK5C,IAGM8N,EAAI,WAYP,OAAAzO,GALD,SAAAyO,EAAYzK,EAAG9I,EAAG4M,EAAOC,GAAQvS,EAAA,KAAAiZ,GAC/BhZ,KAAKuO,EAAIA,EACTvO,KAAKyF,EAAIA,EACTzF,KAAKqS,MAAQA,EACbrS,KAAKsS,OAASA,CAChB,GAAC,EAAApS,IAAA,QAAA+S,IAED,WAAc,OAAOjT,KAAKuO,EAAIvO,KAAKqS,KAAO,GAAC,CAAAnS,IAAA,SAAA+S,IAC3C,WAAe,OAAOjT,KAAKyF,EAAIzF,KAAKsS,MAAQ,GAAC,CAAApS,IAAA,MAAA+S,IAC7C,WAAY,OAAOjT,KAAKyF,CAAG,GAAC,CAAAvF,IAAA,OAAA+S,IAC5B,WAAa,OAAOjT,KAAKuO,CAAG,IAAC,CAjBrB,+HCvlBH,SAASpB,EAAewO,EAAUvO,GAAuD,IAAjDwO,EAASvS,UAAA/F,OAAA,QAAAwH,IAAAzB,UAAA,GAAAA,UAAA,GAAG,CAAC,EAAGwS,EAAexS,UAAA/F,OAAA,QAAAwH,IAAAzB,UAAA,GAAAA,UAAA,GAAGyS,EAC/E,OAAOH,aAAQ,EAARA,EAAUI,QAAQ,qBAAqB,SAACC,EAAIC,GACjD,IAAKA,EAAI,OAAOD,EAEhB,MAC0EE,8CADvDD,EAC0BjJ,MAAM,KAAKN,KAAI,SAAAnE,GAAC,OAAIA,EAAEiH,MAAM,6jBAAlE2G,EAAOD,EAAA,GAAKE,EAAWF,EAAAjY,MAAA,GAI9B,KAHgBkY,KAAWP,MAAaO,KAAW/O,GAGrC,OAAO4O,EAErB,IAAM7b,EAAQgc,KAAWP,EAAYA,EAAUO,GAC3CA,KAAW/O,EAAOA,EAAK+O,GAAW,KAEtC,OADgBC,EAAY1J,KAAI,SAAA9P,GAAC,OAAIiZ,EAAgBjZ,EAAE,IACxCyZ,QAAO,SAACC,EAAK5C,GAAG,OAAKA,EAAI4C,EAAI,GAAEnc,GAASA,EAAMc,WAC/D,GACF,iKAGO,IAAM6a,EAAgB,CAC3BS,UAAWC,yCChCb,IAAIC,EAAuB,cACvBC,EAAQ,EAAQ,MAChBC,EAAc,EAAQ,MAM1BC,EAAOC,QAAU,SAAUC,GACzB,OAAOJ,GAAM,WACX,QAASC,EAAYG,MANf,cAOGA,MACHL,GAAwBE,EAAYG,GAAa3Y,OAAS2Y,CAClE,GACF,wBCdA,IAAI3b,EAAI,EAAQ,MACZ4b,EAAQ,aAKZ5b,EAAE,CAAED,OAAQ,SAAU8b,OAAO,EAAMC,OAJN,EAAQ,IAIMC,CAAuB,SAAW,CAC3E1H,KAAM,WACJ,OAAOuH,EAAM/c,KACf","sources":["webpack://@internetarchive/bookreader/./src/BookReaderPlugin.js","webpack://@internetarchive/bookreader/./src/BookReader/utils/SelectionObserver.js","webpack://@internetarchive/bookreader/./src/plugins/plugin.text_selection.js","webpack://@internetarchive/bookreader/./src/util/strings.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/string-trim-forced.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.trim.js"],"sourcesContent":["// @ts-check\n/** @typedef {import(\"./BookReader.js\").default} BookReader */\n\n/**\n * @template TOptions\n */\nexport class BookReaderPlugin {\n  /**\n   * @param {BookReader} br\n   */\n  constructor(br) {\n    /** @type {BookReader} */\n    this.br = br;\n    /** @type {TOptions} */\n    this.options;\n  }\n\n  /**\n   * @abstract\n   * @param {TOptions} options\n   **/\n  setup(options) {\n    this.options = Object.assign({}, this.options, options);\n  }\n\n  /** @abstract */\n  init() {}\n\n  /**\n   * @abstract\n   * @protected\n   * @param {import (\"./BookReader/PageContainer.js\").PageContainer} pageContainer\n   */\n  _configurePageContainer(pageContainer) {\n  }\n\n  /** @abstract @protected */\n  _bindNavigationHandlers() {}\n\n  /**\n   * @param {JQuery<HTMLElement>} $navBar\n   */\n  extendNavBar($navBar) {}\n}\n","// @ts-check\nexport class SelectionObserver {\n  selecting = false;\n  startedInSelector = false;\n  /** @type {HTMLElement} */\n  target = null;\n\n  /**\n   * @param {string} selector\n   * @param {function('started' | 'cleared', HTMLElement): any} handler\n   */\n  constructor(selector, handler) {\n    this.selector = selector;\n    this.handler = handler;\n  }\n\n  attach() {\n    // We can't just use selectstart, because safari on iOS just\n    // randomly decides when to fire it ðŸ˜¤\n    // document.addEventListener(\"selectstart\", this._onSelectStart);\n    // This has to be on document :/\n    document.addEventListener(\"selectionchange\", this._onSelectionChange);\n  }\n\n  detach() {\n    document.removeEventListener(\"selectionchange\", this._onSelectionChange);\n  }\n\n  _onSelectionChange = () => {\n    const sel = window.getSelection();\n\n    if (!this.selecting && sel.toString()) {\n      const target = $(sel.anchorNode).closest(this.selector)[0];\n      if (!target) return;\n      this.target = target;\n      this.selecting = true;\n      this.handler('started', this.target);\n    }\n\n    if (this.selecting && (sel.isCollapsed || !sel.toString() || !$(sel.anchorNode).closest(this.selector)[0])) {\n      this.selecting = false;\n      this.handler('cleared', this.target);\n    }\n  };\n}\n","//@ts-check\nimport { createDIVPageLayer } from '../BookReader/PageContainer.js';\nimport { SelectionObserver } from '../BookReader/utils/SelectionObserver.js';\nimport { BookReaderPlugin } from '../BookReaderPlugin.js';\nimport { applyVariables } from '../util/strings.js';\n/** @typedef {import('../util/strings.js').StringWithVars} StringWithVars */\n/** @typedef {import('../BookReader/PageContainer.js').PageContainer} PageContainer */\n\nconst BookReader = /** @type {typeof import('../BookReader').default} */(window.BookReader);\n\n/**\n * @template T\n */\nexport class Cache {\n  constructor(maxSize = 10) {\n    this.maxSize = maxSize;\n    /** @type {T[]} */\n    this.entries = [];\n  }\n\n  /**\n   * @param {T} entry\n   */\n  add(entry) {\n    if (this.entries.length >= this.maxSize) {\n      this.entries.shift();\n    }\n    this.entries.push(entry);\n  }\n}\n\nexport class TextSelectionPlugin extends BookReaderPlugin {\n  options = {\n    enabled: true,\n    /** @type {StringWithVars} The URL to fetch the entire DJVU xml. Supports options.vars */\n    fullDjvuXmlUrl: null,\n    /** @type {StringWithVars} The URL to fetch a single page of the DJVU xml. Supports options.vars. Also has {{pageIndex}} */\n    singlePageDjvuXmlUrl: null,\n    /** Whether to fetch the XML as a jsonp */\n    jsonp: false,\n  }\n\n  /**@type {PromiseLike<JQuery<HTMLElement>|undefined>} */\n  djvuPagesPromise = null;\n\n  /** @type {Cache<{index: number, response: any}>} */\n  pageTextCache = new Cache();\n\n  /**\n   * Sometimes there are too many words on a page, and the browser becomes near\n   * unusable. For now don't render text layer for pages with too many words.\n   */\n  maxWordRendered = 2500;\n\n  /**\n   * @param {import('../BookReader.js').default} br\n   */\n  constructor(br) {\n    super(br);\n    // In the future this should be in the ocr file\n    // since a book being right to left doesn't mean the ocr is right to left. But for\n    // now we do make that assumption.\n    /** Whether the book is right-to-left */\n    this.rtl = this.br.pageProgression === 'rl';\n    this.selectionObserver = new SelectionObserver('.BRtextLayer', this._onSelectionChange);\n  }\n\n  /** @override */\n  init() {\n    if (!this.options.enabled) return;\n\n    this.loadData();\n\n    this.selectionObserver.attach();\n    new SelectionObserver('.BRtextLayer', (selectEvent) => {\n      // Track how often selection is used\n      if (selectEvent == 'started') {\n        this.br._plugins.archiveAnalytics?.sendEvent('BookReader', 'SelectStart');\n\n        // Set a class on the page to avoid hiding it when zooming/etc\n        this.br.refs.$br.find('.BRpagecontainer--hasSelection').removeClass('BRpagecontainer--hasSelection');\n        $(window.getSelection().anchorNode).closest('.BRpagecontainer').addClass('BRpagecontainer--hasSelection');\n      }\n    }).attach();\n  }\n\n  /**\n   * @override\n   * @param {PageContainer} pageContainer\n   * @returns {PageContainer}\n   */\n  _configurePageContainer(pageContainer) {\n    // Disable if thumb mode; it's too janky\n    // .page can be null for \"pre-cover\" region\n    if (this.br.mode !== this.br.constModeThumb && pageContainer.page) {\n      this.createTextLayer(pageContainer);\n    }\n    return pageContainer;\n  }\n\n  /**\n   * @param {'started' | 'cleared'} type\n   * @param {HTMLElement} target\n   */\n  _onSelectionChange = (type, target) => {\n    if (type === 'started') {\n      this.textSelectingMode(target);\n    } else if (type === 'cleared') {\n      this.defaultMode(target);\n    } else {\n      throw new Error(`Unknown type ${type}`);\n    }\n  }\n\n  loadData() {\n    // Only fetch the full djvu xml if the single page url isn't there\n    if (this.options.singlePageDjvuXmlUrl) return;\n    this.djvuPagesPromise = $.ajax({\n      type: \"GET\",\n      url: applyVariables(this.options.fullDjvuXmlUrl, this.br.options.vars),\n      dataType: this.options.jsonp ? \"jsonp\" : \"html\",\n      cache: true,\n      xhrFields: {\n        withCredentials: this.br.protected,\n      },\n      error: (e) => undefined,\n    }).then((res) => {\n      try {\n        const xmlMap = $.parseXML(res);\n        return xmlMap && $(xmlMap).find(\"OBJECT\");\n      } catch (e) {\n        return undefined;\n      }\n    });\n  }\n\n  /**\n   * @param {number} index\n   * @returns {Promise<HTMLElement|undefined>}\n   */\n  async getPageText(index) {\n    if (this.options.singlePageDjvuXmlUrl) {\n      const cachedEntry = this.pageTextCache.entries.find(x => x.index == index);\n      if (cachedEntry) {\n        return cachedEntry.response;\n      }\n      const res = await $.ajax({\n        type: \"GET\",\n        url: applyVariables(this.options.singlePageDjvuXmlUrl, this.br.options.vars, { pageIndex: index }),\n        dataType: this.options.jsonp ? \"jsonp\" : \"html\",\n        cache: true,\n        xhrFields: {\n          withCredentials: this.br.protected,\n        },\n        error: (e) => undefined,\n      });\n      try {\n        const xmlDoc = $.parseXML(res);\n        const result = xmlDoc && $(xmlDoc).find(\"OBJECT\")[0];\n        this.pageTextCache.add({ index, response: result });\n        return result;\n      } catch (e) {\n        return undefined;\n      }\n    } else {\n      const XMLpagesArr = await this.djvuPagesPromise;\n      if (XMLpagesArr) return XMLpagesArr[index];\n    }\n  }\n\n  /**\n   * Intercept copied text to remove any styling applied to it\n   * @param {JQuery} $container\n   */\n  interceptCopy($container) {\n    $container[0].addEventListener('copy', (event) => {\n      const selection = document.getSelection();\n      event.clipboardData.setData('text/plain', selection.toString());\n      event.preventDefault();\n    });\n  }\n\n  /**\n   * Applies mouse events when in default mode\n   * @param {HTMLElement} textLayer\n   */\n  defaultMode(textLayer) {\n    const $pageContainer = $(textLayer).closest('.BRpagecontainer');\n    textLayer.style.pointerEvents = \"none\";\n    $pageContainer.find(\"img\").css(\"pointer-events\", \"auto\");\n\n    $(textLayer).off(\".textSelectPluginHandler\");\n    const startedMouseDown = this.mouseIsDown;\n    let skipNextMouseup = this.mouseIsDown;\n    if (startedMouseDown) {\n      textLayer.style.pointerEvents = \"auto\";\n    }\n\n    // Need to stop propagation to prevent DragScrollable from\n    // blocking selection\n    $(textLayer).on(\"mousedown.textSelectPluginHandler\", (event) => {\n      this.mouseIsDown = true;\n      if ($(event.target).is(\".BRwordElement, .BRspace\")) {\n        event.stopPropagation();\n      }\n    });\n\n    $(textLayer).on(\"mouseup.textSelectPluginHandler\", (event) => {\n      this.mouseIsDown = false;\n      textLayer.style.pointerEvents = \"none\";\n      if (skipNextMouseup) {\n        skipNextMouseup = false;\n        event.stopPropagation();\n      }\n    });\n  }\n\n  /**\n   * This mode is active while there is a selection on the given textLayer\n   * @param {HTMLElement} textLayer\n   */\n  textSelectingMode(textLayer) {\n    const $pageContainer = $(textLayer).closest('.BRpagecontainer');\n    // Make text layer consume all events\n    textLayer.style.pointerEvents = \"all\";\n    // Block img from getting long-press to save while selecting\n    $pageContainer.find(\"img\").css(\"pointer-events\", \"none\");\n\n    $(textLayer).off(\".textSelectPluginHandler\");\n\n    $(textLayer).on('mousedown.textSelectPluginHandler', (event) => {\n      this.mouseIsDown = true;\n      event.stopPropagation();\n    });\n\n    // Prevent page flip on click\n    $(textLayer).on('mouseup.textSelectPluginHandler', (event) => {\n      this.mouseIsDown = false;\n      event.stopPropagation();\n    });\n  }\n\n  /**\n   * Initializes text selection modes if there is a text layer on the page\n   * @param {JQuery} $container\n   */\n  stopPageFlip($container) {\n    /** @type {JQuery<HTMLElement>} */\n    const $textLayer = $container.find('.BRtextLayer');\n    if (!$textLayer.length) return;\n    $textLayer.each((i, s) => this.defaultMode(s));\n    this.interceptCopy($container);\n  }\n\n  /**\n   * @param {PageContainer} pageContainer\n   */\n  async createTextLayer(pageContainer) {\n    const pageIndex = pageContainer.page.index;\n    const $container = pageContainer.$container;\n    const $textLayers = $container.find('.BRtextLayer');\n    if ($textLayers.length) return;\n    const XMLpage = await this.getPageText(pageIndex);\n    if (!XMLpage) return;\n    recursivelyAddCoords(XMLpage);\n\n    const totalWords = $(XMLpage).find(\"WORD\").length;\n    if (totalWords > this.maxWordRendered) {\n      console.log(`Page ${pageIndex} has too many words (${totalWords} > ${this.maxWordRendered}). Not rendering text layer.`);\n      return;\n    }\n\n    const textLayer = createDIVPageLayer(pageContainer.page, 'BRtextLayer');\n    const ratioW = parseFloat(pageContainer.$container[0].style.width) / pageContainer.page.width;\n    const ratioH = parseFloat(pageContainer.$container[0].style.height) / pageContainer.page.height;\n    textLayer.style.transform = `scale(${ratioW}, ${ratioH})`;\n    textLayer.setAttribute(\"dir\", this.rtl ? \"rtl\" : \"ltr\");\n\n    const ocrParagraphs = $(XMLpage).find(\"PARAGRAPH[coords]\").toArray();\n    const paragEls = ocrParagraphs.map(p => {\n      const el = this.renderParagraph(p);\n      textLayer.appendChild(el);\n      return el;\n    });\n\n    // Fix up paragraph positions\n    const paragraphRects = determineRealRects(textLayer, '.BRparagraphElement');\n    let yAdded = 0;\n    for (const [ocrParagraph, paragEl] of zip(ocrParagraphs, paragEls)) {\n      const ocrParagBounds = $(ocrParagraph).attr(\"coords\").split(\",\").map(parseFloat);\n      const realRect = paragraphRects.get(paragEl);\n      const [ocrLeft, , ocrRight, ocrTop] = ocrParagBounds;\n      const newStartMargin = this.rtl ? (realRect.right - ocrRight) : (ocrLeft - realRect.left);\n      const newTop = ocrTop - (realRect.top + yAdded);\n\n      paragEl.style[this.rtl ? 'marginRight' : 'marginLeft'] = `${newStartMargin}px`;\n      paragEl.style.marginTop = `${newTop}px`;\n      yAdded += newTop;\n      textLayer.appendChild(paragEl);\n    }\n    $container.append(textLayer);\n    this.stopPageFlip($container);\n  }\n\n  /**\n   * @param {HTMLElement} ocrParagraph\n   * @returns {HTMLParagraphElement}\n   */\n  renderParagraph(ocrParagraph) {\n    const paragEl = document.createElement('p');\n    paragEl.classList.add('BRparagraphElement');\n    const [paragLeft, paragBottom, paragRight, paragTop] = $(ocrParagraph).attr(\"coords\").split(\",\").map(parseFloat);\n    const wordHeightArr = [];\n    const lines = $(ocrParagraph).find(\"LINE[coords]\").toArray();\n    if (!lines.length) return paragEl;\n\n\n    for (const [prevLine, line, nextLine] of lookAroundWindow(genMap(lines, augmentLine))) {\n      const isLastLineOfParagraph = line.ocrElement == lines[lines.length - 1];\n      const lineEl = document.createElement('span');\n      lineEl.classList.add('BRlineElement');\n\n      for (const [wordIndex, currWord] of line.words.entries()) {\n        const [, bottom, right, top] = $(currWord).attr(\"coords\").split(',').map(parseFloat);\n        const wordHeight = bottom - top;\n        wordHeightArr.push(wordHeight);\n\n        if (wordIndex == 0 && prevLine?.lastWord.textContent.trim().endsWith('-')) {\n          // ideally prefer the next line to determine the left position,\n          // since the previous line could be the first line of the paragraph\n          // and hence have an incorrectly indented first word.\n          // E.g. https://archive.org/details/driitaleofdaring00bachuoft/page/360/mode/2up\n          const [newLeft, , , ] = $((nextLine || prevLine).firstWord).attr(\"coords\").split(',').map(parseFloat);\n          $(currWord).attr(\"coords\", `${newLeft},${bottom},${right},${top}`);\n        }\n\n        const wordEl = document.createElement('span');\n        wordEl.setAttribute(\"class\", \"BRwordElement\");\n        wordEl.textContent = currWord.textContent.trim();\n\n        if (wordIndex > 0) {\n          const space = document.createElement('span');\n          space.classList.add('BRspace');\n          space.textContent = ' ';\n          lineEl.append(space);\n\n          // Edge ignores empty elements (like BRspace), so add another\n          // space to ensure Edge's ReadAloud works correctly.\n          lineEl.appendChild(document.createTextNode(' '));\n        }\n\n        lineEl.appendChild(wordEl);\n      }\n\n      const hasHyphen = line.lastWord.textContent.trim().endsWith('-');\n      const lastWordEl = lineEl.children[lineEl.children.length - 1];\n      if (hasHyphen && !isLastLineOfParagraph) {\n        lastWordEl.textContent = lastWordEl.textContent.trim().slice(0, -1);\n        lastWordEl.classList.add('BRwordElement--hyphen');\n      }\n\n      paragEl.appendChild(lineEl);\n      if (!isLastLineOfParagraph && !hasHyphen) {\n        // Edge does not correctly have spaces between the lines.\n        paragEl.appendChild(document.createTextNode(' '));\n      }\n    }\n\n    wordHeightArr.sort((a, b) => a - b);\n    const paragWordHeight = wordHeightArr[Math.floor(wordHeightArr.length * 0.85)] + 4;\n    paragEl.style.left = `${paragLeft}px`;\n    paragEl.style.top = `${paragTop}px`;\n    paragEl.style.width = `${paragRight - paragLeft}px`;\n    paragEl.style.height = `${paragBottom - paragTop}px`;\n    paragEl.style.fontSize = `${paragWordHeight}px`;\n\n    // Fix up sizes - stretch/crush words as necessary using letter spacing\n    let wordRects = determineRealRects(paragEl, '.BRwordElement');\n    const ocrWords = $(ocrParagraph).find(\"WORD\").toArray();\n    const wordEls = paragEl.querySelectorAll('.BRwordElement');\n    for (const [ocrWord, wordEl] of zip(ocrWords, wordEls)) {\n      const realRect = wordRects.get(wordEl);\n      const [left, , right ] = $(ocrWord).attr(\"coords\").split(',').map(parseFloat);\n      let ocrWidth = right - left;\n      // Some books (eg theworksofplato01platiala) have a space _inside_ the <WORD>\n      // element. That makes it impossible to determine the correct positining\n      // of everything, but to avoid the BRspace's being width 0, which makes selection\n      // janky on Chrome Android, assume the space is the same width as one of the\n      // letters.\n      if (ocrWord.textContent.endsWith(' ')) {\n        ocrWidth = ocrWidth * (ocrWord.textContent.length - 1) / ocrWord.textContent.length;\n      }\n      const diff = ocrWidth - realRect.width;\n      wordEl.style.letterSpacing = `${diff / (ocrWord.textContent.length - 1)}px`;\n    }\n\n    // Stretch/crush lines as necessary using line spacing\n    // Recompute rects after letter spacing\n    wordRects = determineRealRects(paragEl, '.BRwordElement');\n    const spaceRects = determineRealRects(paragEl, '.BRspace');\n\n    const ocrLines = $(ocrParagraph).find(\"LINE[coords]\").toArray();\n    const lineEls = Array.from(paragEl.querySelectorAll('.BRlineElement'));\n\n    let ySoFar = paragTop;\n    for (const [ocrLine, lineEl] of zip(ocrLines, lineEls)) {\n      // shift words using marginLeft to align with the correct x position\n      const words = $(ocrLine).find(\"WORD\").toArray();\n      // const ocrLineLeft = Math.min(...words.map(w => parseFloat($(w).attr(\"coords\").split(',')[0])));\n      let xSoFar = this.rtl ? paragRight : paragLeft;\n      for (const [ocrWord, wordEl] of zip(words, lineEl.querySelectorAll('.BRwordElement'))) {\n        // start of line, need to compute the offset relative to the OCR words\n        const wordRect = wordRects.get(wordEl);\n        const [ocrLeft, , ocrRight ] = $(ocrWord).attr(\"coords\").split(',').map(parseFloat);\n        const diff = (this.rtl ? -(ocrRight - xSoFar) : ocrLeft - xSoFar);\n\n        if (wordEl.previousElementSibling) {\n          const space = wordEl.previousElementSibling;\n          space.style.letterSpacing = `${diff - spaceRects.get(space).width}px`;\n        } else {\n          wordEl.style[this.rtl ? 'paddingRight' : 'paddingLeft'] = `${diff}px`;\n        }\n        if (this.rtl) xSoFar -= diff + wordRect.width;\n        else xSoFar += diff + wordRect.width;\n      }\n      // And also fix y position\n      const ocrLineTop = Math.min(...words.map(w => parseFloat($(w).attr(\"coords\").split(',')[3])));\n      const diff = ocrLineTop - ySoFar;\n      if (lineEl.previousElementSibling) {\n        lineEl.previousElementSibling.style.lineHeight = `${diff}px`;\n        ySoFar += diff;\n      }\n    }\n\n    // The last line will have a line height subtracting from the paragraph height\n    lineEls[lineEls.length - 1].style.lineHeight = `${paragBottom - ySoFar}px`;\n\n    // Edge does not include a newline for some reason when copying/pasting the <p> els\n    paragEl.appendChild(document.createElement('br'));\n    return paragEl;\n  }\n}\n\nBookReader?.registerPlugin('textSelection', TextSelectionPlugin);\n\n\n/**\n * @param {HTMLElement} parentEl\n * @param {string} selector\n * @returns {Map<Element, Rect>}\n */\nfunction determineRealRects(parentEl, selector) {\n  const initals = {\n    position: parentEl.style.position,\n    visibility: parentEl.style.visibility,\n    top: parentEl.style.top,\n    left: parentEl.style.left,\n    transform: parentEl.style.transform,\n  };\n  parentEl.style.position = 'absolute';\n  parentEl.style.visibility = 'hidden';\n  parentEl.style.top = '0';\n  parentEl.style.left = '0';\n  parentEl.style.transform = 'none';\n  document.body.appendChild(parentEl);\n  const rects = new Map(\n    Array.from(parentEl.querySelectorAll(selector))\n      .map(wordEl => {\n        const origRect = wordEl.getBoundingClientRect();\n        return [wordEl, new Rect(\n          origRect.left + window.scrollX,\n          origRect.top + window.scrollY,\n          origRect.width,\n          origRect.height,\n        )];\n      }),\n  );\n  document.body.removeChild(parentEl);\n  Object.assign(parentEl.style, initals);\n  return rects;\n}\n\n/**\n * @param {HTMLElement} line\n */\nfunction augmentLine(line) {\n  const words = $(line).find(\"WORD\").toArray();\n  return {\n    ocrElement: line,\n    words,\n    firstWord: words[0],\n    lastWord: words[words.length - 1],\n  };\n}\n\n/**\n * @template TFrom, TTo\n * Generator version of map\n * @param {Iterable<TFrom>} gen\n * @param {function(TFrom): TTo} fn\n * @returns {Iterable<TTo>}\n */\nexport function* genMap(gen, fn) {\n  for (const x of gen) yield fn(x);\n}\n\n/**\n * @template T\n * Generator that provides a sliding window of 3 elements,\n * prev, current, and next.\n * @param {Iterable<T>} gen\n * @returns {Iterable<[T | undefined, T, T | undefined]>}\n */\nexport function* lookAroundWindow(gen) {\n  let prev = undefined;\n  let cur = undefined;\n  let next = undefined;\n  for (const x of gen) {\n    if (typeof cur !== 'undefined') {\n      next = x;\n      yield [prev, cur, next];\n    }\n    prev = cur;\n    cur = x;\n    next = undefined;\n  }\n\n  if (typeof cur !== 'undefined') {\n    yield [prev, cur, next];\n  }\n}\n\n/**\n * @template T1, T2\n * Lazy zip implementation to avoid importing lodash\n * Expects iterators to be of the same length\n * @param {Iterable<T1>} gen1\n * @param {Iterable<T2>} gen2\n * @returns {Iterable<[T1, T2]>}\n */\nexport function* zip(gen1, gen2) {\n  const it1 = gen1[Symbol.iterator]();\n  const it2 = gen2[Symbol.iterator]();\n  while (true) {\n    const r1 = it1.next();\n    const r2 = it2.next();\n    if (r1.done && r2.done) {\n      return;\n    }\n    if (r1.done || r2.done) {\n      throw new Error('zip: one of the iterators is done');\n    }\n    yield [r1.value, r2.value];\n  }\n}\n\n/**\n * [left, bottom, right, top]\n * @param {Array<[number, number, number, number]>} bounds\n * @returns {[number, number, number, number]}\n */\nfunction determineBounds(bounds) {\n  let leftMost = Infinity;\n  let bottomMost = -Infinity;\n  let rightMost = -Infinity;\n  let topMost = Infinity;\n\n  for (const [left, bottom, right, top] of bounds) {\n    leftMost = Math.min(leftMost, left);\n    bottomMost = Math.max(bottomMost, bottom);\n    rightMost = Math.max(rightMost, right);\n    topMost = Math.min(topMost, top);\n  }\n\n  return [leftMost, bottomMost, rightMost, topMost];\n}\n\n/**\n * Recursively traverses the XML tree and adds coords\n * which are the bounding box of all child coords\n * @param {Element} xmlEl\n */\nfunction recursivelyAddCoords(xmlEl) {\n  if ($(xmlEl).attr('coords') || !xmlEl.children) {\n    return;\n  }\n\n  const children = $(xmlEl).children().toArray();\n  if (children.length === 0) {\n    return;\n  }\n\n  for (const child of children) {\n    recursivelyAddCoords(child);\n  }\n\n  const childCoords = [];\n\n  for (const child of children) {\n    if (!$(child).attr('coords')) continue;\n    childCoords.push($(child).attr('coords').split(',').map(parseFloat));\n  }\n\n  const boundingCoords = determineBounds(childCoords);\n  if (Math.abs(boundingCoords[0]) != Infinity) {\n    $(xmlEl).attr('coords', boundingCoords.join(','));\n  }\n}\n\n/**\n * Basically a polyfill for the native DOMRect class\n */\nclass Rect {\n  /**\n   * @param {number} x\n   * @param {number} y\n   * @param {number} width\n   * @param {number} height\n   */\n  constructor(x, y, width, height) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n  }\n\n  get right() { return this.x + this.width; }\n  get bottom() { return this.y + this.height; }\n  get top() { return this.y; }\n  get left() { return this.x; }\n}\n","/**\n * @typedef {String} StringWithVars\n * A template string with {{foo}} style variables\n * Also supports filters, like {{bookPath|urlencode}} (See APPLY_FILTERS for the\n * supported list of filters)\n **/\n\n/**\n * @param {StringWithVars|String} template\n * @param { {[varName: string]: { toString: () => string} } } vars\n * @param { {[varName: string]: { toString: () => string} } } [overrides]\n * @returns {StringWithVars|string}\n */\nexport function applyVariables(template, vars, overrides = {}, possibleFilters = APPLY_FILTERS) {\n  return template?.replace(/\\{\\{([^}]*?)\\}\\}/g, ($0, $1) => {\n    if (!$1) return $0;\n    /** @type {string} */\n    const expression = $1;\n    const [varName, ...filterNames] = expression.split('|').map(x => x.trim());\n    const defined = varName in overrides || varName in vars;\n\n    // If it's not defined, don't expand it at all\n    if (!defined) return $0;\n\n    const value = varName in overrides ? overrides[varName]\n      : varName in vars ? vars[varName] : null;\n    const filters = filterNames.map(n => possibleFilters[n]);\n    return filters.reduce((acc, cur) => cur(acc), value && value.toString());\n  });\n}\n\n/** @type { {[filterName: String]:( string => string)} } */\nexport const APPLY_FILTERS = {\n  urlencode: encodeURIComponent,\n};\n","'use strict';\nvar PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]()\n      || non[METHOD_NAME]() !== non\n      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n"],"names":["BookReaderPlugin","br","_classCallCheck","this","options","key","value","Object","assign","pageContainer","$navBar","SelectionObserver","selector","handler","_this","_defineProperty","sel","window","getSelection","selecting","toString","target","$","anchorNode","closest","isCollapsed","document","addEventListener","_onSelectionChange","removeEventListener","genMap","_marked2","_regeneratorRuntime","mark","lookAroundWindow","_marked3","zip","_slicedToArray","r","e","Array","isArray","_arrayWithHoles","l","t","Symbol","iterator","n","i","u","a","f","o","call","next","done","push","length","return","_iterableToArrayLimit","_unsupportedIterableToArray","TypeError","_nonIterableRest","_createForOfIteratorHelper","_n","F","s","_arrayLikeToArray","slice","constructor","name","from","test","prototype","hasOwnProperty","defineProperty","c","asyncIterator","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","resultName","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","_callSuper","_getPrototypeOf","ReferenceError","_assertThisInitialized","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","Boolean","valueOf","bind","_setPrototypeOf","_toPropertyKey","_defineProperties","_createClass","toPrimitive","String","_toPrimitive","BookReader","Cache","maxSize","undefined","entries","entry","shift","TextSelectionPlugin","_BookReaderPlugin","enabled","fullDjvuXmlUrl","singlePageDjvuXmlUrl","jsonp","textSelectingMode","concat","defaultMode","rtl","pageProgression","selectionObserver","_inherits","_this2","loadData","attach","selectEvent","_this2$br$_plugins$ar","_plugins","archiveAnalytics","sendEvent","refs","$br","find","removeClass","addClass","mode","constModeThumb","page","createTextLayer","djvuPagesPromise","ajax","url","applyVariables","vars","dataType","cache","xhrFields","withCredentials","protected","error","res","xmlMap","parseXML","_getPageText","_callee","index","cachedEntry","xmlDoc","result","XMLpagesArr","_context","pageTextCache","x","response","pageIndex","add","t0","_x","$container","event","selection","clipboardData","setData","preventDefault","textLayer","_this3","$pageContainer","style","pointerEvents","css","off","startedMouseDown","mouseIsDown","skipNextMouseup","on","is","stopPropagation","_this4","_this5","$textLayer","each","interceptCopy","_createTextLayer","_callee2","XMLpage","totalWords","ratioW","ratioH","ocrParagraphs","paragEls","paragraphRects","yAdded","_iterator","_step","_step$value","ocrParagraph","paragEl","ocrParagBounds","realRect","_ocrParagBounds","ocrLeft","ocrRight","ocrTop","newStartMargin","newTop","_this6","_context2","getPageText","recursivelyAddCoords","maxWordRendered","console","log","createDIVPageLayer","parseFloat","width","height","transform","setAttribute","toArray","map","el","renderParagraph","appendChild","determineRealRects","attr","split","get","right","left","top","marginTop","err","append","stopPageFlip","_x2","createElement","classList","_$$attr$split$map2","paragLeft","paragBottom","paragRight","paragTop","wordHeightArr","lines","_step2","_iterator2","augmentLine","_step2$value","prevLine","line","nextLine","isLastLineOfParagraph","ocrElement","lineEl","_step5","_iterator5","words","_step5$value","wordIndex","currWord","_$$attr$split$map4","bottom","wordHeight","lastWord","textContent","trim","endsWith","newLeft","firstWord","wordEl","space","createTextNode","hasHyphen","lastWordEl","children","sort","b","paragWordHeight","Math","floor","fontSize","_step3","wordRects","_iterator3","querySelectorAll","_step3$value","ocrWord","_$$attr$split$map8","ocrWidth","diff","letterSpacing","_step4","spaceRects","ocrLines","lineEls","ySoFar","_iterator4","_step6","_step4$value","ocrLine","xSoFar","_iterator6","_step6$value","wordRect","_$$attr$split$map10","previousElementSibling","min","_arrayWithoutHoles","w","_iterableToArray","_nonIterableSpread","lineHeight","parentEl","initals","position","visibility","body","rects","Map","origRect","getBoundingClientRect","Rect","scrollX","scrollY","removeChild","gen","fn","_iterator7","_step7","_context3","_marked","cur","_iterator8","_step8","_context4","gen1","gen2","it1","it2","r1","r2","_context5","xmlEl","_step10","_iterator10","_step11","childCoords","_iterator11","child","boundingCoords","bounds","_step9","leftMost","Infinity","bottomMost","rightMost","topMost","_iterator9","_step9$value","max","determineBounds","abs","join","registerPlugin","template","overrides","possibleFilters","APPLY_FILTERS","replace","$0","$1","_expression$split$map2","varName","filterNames","reduce","acc","urlencode","encodeURIComponent","PROPER_FUNCTION_NAME","fails","whitespaces","module","exports","METHOD_NAME","$trim","proto","forced","forcedStringTrimMethod"],"sourceRoot":""}