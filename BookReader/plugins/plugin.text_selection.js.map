{"version":3,"file":"plugins/plugin.text_selection.js","mappings":"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","sources":["webpack://@internetarchive/bookreader/./node_modules/core-js/internals/string-trim-forced.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.trim.js","webpack://@internetarchive/bookreader/./src/BookReaderPlugin.js","webpack://@internetarchive/bookreader/./src/BookReader/utils/SelectionObserver.js","webpack://@internetarchive/bookreader/./src/plugins/plugin.text_selection.js","webpack://@internetarchive/bookreader/./src/util/strings.js"],"sourcesContent":["'use strict';\nvar PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]()\n      || non[METHOD_NAME]() !== non\n      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","// @ts-check\n/** @typedef {import(\"./BookReader.js\").default} BookReader */\n\n/**\n * @template TOptions\n */\nexport class BookReaderPlugin {\n  /**\n   * @param {BookReader} br\n   */\n  constructor(br) {\n    /** @type {BookReader} */\n    this.br = br;\n    /** @type {TOptions} */\n    this.options;\n  }\n\n  /**\n   * @abstract\n   * @param {TOptions} options\n   **/\n  setup(options) {\n    this.options = Object.assign({}, this.options, options);\n  }\n\n  /** @abstract */\n  init() {}\n\n  /**\n   * @abstract\n   * @protected\n   * @param {import (\"./BookReader/PageContainer.js\").PageContainer} pageContainer\n   */\n  _configurePageContainer(pageContainer) {\n  }\n\n  /**\n   * @abstract\n   * @protected\n   * @param {JQuery<HTMLElement>} $toolbarElement\n   */\n  _configureToolbar($toolbarElement) {\n  }\n\n  /** @abstract @protected */\n  _bindNavigationHandlers() {}\n\n  /**\n   * @param {JQuery<HTMLElement>} $navBar\n   */\n  extendNavBar($navBar) {}\n}\n","// @ts-check\nexport class SelectionObserver {\n  selecting = false;\n  startedInSelector = false;\n  /** @type {HTMLElement} */\n  target = null;\n\n  /**\n   * @param {string} selector\n   * @param {function('started' | 'cleared', HTMLElement): any} handler\n   */\n  constructor(selector, handler) {\n    this.selector = selector;\n    this.handler = handler;\n  }\n\n  attach() {\n    // We can't just use selectstart, because safari on iOS just\n    // randomly decides when to fire it ðŸ˜¤\n    // document.addEventListener(\"selectstart\", this._onSelectStart);\n    // This has to be on document :/\n    document.addEventListener(\"selectionchange\", this._onSelectionChange);\n  }\n\n  detach() {\n    document.removeEventListener(\"selectionchange\", this._onSelectionChange);\n  }\n\n  _onSelectionChange = () => {\n    const sel = window.getSelection();\n\n    if (!this.selecting && sel.toString()) {\n      const target = $(sel.anchorNode).closest(this.selector)[0];\n      if (!target) return;\n      this.target = target;\n      this.selecting = true;\n      this.handler('started', this.target);\n    }\n\n    if (this.selecting && (sel.isCollapsed || !sel.toString() || !$(sel.anchorNode).closest(this.selector)[0])) {\n      this.selecting = false;\n      this.handler('cleared', this.target);\n    }\n  };\n}\n","//@ts-check\nimport { createDIVPageLayer } from '../BookReader/PageContainer.js';\nimport { SelectionObserver } from '../BookReader/utils/SelectionObserver.js';\nimport { BookReaderPlugin } from '../BookReaderPlugin.js';\nimport { applyVariables } from '../util/strings.js';\n/** @typedef {import('../util/strings.js').StringWithVars} StringWithVars */\n/** @typedef {import('../BookReader/PageContainer.js').PageContainer} PageContainer */\n\nconst BookReader = /** @type {typeof import('../BookReader').default} */(window.BookReader);\n\n/**\n * @template T\n */\nexport class Cache {\n  constructor(maxSize = 10) {\n    this.maxSize = maxSize;\n    /** @type {T[]} */\n    this.entries = [];\n  }\n\n  /**\n   * @param {T} entry\n   */\n  add(entry) {\n    if (this.entries.length >= this.maxSize) {\n      this.entries.shift();\n    }\n    this.entries.push(entry);\n  }\n}\n\nexport class TextSelectionPlugin extends BookReaderPlugin {\n  options = {\n    enabled: true,\n    /** @type {StringWithVars} The URL to fetch the entire DJVU xml. Supports options.vars */\n    fullDjvuXmlUrl: null,\n    /** @type {StringWithVars} The URL to fetch a single page of the DJVU xml. Supports options.vars. Also has {{pageIndex}} */\n    singlePageDjvuXmlUrl: null,\n    /** Whether to fetch the XML as a jsonp */\n    jsonp: false,\n    /** Mox words tha can be selected when the text layer is protected */\n    maxProtectedWords: 200,\n  }\n\n  /**@type {PromiseLike<JQuery<HTMLElement>|undefined>} */\n  djvuPagesPromise = null;\n\n  /** @type {Cache<{index: number, response: any}>} */\n  pageTextCache = new Cache();\n\n  /**\n   * Sometimes there are too many words on a page, and the browser becomes near\n   * unusable. For now don't render text layer for pages with too many words.\n   */\n  maxWordRendered = 2500;\n\n  /**\n   * @param {import('../BookReader.js').default} br\n   */\n  constructor(br) {\n    super(br);\n    // In the future this should be in the ocr file\n    // since a book being right to left doesn't mean the ocr is right to left. But for\n    // now we do make that assumption.\n    /** Whether the book is right-to-left */\n    this.rtl = this.br.pageProgression === 'rl';\n    this.selectionObserver = new SelectionObserver('.BRtextLayer', this._onSelectionChange);\n  }\n\n  /** @override */\n  init() {\n    if (!this.options.enabled) return;\n\n    this.loadData();\n\n    this.selectionObserver.attach();\n    new SelectionObserver('.BRtextLayer', (selectEvent) => {\n      // Track how often selection is used\n      if (selectEvent == 'started') {\n        this.br.plugins.archiveAnalytics?.sendEvent('BookReader', 'SelectStart');\n\n        // Set a class on the page to avoid hiding it when zooming/etc\n        this.br.refs.$br.find('.BRpagecontainer--hasSelection').removeClass('BRpagecontainer--hasSelection');\n        $(window.getSelection().anchorNode).closest('.BRpagecontainer').addClass('BRpagecontainer--hasSelection');\n      }\n    }).attach();\n\n    if (this.br.protected) {\n      document.addEventListener('selectionchange', this._limitSelection);\n      // Prevent right clicking when selected text\n      $(document.body).on('contextmenu dragstart copy', (e) => {\n        const selection = document.getSelection();\n        if (selection?.toString()) {\n          const intersectsTextLayer = $('.BRtextLayer')\n            .toArray()\n            .some(el => selection.containsNode(el, true));\n          if (intersectsTextLayer) {\n            e.preventDefault();\n            return false;\n          }\n        }\n      });\n    }\n  }\n\n  _limitSelection = () => {\n    const selection = window.getSelection();\n    if (!selection.rangeCount) return;\n\n    const range = selection.getRangeAt(0);\n\n    // Check if range.startContainer is inside the sub-tree of .BRContainer\n    const startInBr = !!range.startContainer.parentElement.closest('.BRcontainer');\n    const endInBr = !!range.endContainer.parentElement.closest('.BRcontainer');\n    if (!startInBr && !endInBr) return;\n    if (!startInBr || !endInBr) {\n      // weird case, just clear the selection\n      selection.removeAllRanges();\n      return;\n    }\n\n    // Find the last allowed word in the selection\n    const lastAllowedWord = genAt(\n      genFilter(\n        walkBetweenNodes(range.startContainer, range.endContainer),\n        (node) => node.classList?.contains('BRwordElement'),\n      ),\n      this.options.maxProtectedWords - 1,\n    );\n\n    if (!lastAllowedWord || range.endContainer.parentNode == lastAllowedWord) return;\n\n    const newRange = document.createRange();\n    newRange.setStart(range.startContainer, range.startOffset);\n    newRange.setEnd(lastAllowedWord.firstChild, lastAllowedWord.textContent.length);\n\n    selection.removeAllRanges();\n    selection.addRange(newRange);\n  };\n\n  /**\n   * @override\n   * @param {PageContainer} pageContainer\n   * @returns {PageContainer}\n   */\n  _configurePageContainer(pageContainer) {\n    // Disable if thumb mode; it's too janky\n    // .page can be null for \"pre-cover\" region\n    if (this.br.mode !== this.br.constModeThumb && pageContainer.page) {\n      this.createTextLayer(pageContainer);\n    }\n    return pageContainer;\n  }\n\n  /**\n   * @param {'started' | 'cleared'} type\n   * @param {HTMLElement} target\n   */\n  _onSelectionChange = (type, target) => {\n    if (type === 'started') {\n      this.textSelectingMode(target);\n    } else if (type === 'cleared') {\n      this.defaultMode(target);\n    } else {\n      throw new Error(`Unknown type ${type}`);\n    }\n  }\n\n  loadData() {\n    // Only fetch the full djvu xml if the single page url isn't there\n    if (this.options.singlePageDjvuXmlUrl) return;\n    this.djvuPagesPromise = $.ajax({\n      type: \"GET\",\n      url: applyVariables(this.options.fullDjvuXmlUrl, this.br.options.vars),\n      dataType: this.options.jsonp ? \"jsonp\" : \"html\",\n      cache: true,\n      xhrFields: {\n        withCredentials: this.br.protected,\n      },\n      error: (e) => undefined,\n    }).then((res) => {\n      try {\n        const xmlMap = $.parseXML(res);\n        return xmlMap && $(xmlMap).find(\"OBJECT\");\n      } catch (e) {\n        return undefined;\n      }\n    });\n  }\n\n  /**\n   * @param {number} index\n   * @returns {Promise<HTMLElement|undefined>}\n   */\n  async getPageText(index) {\n    if (this.options.singlePageDjvuXmlUrl) {\n      const cachedEntry = this.pageTextCache.entries.find(x => x.index == index);\n      if (cachedEntry) {\n        return cachedEntry.response;\n      }\n      const res = await $.ajax({\n        type: \"GET\",\n        url: applyVariables(this.options.singlePageDjvuXmlUrl, this.br.options.vars, { pageIndex: index }),\n        dataType: this.options.jsonp ? \"jsonp\" : \"html\",\n        cache: true,\n        xhrFields: {\n          withCredentials: this.br.protected,\n        },\n        error: (e) => undefined,\n      });\n      try {\n        const xmlDoc = $.parseXML(res);\n        const result = xmlDoc && $(xmlDoc).find(\"OBJECT\")[0];\n        this.pageTextCache.add({ index, response: result });\n        return result;\n      } catch (e) {\n        return undefined;\n      }\n    } else {\n      const XMLpagesArr = await this.djvuPagesPromise;\n      if (XMLpagesArr) return XMLpagesArr[index];\n    }\n  }\n\n  /**\n   * Intercept copied text to remove any styling applied to it\n   * @param {JQuery} $container\n   */\n  interceptCopy($container) {\n    $container[0].addEventListener('copy', (event) => {\n      const selection = document.getSelection();\n      event.clipboardData.setData('text/plain', selection.toString());\n      event.preventDefault();\n    });\n  }\n\n  /**\n   * Applies mouse events when in default mode\n   * @param {HTMLElement} textLayer\n   */\n  defaultMode(textLayer) {\n    const $pageContainer = $(textLayer).closest('.BRpagecontainer');\n    textLayer.style.pointerEvents = \"none\";\n    $pageContainer.find(\"img\").css(\"pointer-events\", \"auto\");\n\n    $(textLayer).off(\".textSelectPluginHandler\");\n    const startedMouseDown = this.mouseIsDown;\n    let skipNextMouseup = this.mouseIsDown;\n    if (startedMouseDown) {\n      textLayer.style.pointerEvents = \"auto\";\n    }\n\n    // Need to stop propagation to prevent DragScrollable from\n    // blocking selection\n    $(textLayer).on(\"mousedown.textSelectPluginHandler\", (event) => {\n      this.mouseIsDown = true;\n      if ($(event.target).is(\".BRwordElement, .BRspace\")) {\n        event.stopPropagation();\n      }\n    });\n\n    $(textLayer).on(\"mouseup.textSelectPluginHandler\", (event) => {\n      this.mouseIsDown = false;\n      textLayer.style.pointerEvents = \"none\";\n      if (skipNextMouseup) {\n        skipNextMouseup = false;\n        event.stopPropagation();\n      }\n    });\n  }\n\n  /**\n   * This mode is active while there is a selection on the given textLayer\n   * @param {HTMLElement} textLayer\n   */\n  textSelectingMode(textLayer) {\n    const $pageContainer = $(textLayer).closest('.BRpagecontainer');\n    // Make text layer consume all events\n    textLayer.style.pointerEvents = \"all\";\n    // Block img from getting long-press to save while selecting\n    $pageContainer.find(\"img\").css(\"pointer-events\", \"none\");\n\n    $(textLayer).off(\".textSelectPluginHandler\");\n\n    $(textLayer).on('mousedown.textSelectPluginHandler', (event) => {\n      this.mouseIsDown = true;\n      event.stopPropagation();\n    });\n\n    // Prevent page flip on click\n    $(textLayer).on('mouseup.textSelectPluginHandler', (event) => {\n      this.mouseIsDown = false;\n      event.stopPropagation();\n    });\n  }\n\n  /**\n   * Initializes text selection modes if there is a text layer on the page\n   * @param {JQuery} $container\n   */\n  stopPageFlip($container) {\n    /** @type {JQuery<HTMLElement>} */\n    const $textLayer = $container.find('.BRtextLayer');\n    if (!$textLayer.length) return;\n    $textLayer.each((i, s) => this.defaultMode(s));\n    if (!this.br.protected) {\n      this.interceptCopy($container);\n    }\n  }\n\n  /**\n   * @param {PageContainer} pageContainer\n   */\n  async createTextLayer(pageContainer) {\n    const pageIndex = pageContainer.page.index;\n    const $container = pageContainer.$container;\n    const $textLayers = $container.find('.BRtextLayer');\n    if ($textLayers.length) return;\n    const XMLpage = await this.getPageText(pageIndex);\n    if (!XMLpage) return;\n    recursivelyAddCoords(XMLpage);\n\n    const totalWords = $(XMLpage).find(\"WORD\").length;\n    if (totalWords > this.maxWordRendered) {\n      console.log(`Page ${pageIndex} has too many words (${totalWords} > ${this.maxWordRendered}). Not rendering text layer.`);\n      return;\n    }\n\n    const textLayer = createDIVPageLayer(pageContainer.page, 'BRtextLayer');\n    const ratioW = parseFloat(pageContainer.$container[0].style.width) / pageContainer.page.width;\n    const ratioH = parseFloat(pageContainer.$container[0].style.height) / pageContainer.page.height;\n    textLayer.style.transform = `scale(${ratioW}, ${ratioH})`;\n    textLayer.setAttribute(\"dir\", this.rtl ? \"rtl\" : \"ltr\");\n\n    const ocrParagraphs = $(XMLpage).find(\"PARAGRAPH[coords]\").toArray();\n    const paragEls = ocrParagraphs.map(p => {\n      const el = this.renderParagraph(p);\n      textLayer.appendChild(el);\n      return el;\n    });\n\n    // Fix up paragraph positions\n    const paragraphRects = determineRealRects(textLayer, '.BRparagraphElement');\n    let yAdded = 0;\n    for (const [ocrParagraph, paragEl] of zip(ocrParagraphs, paragEls)) {\n      const ocrParagBounds = $(ocrParagraph).attr(\"coords\").split(\",\").map(parseFloat);\n      const realRect = paragraphRects.get(paragEl);\n      const [ocrLeft, , ocrRight, ocrTop] = ocrParagBounds;\n      const newStartMargin = this.rtl ? (realRect.right - ocrRight) : (ocrLeft - realRect.left);\n      const newTop = ocrTop - (realRect.top + yAdded);\n\n      paragEl.style[this.rtl ? 'marginRight' : 'marginLeft'] = `${newStartMargin}px`;\n      paragEl.style.marginTop = `${newTop}px`;\n      yAdded += newTop;\n      textLayer.appendChild(paragEl);\n    }\n    $container.append(textLayer);\n    this.stopPageFlip($container);\n  }\n\n  /**\n   * @param {HTMLElement} ocrParagraph\n   * @returns {HTMLParagraphElement}\n   */\n  renderParagraph(ocrParagraph) {\n    const paragEl = document.createElement('p');\n    paragEl.classList.add('BRparagraphElement');\n    const [paragLeft, paragBottom, paragRight, paragTop] = $(ocrParagraph).attr(\"coords\").split(\",\").map(parseFloat);\n    const wordHeightArr = [];\n    const lines = $(ocrParagraph).find(\"LINE[coords]\").toArray();\n    if (!lines.length) return paragEl;\n\n\n    for (const [prevLine, line, nextLine] of lookAroundWindow(genMap(lines, augmentLine))) {\n      const isLastLineOfParagraph = line.ocrElement == lines[lines.length - 1];\n      const lineEl = document.createElement('span');\n      lineEl.classList.add('BRlineElement');\n\n      for (const [wordIndex, currWord] of line.words.entries()) {\n        const [, bottom, right, top] = $(currWord).attr(\"coords\").split(',').map(parseFloat);\n        const wordHeight = bottom - top;\n        wordHeightArr.push(wordHeight);\n\n        if (wordIndex == 0 && prevLine?.lastWord.textContent.trim().endsWith('-')) {\n          // ideally prefer the next line to determine the left position,\n          // since the previous line could be the first line of the paragraph\n          // and hence have an incorrectly indented first word.\n          // E.g. https://archive.org/details/driitaleofdaring00bachuoft/page/360/mode/2up\n          const [newLeft, , , ] = $((nextLine || prevLine).firstWord).attr(\"coords\").split(',').map(parseFloat);\n          $(currWord).attr(\"coords\", `${newLeft},${bottom},${right},${top}`);\n        }\n\n        const wordEl = document.createElement('span');\n        wordEl.setAttribute(\"class\", \"BRwordElement\");\n        wordEl.textContent = currWord.textContent.trim();\n\n        if (wordIndex > 0) {\n          const space = document.createElement('span');\n          space.classList.add('BRspace');\n          space.textContent = ' ';\n          lineEl.append(space);\n\n          // Edge ignores empty elements (like BRspace), so add another\n          // space to ensure Edge's ReadAloud works correctly.\n          lineEl.appendChild(document.createTextNode(' '));\n        }\n\n        lineEl.appendChild(wordEl);\n      }\n\n      const hasHyphen = line.lastWord.textContent.trim().endsWith('-');\n      const lastWordEl = lineEl.children[lineEl.children.length - 1];\n      if (hasHyphen && !isLastLineOfParagraph) {\n        lastWordEl.textContent = lastWordEl.textContent.trim().slice(0, -1);\n        lastWordEl.classList.add('BRwordElement--hyphen');\n      }\n\n      paragEl.appendChild(lineEl);\n      if (!isLastLineOfParagraph && !hasHyphen) {\n        // Edge does not correctly have spaces between the lines.\n        paragEl.appendChild(document.createTextNode(' '));\n      }\n    }\n\n    wordHeightArr.sort((a, b) => a - b);\n    const paragWordHeight = wordHeightArr[Math.floor(wordHeightArr.length * 0.85)] + 4;\n    paragEl.style.left = `${paragLeft}px`;\n    paragEl.style.top = `${paragTop}px`;\n    paragEl.style.width = `${paragRight - paragLeft}px`;\n    paragEl.style.height = `${paragBottom - paragTop}px`;\n    paragEl.style.fontSize = `${paragWordHeight}px`;\n\n    // Fix up sizes - stretch/crush words as necessary using letter spacing\n    let wordRects = determineRealRects(paragEl, '.BRwordElement');\n    const ocrWords = $(ocrParagraph).find(\"WORD\").toArray();\n    const wordEls = paragEl.querySelectorAll('.BRwordElement');\n    for (const [ocrWord, wordEl] of zip(ocrWords, wordEls)) {\n      const realRect = wordRects.get(wordEl);\n      const [left, , right ] = $(ocrWord).attr(\"coords\").split(',').map(parseFloat);\n      let ocrWidth = right - left;\n      // Some books (eg theworksofplato01platiala) have a space _inside_ the <WORD>\n      // element. That makes it impossible to determine the correct positining\n      // of everything, but to avoid the BRspace's being width 0, which makes selection\n      // janky on Chrome Android, assume the space is the same width as one of the\n      // letters.\n      if (ocrWord.textContent.endsWith(' ')) {\n        ocrWidth = ocrWidth * (ocrWord.textContent.length - 1) / ocrWord.textContent.length;\n      }\n      const diff = ocrWidth - realRect.width;\n      wordEl.style.letterSpacing = `${diff / (ocrWord.textContent.length - 1)}px`;\n    }\n\n    // Stretch/crush lines as necessary using line spacing\n    // Recompute rects after letter spacing\n    wordRects = determineRealRects(paragEl, '.BRwordElement');\n    const spaceRects = determineRealRects(paragEl, '.BRspace');\n\n    const ocrLines = $(ocrParagraph).find(\"LINE[coords]\").toArray();\n    const lineEls = Array.from(paragEl.querySelectorAll('.BRlineElement'));\n\n    let ySoFar = paragTop;\n    for (const [ocrLine, lineEl] of zip(ocrLines, lineEls)) {\n      // shift words using marginLeft to align with the correct x position\n      const words = $(ocrLine).find(\"WORD\").toArray();\n      // const ocrLineLeft = Math.min(...words.map(w => parseFloat($(w).attr(\"coords\").split(',')[0])));\n      let xSoFar = this.rtl ? paragRight : paragLeft;\n      for (const [ocrWord, wordEl] of zip(words, lineEl.querySelectorAll('.BRwordElement'))) {\n        // start of line, need to compute the offset relative to the OCR words\n        const wordRect = wordRects.get(wordEl);\n        const [ocrLeft, , ocrRight ] = $(ocrWord).attr(\"coords\").split(',').map(parseFloat);\n        const diff = (this.rtl ? -(ocrRight - xSoFar) : ocrLeft - xSoFar);\n\n        if (wordEl.previousElementSibling) {\n          const space = wordEl.previousElementSibling;\n          space.style.letterSpacing = `${diff - spaceRects.get(space).width}px`;\n        } else {\n          wordEl.style[this.rtl ? 'paddingRight' : 'paddingLeft'] = `${diff}px`;\n        }\n        if (this.rtl) xSoFar -= diff + wordRect.width;\n        else xSoFar += diff + wordRect.width;\n      }\n      // And also fix y position\n      const ocrLineTop = Math.min(...words.map(w => parseFloat($(w).attr(\"coords\").split(',')[3])));\n      const diff = ocrLineTop - ySoFar;\n      if (lineEl.previousElementSibling) {\n        lineEl.previousElementSibling.style.lineHeight = `${diff}px`;\n        ySoFar += diff;\n      }\n    }\n\n    // The last line will have a line height subtracting from the paragraph height\n    lineEls[lineEls.length - 1].style.lineHeight = `${paragBottom - ySoFar}px`;\n\n    // Edge does not include a newline for some reason when copying/pasting the <p> els\n    paragEl.appendChild(document.createElement('br'));\n    return paragEl;\n  }\n}\n\nBookReader?.registerPlugin('textSelection', TextSelectionPlugin);\n\n\n/**\n * @param {HTMLElement} parentEl\n * @param {string} selector\n * @returns {Map<Element, Rect>}\n */\nfunction determineRealRects(parentEl, selector) {\n  const initals = {\n    position: parentEl.style.position,\n    visibility: parentEl.style.visibility,\n    top: parentEl.style.top,\n    left: parentEl.style.left,\n    transform: parentEl.style.transform,\n  };\n  parentEl.style.position = 'absolute';\n  parentEl.style.visibility = 'hidden';\n  parentEl.style.top = '0';\n  parentEl.style.left = '0';\n  parentEl.style.transform = 'none';\n  document.body.appendChild(parentEl);\n  const rects = new Map(\n    Array.from(parentEl.querySelectorAll(selector))\n      .map(wordEl => {\n        const origRect = wordEl.getBoundingClientRect();\n        return [wordEl, new Rect(\n          origRect.left + window.scrollX,\n          origRect.top + window.scrollY,\n          origRect.width,\n          origRect.height,\n        )];\n      }),\n  );\n  document.body.removeChild(parentEl);\n  Object.assign(parentEl.style, initals);\n  return rects;\n}\n\n/**\n * @param {HTMLElement} line\n */\nfunction augmentLine(line) {\n  const words = $(line).find(\"WORD\").toArray();\n  return {\n    ocrElement: line,\n    words,\n    firstWord: words[0],\n    lastWord: words[words.length - 1],\n  };\n}\n\n/**\n * @template T\n * Get the i-th element of an iterable\n * @param {Iterable<T>} iterable\n * @param {number} index\n */\nexport function genAt(iterable, index) {\n  let i = 0;\n  for (const x of iterable) {\n    if (i == index) return x;\n    i++;\n  }\n  return undefined;\n}\n\n/**\n * @template T\n * Generator version of filter\n * @param {Iterable<T>} iterable\n * @param {function(T): boolean} fn\n */\nexport function* genFilter(iterable, fn) {\n  for (const x of iterable) {\n    if (fn(x)) yield x;\n  }\n}\n\n/**\n * @template TFrom, TTo\n * Generator version of map\n * @param {Iterable<TFrom>} gen\n * @param {function(TFrom): TTo} fn\n * @returns {Iterable<TTo>}\n */\nexport function* genMap(gen, fn) {\n  for (const x of gen) yield fn(x);\n}\n\n/**\n * @template T\n * Generator that provides a sliding window of 3 elements,\n * prev, current, and next.\n * @param {Iterable<T>} gen\n * @returns {Iterable<[T | undefined, T, T | undefined]>}\n */\nexport function* lookAroundWindow(gen) {\n  let prev = undefined;\n  let cur = undefined;\n  let next = undefined;\n  for (const x of gen) {\n    if (typeof cur !== 'undefined') {\n      next = x;\n      yield [prev, cur, next];\n    }\n    prev = cur;\n    cur = x;\n    next = undefined;\n  }\n\n  if (typeof cur !== 'undefined') {\n    yield [prev, cur, next];\n  }\n}\n\n/**\n * @template T1, T2\n * Lazy zip implementation to avoid importing lodash\n * Expects iterators to be of the same length\n * @param {Iterable<T1>} gen1\n * @param {Iterable<T2>} gen2\n * @returns {Iterable<[T1, T2]>}\n */\nexport function* zip(gen1, gen2) {\n  const it1 = gen1[Symbol.iterator]();\n  const it2 = gen2[Symbol.iterator]();\n  while (true) {\n    const r1 = it1.next();\n    const r2 = it2.next();\n    if (r1.done && r2.done) {\n      return;\n    }\n    if (r1.done || r2.done) {\n      throw new Error('zip: one of the iterators is done');\n    }\n    yield [r1.value, r2.value];\n  }\n}\n\n/**\n * [left, bottom, right, top]\n * @param {Array<[number, number, number, number]>} bounds\n * @returns {[number, number, number, number]}\n */\nfunction determineBounds(bounds) {\n  let leftMost = Infinity;\n  let bottomMost = -Infinity;\n  let rightMost = -Infinity;\n  let topMost = Infinity;\n\n  for (const [left, bottom, right, top] of bounds) {\n    leftMost = Math.min(leftMost, left);\n    bottomMost = Math.max(bottomMost, bottom);\n    rightMost = Math.max(rightMost, right);\n    topMost = Math.min(topMost, top);\n  }\n\n  return [leftMost, bottomMost, rightMost, topMost];\n}\n\n/**\n * Recursively traverses the XML tree and adds coords\n * which are the bounding box of all child coords\n * @param {Element} xmlEl\n */\nfunction recursivelyAddCoords(xmlEl) {\n  if ($(xmlEl).attr('coords') || !xmlEl.children) {\n    return;\n  }\n\n  const children = $(xmlEl).children().toArray();\n  if (children.length === 0) {\n    return;\n  }\n\n  for (const child of children) {\n    recursivelyAddCoords(child);\n  }\n\n  const childCoords = [];\n\n  for (const child of children) {\n    if (!$(child).attr('coords')) continue;\n    childCoords.push($(child).attr('coords').split(',').map(parseFloat));\n  }\n\n  const boundingCoords = determineBounds(childCoords);\n  if (Math.abs(boundingCoords[0]) != Infinity) {\n    $(xmlEl).attr('coords', boundingCoords.join(','));\n  }\n}\n\n/**\n * Basically a polyfill for the native DOMRect class\n */\nclass Rect {\n  /**\n   * @param {number} x\n   * @param {number} y\n   * @param {number} width\n   * @param {number} height\n   */\n  constructor(x, y, width, height) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n  }\n\n  get right() { return this.x + this.width; }\n  get bottom() { return this.y + this.height; }\n  get top() { return this.y; }\n  get left() { return this.x; }\n}\n\n/**\n * Depth traverse the DOM tree starting at `start`, and ending at `end`.\n * @param {Node} start\n * @param {Node} end\n * @returns {Generator<Node>}\n */\nexport function* walkBetweenNodes(start, end) {\n  let done = false;\n\n  /**\n   * @param {Node} node\n   */\n  function* walk(node, {children = true, parents = true, siblings = true} = {}) {\n    if (node === end) {\n      done = true;\n      yield node;\n      return;\n    }\n\n    // yield self\n    yield node;\n\n    // First iterate children (depth-first traversal)\n    if (children && node.firstChild) {\n      yield* walk(node.firstChild, {children: true, parents: false, siblings: true});\n      if (done) return;\n    }\n\n    // Then iterate siblings\n    if (siblings) {\n      for (let sib = node.nextSibling; sib; sib = sib.nextSibling) {\n        yield* walk(sib, {children: true, parents: false, siblings: false});\n        if (done) return;\n      }\n    }\n\n    // Finally, move up the tree\n    if (parents && node.parentNode) {\n      yield* walk(node.parentNode, {children: false, parents: true, siblings: true});\n      if (done) return;\n    }\n  }\n\n  yield* walk(start);\n}\n","/**\n * @typedef {String} StringWithVars\n * A template string with {{foo}} style variables\n * Also supports filters, like {{bookPath|urlencode}} (See APPLY_FILTERS for the\n * supported list of filters)\n **/\n\n/**\n * @param {StringWithVars|String} template\n * @param { {[varName: string]: { toString: () => string} } } vars\n * @param { {[varName: string]: { toString: () => string} } } [overrides]\n * @returns {StringWithVars|string}\n */\nexport function applyVariables(template, vars, overrides = {}, possibleFilters = APPLY_FILTERS) {\n  return template?.replace(/\\{\\{([^}]*?)\\}\\}/g, ($0, $1) => {\n    if (!$1) return $0;\n    /** @type {string} */\n    const expression = $1;\n    const [varName, ...filterNames] = expression.split('|').map(x => x.trim());\n    const defined = varName in overrides || varName in vars;\n\n    // If it's not defined, don't expand it at all\n    if (!defined) return $0;\n\n    const value = varName in overrides ? overrides[varName]\n      : varName in vars ? vars[varName] : null;\n    const filters = filterNames.map(n => possibleFilters[n]);\n    return filters.reduce((acc, cur) => cur(acc), value && value.toString());\n  });\n}\n\n/** @type { {[filterName: String]:( string => string)} } */\nexport const APPLY_FILTERS = {\n  urlencode: encodeURIComponent,\n};\n"],"names":["PROPER_FUNCTION_NAME","fails","whitespaces","module","exports","METHOD_NAME","name","$","$trim","target","proto","forced","forcedStringTrimMethod","trim","this","BookReaderPlugin","br","_classCallCheck","options","key","value","Object","assign","pageContainer","$toolbarElement","$navBar","SelectionObserver","selector","handler","_this","_defineProperty","sel","window","getSelection","selecting","toString","anchorNode","closest","isCollapsed","document","addEventListener","_onSelectionChange","removeEventListener","genFilter","_marked2","_regeneratorRuntime","mark","genMap","_marked3","lookAroundWindow","_marked4","zip","_marked5","walkBetweenNodes","_slicedToArray","r","e","Array","isArray","_arrayWithHoles","l","t","Symbol","iterator","n","i","u","a","f","o","call","next","done","push","length","return","_iterableToArrayLimit","_unsupportedIterableToArray","TypeError","_nonIterableRest","_createForOfIteratorHelper","_n","F","s","_arrayLikeToArray","slice","constructor","from","test","prototype","hasOwnProperty","defineProperty","c","asyncIterator","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","resultName","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","_callSuper","_getPrototypeOf","ReferenceError","_assertThisInitialized","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","Boolean","valueOf","bind","_setPrototypeOf","_toPropertyKey","_defineProperties","_createClass","toPrimitive","String","_toPrimitive","BookReader","Cache","maxSize","undefined","entries","entry","shift","TextSelectionPlugin","_BookReaderPlugin","enabled","fullDjvuXmlUrl","singlePageDjvuXmlUrl","jsonp","maxProtectedWords","selection","rangeCount","range","getRangeAt","startInBr","startContainer","parentElement","endInBr","endContainer","lastAllowedWord","iterable","index","_step7","_iterator7","x","err","genAt","node","_node$classList","classList","contains","parentNode","newRange","createRange","setStart","startOffset","setEnd","firstChild","textContent","removeAllRanges","addRange","textSelectingMode","concat","defaultMode","rtl","pageProgression","selectionObserver","_inherits","_this2","loadData","attach","selectEvent","_this2$br$plugins$arc","plugins","archiveAnalytics","sendEvent","refs","$br","find","removeClass","addClass","protected","_limitSelection","body","on","toArray","some","el","containsNode","preventDefault","mode","constModeThumb","page","createTextLayer","djvuPagesPromise","ajax","url","applyVariables","vars","dataType","cache","xhrFields","withCredentials","error","res","xmlMap","parseXML","_getPageText","_callee","cachedEntry","xmlDoc","result","XMLpagesArr","_context","pageTextCache","response","pageIndex","add","t0","_x","$container","event","clipboardData","setData","textLayer","_this3","$pageContainer","style","pointerEvents","css","off","startedMouseDown","mouseIsDown","skipNextMouseup","is","stopPropagation","_this4","_this5","$textLayer","each","interceptCopy","_createTextLayer","_callee2","XMLpage","totalWords","ratioW","ratioH","ocrParagraphs","paragEls","paragraphRects","yAdded","_iterator","_step","_step$value","ocrParagraph","paragEl","ocrParagBounds","realRect","_ocrParagBounds","ocrLeft","ocrRight","ocrTop","newStartMargin","newTop","_this6","_context2","getPageText","recursivelyAddCoords","maxWordRendered","console","log","createDIVPageLayer","parseFloat","width","height","transform","setAttribute","map","renderParagraph","appendChild","determineRealRects","attr","split","get","right","left","top","marginTop","append","stopPageFlip","_x2","createElement","_$$attr$split$map2","paragLeft","paragBottom","paragRight","paragTop","wordHeightArr","lines","_step2","_iterator2","augmentLine","_step2$value","prevLine","line","nextLine","isLastLineOfParagraph","ocrElement","lineEl","_step5","_iterator5","words","_step5$value","wordIndex","currWord","_$$attr$split$map4","bottom","wordHeight","lastWord","endsWith","newLeft","firstWord","wordEl","space","createTextNode","hasHyphen","lastWordEl","children","sort","b","paragWordHeight","Math","floor","fontSize","_step3","wordRects","_iterator3","querySelectorAll","_step3$value","ocrWord","_$$attr$split$map8","ocrWidth","diff","letterSpacing","_step4","spaceRects","ocrLines","lineEls","ySoFar","_iterator4","_step6","_step4$value","ocrLine","xSoFar","_iterator6","_step6$value","wordRect","_$$attr$split$map10","previousElementSibling","min","_arrayWithoutHoles","w","_iterableToArray","_nonIterableSpread","lineHeight","parentEl","initals","position","visibility","rects","Map","origRect","getBoundingClientRect","Rect","scrollX","scrollY","removeChild","fn","_iterator8","_step8","_context3","_marked","gen","_iterator9","_step9","_context4","cur","_iterator10","_step10","_context5","gen1","gen2","it1","it2","r1","r2","_context6","xmlEl","_step12","_iterator12","_step13","childCoords","_iterator13","child","boundingCoords","bounds","_step11","leftMost","Infinity","bottomMost","rightMost","topMost","_iterator11","_step11$value","max","determineBounds","abs","join","registerPlugin","start","end","walk","_context8","_ref","_ref$children","_ref$parents","parents","_ref$siblings","siblings","_callee3","sib","_context7","nextSibling","template","overrides","possibleFilters","APPLY_FILTERS","replace","$0","$1","_expression$split$map2","varName","filterNames","reduce","acc","urlencode","encodeURIComponent"],"sourceRoot":""}